ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s 			page 1


   1              		.cpu cortex-m4
   2              		.arch armv7e-m
   3              		.fpu softvfp
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 1
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"soft-se.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.section	.text.GetKeyByID,"ax",%progbits
  18              		.align	1
  19              		.syntax unified
  20              		.thumb
  21              		.thumb_func
  23              	GetKeyByID:
  24              	.LVL0:
  25              	.LFB105:
  26              		.file 1 "Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c"
   1:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** /*!
   2:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  * \file      soft-se.c
   3:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  *
   4:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  * \brief     Secure Element software implementation
   5:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  *
   6:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  * \copyright Revised BSD License, see section \ref LICENSE.
   7:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  *
   8:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  * \code
   9:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  *                ______                              _
  10:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  *               / _____)             _              | |
  11:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  *              ( (____  _____ ____ _| |_ _____  ____| |__
  12:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  *               \____ \| ___ |    (_   _) ___ |/ ___)  _ \
  13:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  *               _____) ) ____| | | || |_| ____( (___| | | |
  14:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  *              (______/|_____)_|_|_| \__)_____)\____)_| |_|
  15:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  *              (C)2020 Semtech
  16:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  *
  17:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  *               ___ _____ _   ___ _  _____ ___  ___  ___ ___
  18:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  *              / __|_   _/_\ / __| |/ / __/ _ \| _ \/ __| __|
  19:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  *              \__ \ | |/ _ \ (__| ' <| _| (_) |   / (__| _|
  20:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  *              |___/ |_/_/ \_\___|_|\_\_| \___/|_|_\\___|___|
  21:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  *              embedded.connectivity.solutions===============
  22:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  *
  23:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  * \endcode
  24:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  *
  25:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  */
  26:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
  27:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** /**
  28:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****   ******************************************************************************
  29:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****   *
  30:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****   *          Portions COPYRIGHT 2020 STMicroelectronics
  31:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****   *
  32:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****   * @file    soft-se.c
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s 			page 2


  33:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****   * @author  MCD Application Team
  34:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****   * @brief   Secure Element software implementation
  35:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****   ******************************************************************************
  36:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****   */
  37:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
  38:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** /* Includes ------------------------------------------------------------------*/
  39:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #include <stdlib.h>
  40:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #include <stdint.h>
  41:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
  42:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #include "lorawan_conf.h"  /* LORAWAN_KMS */
  43:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #include "radio.h"         /* needed for Random */
  44:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #include "utilities.h"
  45:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #include "mw_log_conf.h"   /* needed for MW_LOG */
  46:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if (!defined (LORAWAN_KMS) || (LORAWAN_KMS == 0))
  47:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #include "lorawan_aes.h"
  48:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #include "cmac.h"
  49:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #else /* LORAWAN_KMS == 1 */
  50:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #include "kms_if.h"
  51:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* LORAWAN_KMS */
  52:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
  53:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #include "LoRaMacHeaderTypes.h"
  54:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
  55:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #include "secure-element.h"
  56:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #include "secure-element-nvm.h"
  57:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #include "se-identity.h"
  58:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
  59:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** /* Private constants ---------------------------------------------------------*/
  60:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** /*!
  61:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  * MIC computation offset
  62:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  * \remark required for 1.1.x support
  63:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  */
  64:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #define CRYPTO_MIC_COMPUTATION_OFFSET ( JOIN_REQ_TYPE_SIZE\
  65:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                                         + LORAMAC_JOIN_EUI_FIELD_SIZE + DEV_NONCE_SIZE + LORAMAC_MH
  66:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
  67:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if (!defined (LORAWAN_KMS) || (LORAWAN_KMS == 0))
  68:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #else /* LORAWAN_KMS == 1 */
  69:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #define DERIVED_OBJECT_HANDLE_RESET_VAL      0x0UL
  70:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #define PAYLOAD_MAX_SIZE     270UL  /* 270 PHYPayload: 1+(22+1+242)+4 */
  71:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* LORAWAN_KMS */
  72:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
  73:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** /* Private macro -------------------------------------------------------------*/
  74:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** /*!
  75:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  * Hex 8 split buffer
  76:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  */
  77:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #define HEX8(X)   X[0], X[1], X[2], X[3], X[4], X[5], X[6], X[7]
  78:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
  79:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** /*!
  80:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  * Hex 16 split buffer
  81:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  */
  82:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #define HEX16(X)  HEX8(X), X[8], X[9], X[10], X[11], X[12], X[13], X[14], X[15]
  83:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
  84:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** /* Private Types ---------------------------------------------------------*/
  85:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** /* Private variables ---------------------------------------------------------*/
  86:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** /*!
  87:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  * Secure element context
  88:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  */
  89:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** static SecureElementNvmData_t* SeNvm;
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s 			page 3


  90:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
  91:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if (!defined (LORAWAN_KMS) || (LORAWAN_KMS == 0))
  92:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #else /* LORAWAN_KMS == 1 */
  93:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** /* WARNING: Should be modified at the end of product development */
  94:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** static const CK_ULONG GlobalTemplateLabel = 0x444E524CU;
  95:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
  96:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** /*
  97:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  * Intermediate buffer used for two reasons:
  98:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  * - align to 32 bits and
  99:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  * - for Cmac combine InitVector + input buff
 100:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  */
 101:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** static uint8_t input_align_combined_buf[PAYLOAD_MAX_SIZE + SE_KEY_SIZE] ALIGN(4);
 102:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 103:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** static uint8_t output_align[PAYLOAD_MAX_SIZE] ALIGN(4);
 104:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 105:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** static uint8_t tag[SE_KEY_SIZE] ALIGN(4) = {0};
 106:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* LORAWAN_KMS */
 107:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 108:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** /* Private functions prototypes ---------------------------------------------------*/
 109:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if (!defined (LORAWAN_KMS) || (LORAWAN_KMS == 0))
 110:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** static SecureElementStatus_t GetKeyByID( KeyIdentifier_t keyID, Key_t **keyItem );
 111:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #else /* LORAWAN_KMS == 1 */
 112:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** static SecureElementStatus_t GetKeyIndexByID( KeyIdentifier_t keyID, CK_OBJECT_HANDLE *keyIndex );
 113:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 114:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** static SecureElementStatus_t GetSpecificLabelByID( KeyIdentifier_t keyID, uint32_t *specificLabel )
 115:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 116:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** static SecureElementStatus_t DeleteAllDynamicKeys( void );
 117:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* LORAWAN_KMS */
 118:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 119:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if (defined (KEY_EXTRACTABLE) && (KEY_EXTRACTABLE == 1))
 120:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** static void PrintKey( KeyIdentifier_t key );
 121:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* KEY_EXTRACTABLE */
 122:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 123:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** static SecureElementStatus_t ComputeCmac(uint8_t *micBxBuffer, uint8_t *buffer, uint16_t size, KeyI
 124:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                                          uint32_t *cmac);
 125:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 126:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 127:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** /* Private functions ---------------------------------------------------------*/
 128:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if (defined (KEY_EXTRACTABLE) && (KEY_EXTRACTABLE == 1))
 129:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** static void PrintKey( KeyIdentifier_t key )
 130:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** {
 131:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SecureElementStatus_t retval = SECURE_ELEMENT_ERROR;
 132:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     Key_t *keyItem;
 133:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     retval = SecureElementGetKeyByID(key, &keyItem);
 134:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (retval == SECURE_ELEMENT_SUCCESS)
 135:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 136:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         if (key == APP_KEY)
 137:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 138:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             MW_LOG(TS_OFF, VLEVEL_M, "###### AppKey:      ");
 139:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 140:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         else if (key == NWK_KEY)
 141:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 142:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             MW_LOG(TS_OFF, VLEVEL_M, "###### NwkKey:      ");
 143:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 144:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         else if (key == APP_S_KEY)
 145:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 146:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             MW_LOG(TS_OFF, VLEVEL_M, "###### AppSKey:     ");
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s 			page 4


 147:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 148:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         else if (key == NWK_S_KEY)
 149:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 150:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             MW_LOG(TS_OFF, VLEVEL_M, "###### NwkSKey:     ");
 151:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 152:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         else if (key == MC_ROOT_KEY)
 153:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 154:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             MW_LOG(TS_OFF, VLEVEL_M, "###### MCRootKey:   ");
 155:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 156:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         else if (key == MC_KE_KEY)
 157:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 158:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             MW_LOG(TS_OFF, VLEVEL_M, "###### MCKEKey:     ");
 159:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 160:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         else if (key == MC_KEY_0)
 161:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 162:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             MW_LOG(TS_OFF, VLEVEL_M, "###### MCKey_0:     ");
 163:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 164:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         else if (key == MC_APP_S_KEY_0)
 165:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 166:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             MW_LOG(TS_OFF, VLEVEL_M, "###### MCAppSKey_0: ");
 167:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 168:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         else if (key == MC_NWK_S_KEY_0)
 169:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 170:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             MW_LOG(TS_OFF, VLEVEL_M, "###### MCNwkSKey_0: ");
 171:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 172:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         MW_LOG(TS_OFF, VLEVEL_M, "%02X:%02X:%02X:%02X:%02X:%02X:%02X:%02X:%02X:%02X:%02X:%02X:%02X:
 173:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                HEX16(keyItem->KeyValue));
 174:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 175:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** }
 176:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* KEY_EXTRACTABLE */
 177:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 178:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if (!defined (LORAWAN_KMS) || (LORAWAN_KMS == 0))
 179:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** /*
 180:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  * Gets key item from key list.
 181:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  *
 182:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  * \param[IN]  keyID          - Key identifier
 183:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  * \param[OUT] keyItem        - Key item reference
 184:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  * \retval                    - Status of the operation
 185:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  */
 186:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** static SecureElementStatus_t GetKeyByID( KeyIdentifier_t keyID, Key_t** keyItem )
 187:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** {
  27              		.loc 1 187 1 view -0
  28              		.cfi_startproc
  29              		@ args = 0, pretend = 0, frame = 0
  30              		@ frame_needed = 0, uses_anonymous_args = 0
  31              		@ link register save eliminated.
 188:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     for( uint8_t i = 0; i < NUM_OF_KEYS; i++ )
  32              		.loc 1 188 5 view .LVU1
  33              	.LBB2:
  34              		.loc 1 188 10 view .LVU2
  35              		.loc 1 188 18 is_stmt 0 view .LVU3
  36 0000 0023     		movs	r3, #0
  37              	.LVL1:
  38              		.loc 1 188 25 is_stmt 1 view .LVU4
  39              		.loc 1 188 5 is_stmt 0 view .LVU5
  40 0002 092B     		cmp	r3, #9
  41 0004 17D8     		bhi	.L11
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s 			page 5


  42              	.LBE2:
 187:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     for( uint8_t i = 0; i < NUM_OF_KEYS; i++ )
  43              		.loc 1 187 1 view .LVU6
  44 0006 10B4     		push	{r4}
  45              	.LCFI0:
  46              		.cfi_def_cfa_offset 4
  47              		.cfi_offset 4, -4
  48              	.L5:
  49              	.LBB3:
 189:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 190:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         if( SeNvm->KeyList[i].KeyID == keyID )
  50              		.loc 1 190 9 is_stmt 1 view .LVU7
  51              		.loc 1 190 18 is_stmt 0 view .LVU8
  52 0008 0C4A     		ldr	r2, .L13
  53 000a 1468     		ldr	r4, [r2]
  54              		.loc 1 190 30 view .LVU9
  55 000c 03EB0312 		add	r2, r3, r3, lsl #4
  56 0010 2244     		add	r2, r2, r4
  57 0012 127C     		ldrb	r2, [r2, #16]	@ zero_extendqisi2
  58              		.loc 1 190 11 view .LVU10
  59 0014 8242     		cmp	r2, r0
  60 0016 06D0     		beq	.L12
 188:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
  61              		.loc 1 188 42 is_stmt 1 discriminator 2 view .LVU11
 188:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
  62              		.loc 1 188 43 is_stmt 0 discriminator 2 view .LVU12
  63 0018 0133     		adds	r3, r3, #1
  64              	.LVL2:
 188:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
  65              		.loc 1 188 43 discriminator 2 view .LVU13
  66 001a DBB2     		uxtb	r3, r3
  67              	.LVL3:
 188:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
  68              		.loc 1 188 25 is_stmt 1 discriminator 2 view .LVU14
 188:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
  69              		.loc 1 188 5 is_stmt 0 discriminator 2 view .LVU15
  70 001c 092B     		cmp	r3, #9
  71 001e F3D9     		bls	.L5
  72              	.LBE3:
 191:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 192:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             *keyItem = &( SeNvm->KeyList[i] );
 193:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             return SECURE_ELEMENT_SUCCESS;
 194:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 195:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 196:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     return SECURE_ELEMENT_ERROR_INVALID_KEY_ID;
  73              		.loc 1 196 12 view .LVU16
  74 0020 0320     		movs	r0, #3
  75              	.LVL4:
  76              	.L4:
 197:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** }
  77              		.loc 1 197 1 view .LVU17
  78 0022 10BC     		pop	{r4}
  79              	.LCFI1:
  80              		.cfi_remember_state
  81              		.cfi_restore 4
  82              		.cfi_def_cfa_offset 0
  83 0024 7047     		bx	lr
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s 			page 6


  84              	.LVL5:
  85              	.L12:
  86              	.LCFI2:
  87              		.cfi_restore_state
  88              	.LBB4:
 192:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             return SECURE_ELEMENT_SUCCESS;
  89              		.loc 1 192 13 is_stmt 1 view .LVU18
 192:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             return SECURE_ELEMENT_SUCCESS;
  90              		.loc 1 192 24 is_stmt 0 view .LVU19
  91 0026 03EB031C 		add	ip, r3, r3, lsl #4
  92 002a 0CF1100C 		add	ip, ip, #16
  93 002e 6444     		add	r4, r4, ip
 192:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             return SECURE_ELEMENT_SUCCESS;
  94              		.loc 1 192 22 view .LVU20
  95 0030 0C60     		str	r4, [r1]
 193:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
  96              		.loc 1 193 13 is_stmt 1 view .LVU21
 193:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
  97              		.loc 1 193 20 is_stmt 0 view .LVU22
  98 0032 0020     		movs	r0, #0
  99              	.LVL6:
 193:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 100              		.loc 1 193 20 view .LVU23
 101 0034 F5E7     		b	.L4
 102              	.LVL7:
 103              	.L11:
 104              	.LCFI3:
 105              		.cfi_def_cfa_offset 0
 106              		.cfi_restore 4
 193:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 107              		.loc 1 193 20 view .LVU24
 108              	.LBE4:
 196:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** }
 109              		.loc 1 196 12 view .LVU25
 110 0036 0320     		movs	r0, #3
 111              	.LVL8:
 112              		.loc 1 197 1 view .LVU26
 113 0038 7047     		bx	lr
 114              	.L14:
 115 003a 00BF     		.align	2
 116              	.L13:
 117 003c 00000000 		.word	.LANCHOR0
 118              		.cfi_endproc
 119              	.LFE105:
 121              		.section	.text.ComputeCmac,"ax",%progbits
 122              		.align	1
 123              		.syntax unified
 124              		.thumb
 125              		.thumb_func
 127              	ComputeCmac:
 128              	.LVL9:
 129              	.LFB106:
 198:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 199:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #else /* LORAWAN_KMS == 1 */
 200:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 201:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** /*
 202:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  * Gets key Index from key list in KMS table
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s 			page 7


 203:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  *
 204:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  * \param[IN]    keyID                    - Key identifier
 205:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  * \param[OUT] keyIndex             - Key item reference
 206:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  * \retval                                        - Status of the operation
 207:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  */
 208:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** static SecureElementStatus_t GetKeyIndexByID( KeyIdentifier_t keyID, CK_OBJECT_HANDLE *keyIndex )
 209:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** {
 210:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     for (uint8_t i = 0; i < NUM_OF_KEYS; i++)
 211:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 212:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         if (SeNvm->KeyList[i].KeyID == keyID)
 213:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 214:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             *keyIndex = SeNvm->KeyList[i].Object_Index;
 215:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             return SECURE_ELEMENT_SUCCESS;
 216:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 217:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 218:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     return SECURE_ELEMENT_ERROR_INVALID_KEY_ID;
 219:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** }
 220:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 221:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** static SecureElementStatus_t GetSpecificLabelByID( KeyIdentifier_t keyID, uint32_t *specificLabel )
 222:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** {
 223:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SecureElementStatus_t retval = SECURE_ELEMENT_SUCCESS;
 224:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     switch (keyID)
 225:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 226:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         case APP_KEY:
 227:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             *specificLabel = 0x5F505041U;
 228:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             break;
 229:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         case NWK_KEY:
 230:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             *specificLabel = 0x5F4B574EU;
 231:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             break;
 232:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if ( USE_LRWAN_1_1_X_CRYPTO == 1 )
 233:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         case J_S_INT_KEY:
 234:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             *specificLabel = 0x314B574EU;
 235:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             break;
 236:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         case J_S_ENC_KEY:
 237:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             *specificLabel = 0x324B574EU;
 238:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             break;
 239:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         case F_NWK_S_INT_KEY:
 240:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             *specificLabel = 0x334B574EU;
 241:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             break;
 242:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         case S_NWK_S_INT_KEY:
 243:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             *specificLabel = 0x344B574EU;
 244:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             break;
 245:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         case NWK_S_ENC_KEY:
 246:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             *specificLabel = 0x354B574EU;
 247:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             break;
 248:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #else /* USE_LRWAN_1_1_X_CRYPTO == 0 */
 249:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         case NWK_S_KEY:
 250:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             *specificLabel = 0x534B574EU;
 251:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             break;
 252:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* USE_LRWAN_1_1_X_CRYPTO */
 253:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         case APP_S_KEY:
 254:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             *specificLabel = 0x53505041U;
 255:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             break;
 256:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         case MC_ROOT_KEY:
 257:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             *specificLabel = 0x5452434DU;
 258:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             break;
 259:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         case MC_KE_KEY:
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s 			page 8


 260:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             *specificLabel = 0x454B434DU;
 261:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             break;
 262:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         case MC_KEY_0:
 263:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             *specificLabel = 0x304B434DU;
 264:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             break;
 265:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         case MC_APP_S_KEY_0:
 266:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             *specificLabel = 0x3053414DU;
 267:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             break;
 268:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         case MC_NWK_S_KEY_0:
 269:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             *specificLabel = 0x30534E4DU;
 270:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             break;
 271:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if ( LORAMAC_MAX_MC_CTX > 1 )
 272:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         case MC_KEY_1:
 273:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             *specificLabel = 0x314B434DU;
 274:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             break;
 275:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         case MC_APP_S_KEY_1:
 276:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             *specificLabel = 0x3153414DU;
 277:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             break;
 278:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         case MC_NWK_S_KEY_1:
 279:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             *specificLabel = 0x31534E4DU;
 280:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             break;
 281:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         case MC_KEY_2:
 282:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             *specificLabel = 0x324B434DU;
 283:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             break;
 284:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         case MC_APP_S_KEY_2:
 285:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             *specificLabel = 0x3253414DU;
 286:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             break;
 287:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         case MC_NWK_S_KEY_2:
 288:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             *specificLabel = 0x32534E4DU;
 289:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             break;
 290:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         case MC_KEY_3:
 291:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             *specificLabel = 0x334B434DU;
 292:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             break;
 293:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         case MC_APP_S_KEY_3:
 294:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             *specificLabel = 0x3353414DU;
 295:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             break;
 296:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         case MC_NWK_S_KEY_3:
 297:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             *specificLabel = 0x33534E4DU;
 298:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             break;
 299:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* LORAMAC_MAX_MC_CTX > 1 */
 300:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         default:
 301:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             retval = SECURE_ELEMENT_ERROR_INVALID_KEY_ID;
 302:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             break;
 303:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 304:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     return retval;
 305:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** }
 306:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 307:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** static SecureElementStatus_t DeleteAllDynamicKeys( void )
 308:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** {
 309:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_RV rv;
 310:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_SESSION_HANDLE session;
 311:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_FLAGS session_flags = CKF_SERIAL_SESSION;  /* Read ONLY session */
 312:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_OBJECT_HANDLE hObject[NUM_OF_KEYS];
 313:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     uint32_t ulCount = 0;
 314:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 315:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Open session with KMS */
 316:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     rv = C_OpenSession(0,  session_flags, NULL, 0, &session);
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s 			page 9


 317:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 318:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Get all keys handle */
 319:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (rv == CKR_OK)
 320:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 321:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         rv = C_FindObjectsInit(session, NULL, 0);
 322:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 323:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 324:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Find all existing keys handle */
 325:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (rv == CKR_OK)
 326:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 327:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         rv = C_FindObjects(session, hObject, NUM_OF_KEYS, (CK_ULONG *) &ulCount);
 328:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 329:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 330:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (rv == CKR_OK)
 331:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 332:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         rv = C_FindObjectsFinal(session);
 333:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 334:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 335:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (ulCount <= NUM_OF_KEYS)
 336:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 337:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         for (uint8_t i = 0; i < ulCount; i++)
 338:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 339:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             /* Exclude all Embedded keys */
 340:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             if (hObject[i] > LAST_KMS_KEY_OBJECT_HANDLE)
 341:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             {
 342:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                 if (rv == CKR_OK)
 343:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                 {
 344:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                     rv = C_DestroyObject(session, hObject[i]);
 345:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                 }
 346:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             }
 347:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 348:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 349:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 350:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Close sessions */
 351:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (session > 0)
 352:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 353:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         (void)C_CloseSession(session);
 354:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 355:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 356:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (rv != CKR_OK)
 357:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 358:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return SECURE_ELEMENT_ERROR;
 359:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 360:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     return SECURE_ELEMENT_SUCCESS;
 361:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** }
 362:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* LORAWAN_KMS */
 363:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 364:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** /*
 365:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  * Computes a CMAC of a message using provided initial Bx block
 366:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  *
 367:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  *  cmac = aes128_cmac(keyID, blocks[i].Buffer)
 368:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  *
 369:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  * \param[IN]  micBxBuffer    - Buffer containing the initial Bx block
 370:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  * \param[IN]  buffer         - Data buffer
 371:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  * \param[IN]  size           - Data buffer size
 372:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  * \param[IN]  keyID          - Key identifier to determine the AES key to be used
 373:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  * \param[OUT] cmac           - Computed cmac
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s 			page 10


 374:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  * \retval                    - Status of the operation
 375:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  */
 376:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** static SecureElementStatus_t ComputeCmac( uint8_t* micBxBuffer, uint8_t* buffer, uint16_t size, Key
 377:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                                           uint32_t* cmac )
 378:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** {
 130              		.loc 1 378 1 is_stmt 1 view -0
 131              		.cfi_startproc
 132              		@ args = 4, pretend = 0, frame = 304
 133              		@ frame_needed = 0, uses_anonymous_args = 0
 134              		.loc 1 378 1 is_stmt 0 view .LVU28
 135 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 136              	.LCFI4:
 137              		.cfi_def_cfa_offset 24
 138              		.cfi_offset 4, -24
 139              		.cfi_offset 5, -20
 140              		.cfi_offset 6, -16
 141              		.cfi_offset 7, -12
 142              		.cfi_offset 8, -8
 143              		.cfi_offset 14, -4
 144 0004 CCB0     		sub	sp, sp, #304
 145              	.LCFI5:
 146              		.cfi_def_cfa_offset 328
 147 0006 529E     		ldr	r6, [sp, #328]
 379:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( ( buffer == NULL ) || ( cmac == NULL ) )
 148              		.loc 1 379 5 is_stmt 1 view .LVU29
 149              		.loc 1 379 7 is_stmt 0 view .LVU30
 150 0008 A9B3     		cbz	r1, .L18
 151 000a 0546     		mov	r5, r0
 152 000c 1746     		mov	r7, r2
 153 000e 1C46     		mov	r4, r3
 154 0010 8846     		mov	r8, r1
 155              		.loc 1 379 28 discriminator 1 view .LVU31
 156 0012 96B3     		cbz	r6, .L19
 380:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 381:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return SECURE_ELEMENT_ERROR_NPE;
 382:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 383:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 384:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if (!defined (LORAWAN_KMS) || (LORAWAN_KMS == 0))
 385:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     uint8_t Cmac[16];
 157              		.loc 1 385 5 is_stmt 1 view .LVU32
 386:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     AES_CMAC_CTX aesCmacCtx[1];
 158              		.loc 1 386 5 view .LVU33
 387:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 388:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     AES_CMAC_Init( aesCmacCtx );
 159              		.loc 1 388 5 view .LVU34
 160 0014 02A8     		add	r0, sp, #8
 161              	.LVL10:
 162              		.loc 1 388 5 is_stmt 0 view .LVU35
 163 0016 FFF7FEFF 		bl	AES_CMAC_Init
 164              	.LVL11:
 389:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 390:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     Key_t*                keyItem;
 165              		.loc 1 390 5 is_stmt 1 view .LVU36
 391:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SecureElementStatus_t retval = GetKeyByID( keyID, &keyItem );
 166              		.loc 1 391 5 view .LVU37
 167              		.loc 1 391 36 is_stmt 0 view .LVU38
 168 001a 01A9     		add	r1, sp, #4
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s 			page 11


 169 001c 2046     		mov	r0, r4
 170 001e FFF7FEFF 		bl	GetKeyByID
 171              	.LVL12:
 392:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 393:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( retval == SECURE_ELEMENT_SUCCESS )
 172              		.loc 1 393 5 is_stmt 1 view .LVU39
 173              		.loc 1 393 7 is_stmt 0 view .LVU40
 174 0022 0446     		mov	r4, r0
 175 0024 18B1     		cbz	r0, .L21
 176              	.LVL13:
 177              	.L16:
 394:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 395:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         AES_CMAC_SetKey( aesCmacCtx, keyItem->KeyValue );
 396:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 397:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         if( micBxBuffer != NULL )
 398:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 399:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             AES_CMAC_Update( aesCmacCtx, micBxBuffer, 16 );
 400:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 401:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 402:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         AES_CMAC_Update( aesCmacCtx, buffer, size );
 403:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 404:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         AES_CMAC_Final( Cmac, aesCmacCtx );
 405:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 406:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         // Bring into the required format
 407:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         *cmac = ( uint32_t )( ( uint32_t ) Cmac[3] << 24 | ( uint32_t ) Cmac[2] << 16 | ( uint32_t 
 408:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                               ( uint32_t ) Cmac[0] );
 409:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 410:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #else /* LORAWAN_KMS == 1 */
 411:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_RV rv;
 412:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_SESSION_HANDLE session;
 413:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_FLAGS session_flags = CKF_SERIAL_SESSION;    /* Read ONLY session */
 414:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     uint32_t tag_lenth = 0;
 415:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_OBJECT_HANDLE key_handle ;
 416:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 417:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* AES CMAC Authentication variables */
 418:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_MECHANISM aes_cmac_mechanism = { CKM_AES_CMAC, (CK_VOID_PTR)NULL, 0 };
 419:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 420:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SecureElementStatus_t retval = GetKeyIndexByID(keyID, &key_handle);
 421:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (retval != SECURE_ELEMENT_SUCCESS)
 422:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 423:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return retval;
 424:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 425:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 426:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Open session with KMS */
 427:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     rv = C_OpenSession(0,    session_flags, NULL, 0, &session);
 428:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 429:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Configure session to Authentication message in AES CMAC with settings included into the mech
 430:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (rv == CKR_OK)
 431:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 432:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         rv = C_SignInit(session, &aes_cmac_mechanism, key_handle);
 433:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 434:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 435:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Encrypt clear message */
 436:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (rv == CKR_OK)
 437:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 438:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         /* work around : need to double-check if possible to use micBxBuffer as IV for Sign */
 439:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         if (micBxBuffer != NULL)
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s 			page 12


 440:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 441:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             memcpy1((uint8_t *) &input_align_combined_buf[0], (uint8_t *) micBxBuffer, SE_KEY_SIZE)
 442:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             memcpy1((uint8_t *) &input_align_combined_buf[SE_KEY_SIZE], (uint8_t *) buffer, size);
 443:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 444:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         else
 445:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 446:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             memcpy1((uint8_t *) &input_align_combined_buf[0], (uint8_t *) buffer, size);
 447:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 448:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 449:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 450:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (rv == CKR_OK)
 451:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 452:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         if (micBxBuffer != NULL)
 453:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 454:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             rv = C_Sign(session, (CK_BYTE_PTR)&input_align_combined_buf[0], size + SE_KEY_SIZE, &ta
 455:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                         (CK_ULONG_PTR)&tag_lenth);
 456:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 457:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         else
 458:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 459:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             rv = C_Sign(session, (CK_BYTE_PTR)&input_align_combined_buf[0], size, &tag[0],
 460:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                         (CK_ULONG_PTR)&tag_lenth);
 461:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 462:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 463:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 464:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Close session with KMS */
 465:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     (void)C_CloseSession(session);
 466:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 467:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* combine to a 32bit authentication word (MIC) */
 468:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     *cmac = (uint32_t)((uint32_t) tag[3] << 24 | (uint32_t) tag[2] << 16 | (uint32_t) tag[1] << 8 |
 469:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                        (uint32_t) tag[0]);
 470:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 471:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (rv != CKR_OK)
 472:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 473:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         retval = SECURE_ELEMENT_ERROR;
 474:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 475:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* LORAWAN_KMS */
 476:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     return retval;
 477:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** }
 178              		.loc 1 477 1 view .LVU41
 179 0026 2046     		mov	r0, r4
 180 0028 4CB0     		add	sp, sp, #304
 181              	.LCFI6:
 182              		.cfi_remember_state
 183              		.cfi_def_cfa_offset 24
 184              		@ sp needed
 185 002a BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 186              	.LVL14:
 187              	.L21:
 188              	.LCFI7:
 189              		.cfi_restore_state
 395:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 190              		.loc 1 395 9 is_stmt 1 view .LVU42
 395:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 191              		.loc 1 395 45 is_stmt 0 view .LVU43
 192 002e 0199     		ldr	r1, [sp, #4]
 395:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 193              		.loc 1 395 9 view .LVU44
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s 			page 13


 194 0030 0131     		adds	r1, r1, #1
 195 0032 02A8     		add	r0, sp, #8
 196              	.LVL15:
 395:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 197              		.loc 1 395 9 view .LVU45
 198 0034 FFF7FEFF 		bl	AES_CMAC_SetKey
 199              	.LVL16:
 397:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 200              		.loc 1 397 9 is_stmt 1 view .LVU46
 397:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 201              		.loc 1 397 11 is_stmt 0 view .LVU47
 202 0038 25B1     		cbz	r5, .L17
 399:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 203              		.loc 1 399 13 is_stmt 1 view .LVU48
 204 003a 1022     		movs	r2, #16
 205 003c 2946     		mov	r1, r5
 206 003e 02A8     		add	r0, sp, #8
 207 0040 FFF7FEFF 		bl	AES_CMAC_Update
 208              	.LVL17:
 209              	.L17:
 402:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 210              		.loc 1 402 9 view .LVU49
 211 0044 3A46     		mov	r2, r7
 212 0046 4146     		mov	r1, r8
 213 0048 02A8     		add	r0, sp, #8
 214 004a FFF7FEFF 		bl	AES_CMAC_Update
 215              	.LVL18:
 404:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 216              		.loc 1 404 9 view .LVU50
 217 004e 02A9     		add	r1, sp, #8
 218 0050 48A8     		add	r0, sp, #288
 219 0052 FFF7FEFF 		bl	AES_CMAC_Final
 220              	.LVL19:
 407:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                               ( uint32_t ) Cmac[0] );
 221              		.loc 1 407 9 view .LVU51
 407:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                               ( uint32_t ) Cmac[0] );
 222              		.loc 1 407 48 is_stmt 0 view .LVU52
 223 0056 9DF82321 		ldrb	r2, [sp, #291]	@ zero_extendqisi2
 407:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                               ( uint32_t ) Cmac[0] );
 224              		.loc 1 407 77 view .LVU53
 225 005a 9DF82231 		ldrb	r3, [sp, #290]	@ zero_extendqisi2
 407:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                               ( uint32_t ) Cmac[0] );
 226              		.loc 1 407 81 view .LVU54
 227 005e 1B04     		lsls	r3, r3, #16
 407:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                               ( uint32_t ) Cmac[0] );
 228              		.loc 1 407 58 view .LVU55
 229 0060 43EA0263 		orr	r3, r3, r2, lsl #24
 407:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                               ( uint32_t ) Cmac[0] );
 230              		.loc 1 407 106 view .LVU56
 231 0064 9DF82121 		ldrb	r2, [sp, #289]	@ zero_extendqisi2
 407:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                               ( uint32_t ) Cmac[0] );
 232              		.loc 1 407 87 view .LVU57
 233 0068 43EA0223 		orr	r3, r3, r2, lsl #8
 408:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 234              		.loc 1 408 48 view .LVU58
 235 006c 9DF82021 		ldrb	r2, [sp, #288]	@ zero_extendqisi2
 407:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                               ( uint32_t ) Cmac[0] );
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s 			page 14


 236              		.loc 1 407 17 view .LVU59
 237 0070 1343     		orrs	r3, r3, r2
 407:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                               ( uint32_t ) Cmac[0] );
 238              		.loc 1 407 15 view .LVU60
 239 0072 3360     		str	r3, [r6]
 240 0074 D7E7     		b	.L16
 241              	.LVL20:
 242              	.L18:
 381:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 243              		.loc 1 381 16 view .LVU61
 244 0076 0224     		movs	r4, #2
 245 0078 D5E7     		b	.L16
 246              	.L19:
 381:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 247              		.loc 1 381 16 view .LVU62
 248 007a 0224     		movs	r4, #2
 249 007c D3E7     		b	.L16
 250              		.cfi_endproc
 251              	.LFE106:
 253              		.section	.text.SecureElementGetKeyByID,"ax",%progbits
 254              		.align	1
 255              		.global	SecureElementGetKeyByID
 256              		.syntax unified
 257              		.thumb
 258              		.thumb_func
 260              	SecureElementGetKeyByID:
 261              	.LVL21:
 262              	.LFB108:
 478:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 479:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 480:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** /* Exported functions ---------------------------------------------------------*/
 481:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 482:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** /*
 483:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  * API functions
 484:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****  */
 485:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** /* ST_WORKAROUND: Add unique ID callback as input parameter */
 486:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** SecureElementStatus_t SecureElementInit( SecureElementNvmData_t *nvm, SecureElementGetUniqueId seGe
 487:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** {
 488:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if (!defined (LORAWAN_KMS) || (LORAWAN_KMS == 0))
 489:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SecureElementNvmData_t seNvmInit =
 490:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 491:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         /*!
 492:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         * end-device IEEE EUI (big endian)
 493:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         *
 494:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         * \remark In this application the value is automatically generated by
 495:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         *         calling BoardGetUniqueId function
 496:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         */
 497:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         .DevEui = LORAWAN_DEVICE_EUI,
 498:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         /*!
 499:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         * App/Join server IEEE EUI (big endian)
 500:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         */
 501:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         .JoinEui = LORAWAN_JOIN_EUI,
 502:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         /*!
 503:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         * LoRaWAN key list
 504:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         */
 505:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         .KeyList = SOFT_SE_KEY_LIST
 506:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     };
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s 			page 15


 507:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 508:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 509:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( nvm == NULL )
 510:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 511:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return SECURE_ELEMENT_ERROR_NPE;
 512:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 513:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 514:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     // Initialize nvm pointer
 515:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SeNvm = nvm;
 516:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 517:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     // Initialize data
 518:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     memcpy1( ( uint8_t* )SeNvm, ( uint8_t* )&seNvmInit, sizeof( seNvmInit ) );
 519:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #else /* LORAWAN_KMS == 1 */
 520:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     uint8_t itr = 0;
 521:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     uint8_t devEUI[SE_EUI_SIZE] = LORAWAN_DEVICE_EUI;
 522:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     uint8_t joinEUI[SE_EUI_SIZE] = LORAWAN_JOIN_EUI;
 523:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 524:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (nvm == NULL)
 525:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 526:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return SECURE_ELEMENT_ERROR_NPE;
 527:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 528:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 529:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Initialize nvm pointer */
 530:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SeNvm = nvm;
 531:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 532:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Initialize with defaults */
 533:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     memcpy1((uint8_t *)SeNvm->DevEui, devEUI, SE_EUI_SIZE);
 534:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     memcpy1((uint8_t *)SeNvm->JoinEui, joinEUI, SE_EUI_SIZE);
 535:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 536:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SeNvm->KeyList[itr++].KeyID = APP_KEY;
 537:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SeNvm->KeyList[itr++].KeyID = NWK_KEY;
 538:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if ( USE_LRWAN_1_1_X_CRYPTO == 1 )
 539:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SeNvm->KeyList[itr++].KeyID = J_S_INT_KEY;
 540:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SeNvm->KeyList[itr++].KeyID = J_S_ENC_KEY;
 541:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SeNvm->KeyList[itr++].KeyID = F_NWK_S_INT_KEY;
 542:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SeNvm->KeyList[itr++].KeyID = S_NWK_S_INT_KEY;
 543:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SeNvm->KeyList[itr++].KeyID = NWK_S_ENC_KEY;
 544:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #else /* USE_LRWAN_1_1_X_CRYPTO == 0 */
 545:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SeNvm->KeyList[itr++].KeyID = NWK_S_KEY;
 546:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* USE_LRWAN_1_1_X_CRYPTO */
 547:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SeNvm->KeyList[itr++].KeyID = APP_S_KEY;
 548:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SeNvm->KeyList[itr++].KeyID = MC_ROOT_KEY;
 549:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SeNvm->KeyList[itr++].KeyID = MC_KE_KEY;
 550:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SeNvm->KeyList[itr++].KeyID = MC_KEY_0;
 551:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SeNvm->KeyList[itr++].KeyID = MC_APP_S_KEY_0;
 552:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SeNvm->KeyList[itr++].KeyID = MC_NWK_S_KEY_0;
 553:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if ( LORAMAC_MAX_MC_CTX > 1 )
 554:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SeNvm->KeyList[itr++].KeyID = MC_KEY_1;
 555:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SeNvm->KeyList[itr++].KeyID = MC_APP_S_KEY_1;
 556:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SeNvm->KeyList[itr++].KeyID = MC_NWK_S_KEY_1;
 557:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SeNvm->KeyList[itr++].KeyID = MC_KEY_2;
 558:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SeNvm->KeyList[itr++].KeyID = MC_APP_S_KEY_2;
 559:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SeNvm->KeyList[itr++].KeyID = MC_NWK_S_KEY_2;
 560:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SeNvm->KeyList[itr++].KeyID = MC_KEY_3;
 561:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SeNvm->KeyList[itr++].KeyID = MC_APP_S_KEY_3;
 562:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SeNvm->KeyList[itr++].KeyID = MC_NWK_S_KEY_3;
 563:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /*LORAMAC_MAX_MC_CTX > 1 */
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s 			page 16


 564:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SeNvm->KeyList[itr].KeyID = SLOT_RAND_ZERO_KEY;
 565:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 566:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Delete all obsolete keys in NVM  */
 567:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     DeleteAllDynamicKeys();
 568:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 569:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SecureElementSetObjHandler(APP_KEY, KMS_APP_KEY_OBJECT_HANDLE);
 570:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SecureElementSetObjHandler(NWK_KEY, KMS_NWK_KEY_OBJECT_HANDLE);
 571:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SecureElementSetObjHandler(APP_S_KEY, KMS_APP_S_KEY_OBJECT_HANDLE);
 572:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SecureElementSetObjHandler(NWK_S_KEY, KMS_NWK_S_KEY_OBJECT_HANDLE);
 573:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if ( LORAMAC_CLASSB_ENABLED == 1 )
 574:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SecureElementSetObjHandler(SLOT_RAND_ZERO_KEY, KMS_ZERO_KEY_OBJECT_HANDLE);
 575:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* LORAMAC_CLASSB_ENABLED */
 576:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* LORAWAN_KMS */
 577:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 578:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if (defined (KEY_EXTRACTABLE) && (KEY_EXTRACTABLE == 1))
 579:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     MW_LOG(TS_OFF, VLEVEL_M, "###### OTAA ######\r\n");
 580:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     PrintKey(APP_KEY);
 581:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     PrintKey(NWK_KEY);
 582:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     MW_LOG(TS_OFF, VLEVEL_M, "###### ABP  ######\r\n");
 583:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     PrintKey(APP_S_KEY);
 584:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     PrintKey(NWK_S_KEY);
 585:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* KEY_EXTRACTABLE */
 586:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 587:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if !defined( SECURE_ELEMENT_PRE_PROVISIONED )
 588:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if( STATIC_DEVICE_EUI == 0 )
 589:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (seGetUniqueId != NULL)
 590:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 591:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         // Get a DevEUI from MCU unique ID
 592:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         seGetUniqueId(SeNvm->DevEui);
 593:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 594:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* STATIC_DEVICE_EUI */
 595:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* !SECURE_ELEMENT_PRE_PROVISIONED */
 596:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     return SECURE_ELEMENT_SUCCESS;
 597:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** }
 598:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 599:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** /* ST_WORKAROUND_BEGIN: Add KMS specific functions */
 600:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** SecureElementStatus_t SecureElementGetKeyByID( KeyIdentifier_t keyID, Key_t **keyItem )
 601:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** {
 263              		.loc 1 601 1 is_stmt 1 view -0
 264              		.cfi_startproc
 265              		@ args = 0, pretend = 0, frame = 0
 266              		@ frame_needed = 0, uses_anonymous_args = 0
 267              		@ link register save eliminated.
 602:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if (!defined (LORAWAN_KMS) || (LORAWAN_KMS == 0))
 603:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if (defined (KEY_EXTRACTABLE) && (KEY_EXTRACTABLE == 1))
 604:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     for (uint8_t i = 0; i < NUM_OF_KEYS; i++)
 268              		.loc 1 604 5 view .LVU64
 269              	.LBB5:
 270              		.loc 1 604 10 view .LVU65
 271              		.loc 1 604 18 is_stmt 0 view .LVU66
 272 0000 0023     		movs	r3, #0
 273              	.LVL22:
 274              		.loc 1 604 25 is_stmt 1 view .LVU67
 275              		.loc 1 604 5 is_stmt 0 view .LVU68
 276 0002 092B     		cmp	r3, #9
 277 0004 17D8     		bhi	.L32
 278              	.LBE5:
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s 			page 17


 601:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if (!defined (LORAWAN_KMS) || (LORAWAN_KMS == 0))
 279              		.loc 1 601 1 view .LVU69
 280 0006 10B4     		push	{r4}
 281              	.LCFI8:
 282              		.cfi_def_cfa_offset 4
 283              		.cfi_offset 4, -4
 284              	.L26:
 285              	.LBB6:
 605:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 606:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         if (SeNvm->KeyList[i].KeyID == keyID)
 286              		.loc 1 606 9 is_stmt 1 view .LVU70
 287              		.loc 1 606 18 is_stmt 0 view .LVU71
 288 0008 0C4A     		ldr	r2, .L34
 289 000a 1468     		ldr	r4, [r2]
 290              		.loc 1 606 30 view .LVU72
 291 000c 03EB0312 		add	r2, r3, r3, lsl #4
 292 0010 2244     		add	r2, r2, r4
 293 0012 127C     		ldrb	r2, [r2, #16]	@ zero_extendqisi2
 294              		.loc 1 606 12 view .LVU73
 295 0014 8242     		cmp	r2, r0
 296 0016 06D0     		beq	.L33
 604:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 297              		.loc 1 604 42 is_stmt 1 discriminator 2 view .LVU74
 604:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 298              		.loc 1 604 43 is_stmt 0 discriminator 2 view .LVU75
 299 0018 0133     		adds	r3, r3, #1
 300              	.LVL23:
 604:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 301              		.loc 1 604 43 discriminator 2 view .LVU76
 302 001a DBB2     		uxtb	r3, r3
 303              	.LVL24:
 604:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 304              		.loc 1 604 25 is_stmt 1 discriminator 2 view .LVU77
 604:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 305              		.loc 1 604 5 is_stmt 0 discriminator 2 view .LVU78
 306 001c 092B     		cmp	r3, #9
 307 001e F3D9     		bls	.L26
 308              	.LBE6:
 607:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 608:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             *keyItem = &(SeNvm->KeyList[i]);
 609:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             return SECURE_ELEMENT_SUCCESS;
 610:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 611:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 612:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* KEY_EXTRACTABLE */
 613:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     return SECURE_ELEMENT_ERROR_INVALID_KEY_ID;
 309              		.loc 1 613 12 view .LVU79
 310 0020 0320     		movs	r0, #3
 311              	.LVL25:
 312              	.L25:
 614:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #else /* LORAWAN_KMS == 1 */
 615:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_RV rv;
 616:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_SESSION_HANDLE session;
 617:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_FLAGS session_flags = CKF_SERIAL_SESSION;  /* Read ONLY session */
 618:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_OBJECT_HANDLE key_handle = (CK_OBJECT_HANDLE)(~0UL);
 619:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_ULONG derive_key_template_class = CKO_SECRET_KEY;
 620:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     uint8_t extractable_key[16] = {0};
 621:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_ATTRIBUTE key_attribute_template = {CKA_VALUE, (CK_VOID_PTR) &derive_key_template_class, 16U
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s 			page 18


 622:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     uint8_t index_keylist = 0;
 623:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     for (index_keylist = 0; index_keylist < NUM_OF_KEYS; index_keylist++)
 624:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 625:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         if (SeNvm->KeyList[index_keylist].KeyID == keyID)
 626:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 627:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             key_handle = SeNvm->KeyList[index_keylist].Object_Index;
 628:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             break;
 629:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 630:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 631:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (key_handle == (CK_OBJECT_HANDLE)(~0UL))
 632:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 633:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return SECURE_ELEMENT_ERROR_INVALID_KEY_ID;
 634:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 635:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 636:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Open session with KMS */
 637:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     rv = C_OpenSession(0, session_flags, NULL, 0, &session);
 638:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 639:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Get key to display */
 640:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (rv == CKR_OK)
 641:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 642:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         key_attribute_template.pValue = extractable_key;
 643:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         rv = C_GetAttributeValue(session, key_handle, &key_attribute_template, 1UL);
 644:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 645:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (rv == CKR_OK)
 646:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 647:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         memcpy1(SeNvm->KeyList[index_keylist].KeyValue, extractable_key, sizeof(extractable_key));
 648:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         *keyItem = &(SeNvm->KeyList[index_keylist]);
 649:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 650:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 651:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Close sessions */
 652:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     (void)C_CloseSession(session);
 653:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 654:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (rv != CKR_OK)
 655:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 656:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return SECURE_ELEMENT_ERROR;
 657:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 658:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     return SECURE_ELEMENT_SUCCESS;
 659:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 660:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* LORAWAN_KMS == 1 */
 661:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** }
 313              		.loc 1 661 1 view .LVU80
 314 0022 10BC     		pop	{r4}
 315              	.LCFI9:
 316              		.cfi_remember_state
 317              		.cfi_restore 4
 318              		.cfi_def_cfa_offset 0
 319 0024 7047     		bx	lr
 320              	.LVL26:
 321              	.L33:
 322              	.LCFI10:
 323              		.cfi_restore_state
 324              	.LBB7:
 608:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             return SECURE_ELEMENT_SUCCESS;
 325              		.loc 1 608 13 is_stmt 1 view .LVU81
 608:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             return SECURE_ELEMENT_SUCCESS;
 326              		.loc 1 608 24 is_stmt 0 view .LVU82
 327 0026 03EB031C 		add	ip, r3, r3, lsl #4
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s 			page 19


 328 002a 0CF1100C 		add	ip, ip, #16
 329 002e 6444     		add	r4, r4, ip
 608:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             return SECURE_ELEMENT_SUCCESS;
 330              		.loc 1 608 22 view .LVU83
 331 0030 0C60     		str	r4, [r1]
 609:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 332              		.loc 1 609 13 is_stmt 1 view .LVU84
 609:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 333              		.loc 1 609 20 is_stmt 0 view .LVU85
 334 0032 0020     		movs	r0, #0
 335              	.LVL27:
 609:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 336              		.loc 1 609 20 view .LVU86
 337 0034 F5E7     		b	.L25
 338              	.LVL28:
 339              	.L32:
 340              	.LCFI11:
 341              		.cfi_def_cfa_offset 0
 342              		.cfi_restore 4
 609:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 343              		.loc 1 609 20 view .LVU87
 344              	.LBE7:
 613:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #else /* LORAWAN_KMS == 1 */
 345              		.loc 1 613 12 view .LVU88
 346 0036 0320     		movs	r0, #3
 347              	.LVL29:
 348              		.loc 1 661 1 view .LVU89
 349 0038 7047     		bx	lr
 350              	.L35:
 351 003a 00BF     		.align	2
 352              	.L34:
 353 003c 00000000 		.word	.LANCHOR0
 354              		.cfi_endproc
 355              	.LFE108:
 357              		.section	.rodata.PrintKey.str1.4,"aMS",%progbits,1
 358              		.align	2
 359              	.LC0:
 360 0000 23232323 		.ascii	"###### AppKey:      \000"
 360      23232041 
 360      70704B65 
 360      793A2020 
 360      20202020 
 361 0015 000000   		.align	2
 362              	.LC1:
 363 0018 23232323 		.ascii	"###### NwkKey:      \000"
 363      2323204E 
 363      776B4B65 
 363      793A2020 
 363      20202020 
 364 002d 000000   		.align	2
 365              	.LC2:
 366 0030 23232323 		.ascii	"###### AppSKey:     \000"
 366      23232041 
 366      7070534B 
 366      65793A20 
 366      20202020 
 367 0045 000000   		.align	2
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s 			page 20


 368              	.LC3:
 369 0048 23232323 		.ascii	"###### NwkSKey:     \000"
 369      2323204E 
 369      776B534B 
 369      65793A20 
 369      20202020 
 370 005d 000000   		.align	2
 371              	.LC4:
 372 0060 23232323 		.ascii	"###### MCRootKey:   \000"
 372      2323204D 
 372      43526F6F 
 372      744B6579 
 372      3A202020 
 373 0075 000000   		.align	2
 374              	.LC5:
 375 0078 23232323 		.ascii	"###### MCKEKey:     \000"
 375      2323204D 
 375      434B454B 
 375      65793A20 
 375      20202020 
 376 008d 000000   		.align	2
 377              	.LC6:
 378 0090 23232323 		.ascii	"###### MCKey_0:     \000"
 378      2323204D 
 378      434B6579 
 378      5F303A20 
 378      20202020 
 379 00a5 000000   		.align	2
 380              	.LC7:
 381 00a8 23232323 		.ascii	"###### MCAppSKey_0: \000"
 381      2323204D 
 381      43417070 
 381      534B6579 
 381      5F303A20 
 382 00bd 000000   		.align	2
 383              	.LC8:
 384 00c0 23232323 		.ascii	"###### MCNwkSKey_0: \000"
 384      2323204D 
 384      434E776B 
 384      534B6579 
 384      5F303A20 
 385 00d5 000000   		.align	2
 386              	.LC9:
 387 00d8 25303258 		.ascii	"%02X:%02X:%02X:%02X:%02X:%02X:%02X:%02X:%02X:%02X:%"
 387      3A253032 
 387      583A2530 
 387      32583A25 
 387      3032583A 
 388 010b 3032583A 		.ascii	"02X:%02X:%02X:%02X:%02X:%02X\015\012\000"
 388      25303258 
 388      3A253032 
 388      583A2530 
 388      32583A25 
 389              		.section	.text.PrintKey,"ax",%progbits
 390              		.align	1
 391              		.syntax unified
 392              		.thumb
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s 			page 21


 393              		.thumb_func
 395              	PrintKey:
 396              	.LVL30:
 397              	.LFB104:
 130:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SecureElementStatus_t retval = SECURE_ELEMENT_ERROR;
 398              		.loc 1 130 1 is_stmt 1 view -0
 399              		.cfi_startproc
 400              		@ args = 0, pretend = 0, frame = 16
 401              		@ frame_needed = 0, uses_anonymous_args = 0
 130:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SecureElementStatus_t retval = SECURE_ELEMENT_ERROR;
 402              		.loc 1 130 1 is_stmt 0 view .LVU91
 403 0000 2DE9F04F 		push	{r4, r5, r6, r7, r8, r9, r10, fp, lr}
 404              	.LCFI12:
 405              		.cfi_def_cfa_offset 36
 406              		.cfi_offset 4, -36
 407              		.cfi_offset 5, -32
 408              		.cfi_offset 6, -28
 409              		.cfi_offset 7, -24
 410              		.cfi_offset 8, -20
 411              		.cfi_offset 9, -16
 412              		.cfi_offset 10, -12
 413              		.cfi_offset 11, -8
 414              		.cfi_offset 14, -4
 415 0004 95B0     		sub	sp, sp, #84
 416              	.LCFI13:
 417              		.cfi_def_cfa_offset 120
 418 0006 0446     		mov	r4, r0
 131:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     Key_t *keyItem;
 419              		.loc 1 131 5 is_stmt 1 view .LVU92
 420              	.LVL31:
 132:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     retval = SecureElementGetKeyByID(key, &keyItem);
 421              		.loc 1 132 5 view .LVU93
 133:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (retval == SECURE_ELEMENT_SUCCESS)
 422              		.loc 1 133 5 view .LVU94
 133:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (retval == SECURE_ELEMENT_SUCCESS)
 423              		.loc 1 133 14 is_stmt 0 view .LVU95
 424 0008 13A9     		add	r1, sp, #76
 425 000a FFF7FEFF 		bl	SecureElementGetKeyByID
 426              	.LVL32:
 134:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 427              		.loc 1 134 5 is_stmt 1 view .LVU96
 134:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 428              		.loc 1 134 8 is_stmt 0 view .LVU97
 429 000e 0028     		cmp	r0, #0
 430 0010 54D1     		bne	.L36
 136:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 431              		.loc 1 136 9 is_stmt 1 view .LVU98
 136:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 432              		.loc 1 136 12 is_stmt 0 view .LVU99
 433 0012 B4B1     		cbz	r4, .L48
 140:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 434              		.loc 1 140 14 is_stmt 1 view .LVU100
 140:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 435              		.loc 1 140 17 is_stmt 0 view .LVU101
 436 0014 012C     		cmp	r4, #1
 437 0016 54D0     		beq	.L49
 144:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s 			page 22


 438              		.loc 1 144 14 is_stmt 1 view .LVU102
 144:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 439              		.loc 1 144 17 is_stmt 0 view .LVU103
 440 0018 032C     		cmp	r4, #3
 441 001a 59D0     		beq	.L50
 148:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 442              		.loc 1 148 14 is_stmt 1 view .LVU104
 148:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 443              		.loc 1 148 17 is_stmt 0 view .LVU105
 444 001c 022C     		cmp	r4, #2
 445 001e 5ED0     		beq	.L51
 152:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 446              		.loc 1 152 14 is_stmt 1 view .LVU106
 152:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 447              		.loc 1 152 17 is_stmt 0 view .LVU107
 448 0020 042C     		cmp	r4, #4
 449 0022 63D0     		beq	.L52
 156:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 450              		.loc 1 156 14 is_stmt 1 view .LVU108
 156:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 451              		.loc 1 156 17 is_stmt 0 view .LVU109
 452 0024 7F2C     		cmp	r4, #127
 453 0026 68D0     		beq	.L53
 160:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 454              		.loc 1 160 14 is_stmt 1 view .LVU110
 160:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 455              		.loc 1 160 17 is_stmt 0 view .LVU111
 456 0028 802C     		cmp	r4, #128
 457 002a 6DD0     		beq	.L54
 164:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 458              		.loc 1 164 14 is_stmt 1 view .LVU112
 164:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 459              		.loc 1 164 17 is_stmt 0 view .LVU113
 460 002c 812C     		cmp	r4, #129
 461 002e 72D0     		beq	.L55
 168:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 462              		.loc 1 168 14 is_stmt 1 view .LVU114
 168:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 463              		.loc 1 168 17 is_stmt 0 view .LVU115
 464 0030 822C     		cmp	r4, #130
 465 0032 0CD1     		bne	.L39
 170:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 466              		.loc 1 170 13 is_stmt 1 view .LVU116
 170:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 467              		.loc 1 170 13 view .LVU117
 468 0034 3B4B     		ldr	r3, .L56
 469 0036 0022     		movs	r2, #0
 470 0038 1146     		mov	r1, r2
 471 003a 0220     		movs	r0, #2
 472              	.LVL33:
 170:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 473              		.loc 1 170 13 is_stmt 0 view .LVU118
 474 003c FFF7FEFF 		bl	UTIL_ADV_TRACE_COND_FSend
 475              	.LVL34:
 476 0040 05E0     		b	.L39
 477              	.LVL35:
 478              	.L48:
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s 			page 23


 138:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 479              		.loc 1 138 13 is_stmt 1 view .LVU119
 138:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 480              		.loc 1 138 13 view .LVU120
 481 0042 394B     		ldr	r3, .L56+4
 482 0044 0022     		movs	r2, #0
 483 0046 1146     		mov	r1, r2
 484 0048 0220     		movs	r0, #2
 485              	.LVL36:
 138:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 486              		.loc 1 138 13 is_stmt 0 view .LVU121
 487 004a FFF7FEFF 		bl	UTIL_ADV_TRACE_COND_FSend
 488              	.LVL37:
 138:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 489              		.loc 1 138 13 is_stmt 1 view .LVU122
 490              	.L39:
 170:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 491              		.loc 1 170 13 discriminator 1 view .LVU123
 172:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                HEX16(keyItem->KeyValue));
 492              		.loc 1 172 9 discriminator 1 view .LVU124
 172:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                HEX16(keyItem->KeyValue));
 493              		.loc 1 172 9 discriminator 1 view .LVU125
 494 004e 139B     		ldr	r3, [sp, #76]
 495 0050 5A78     		ldrb	r2, [r3, #1]	@ zero_extendqisi2
 496 0052 1092     		str	r2, [sp, #64]
 497 0054 9978     		ldrb	r1, [r3, #2]	@ zero_extendqisi2
 498 0056 1191     		str	r1, [sp, #68]
 499 0058 DA78     		ldrb	r2, [r3, #3]	@ zero_extendqisi2
 500 005a 1979     		ldrb	r1, [r3, #4]	@ zero_extendqisi2
 501 005c 5879     		ldrb	r0, [r3, #5]	@ zero_extendqisi2
 502 005e 9C79     		ldrb	r4, [r3, #6]	@ zero_extendqisi2
 503 0060 DD79     		ldrb	r5, [r3, #7]	@ zero_extendqisi2
 504 0062 1E7A     		ldrb	r6, [r3, #8]	@ zero_extendqisi2
 505 0064 5F7A     		ldrb	r7, [r3, #9]	@ zero_extendqisi2
 506 0066 93F80AC0 		ldrb	ip, [r3, #10]	@ zero_extendqisi2
 507 006a 93F80BE0 		ldrb	lr, [r3, #11]	@ zero_extendqisi2
 508 006e 93F80C80 		ldrb	r8, [r3, #12]	@ zero_extendqisi2
 509 0072 93F80D90 		ldrb	r9, [r3, #13]	@ zero_extendqisi2
 510 0076 93F80EA0 		ldrb	r10, [r3, #14]	@ zero_extendqisi2
 511 007a 93F80FB0 		ldrb	fp, [r3, #15]	@ zero_extendqisi2
 512 007e 1B7C     		ldrb	r3, [r3, #16]	@ zero_extendqisi2
 513 0080 0F93     		str	r3, [sp, #60]
 514 0082 CDF838B0 		str	fp, [sp, #56]
 515 0086 CDF834A0 		str	r10, [sp, #52]
 516 008a CDF83090 		str	r9, [sp, #48]
 517 008e CDF82C80 		str	r8, [sp, #44]
 518 0092 CDF828E0 		str	lr, [sp, #40]
 519 0096 CDF824C0 		str	ip, [sp, #36]
 520 009a 0897     		str	r7, [sp, #32]
 521 009c 0796     		str	r6, [sp, #28]
 522 009e 0695     		str	r5, [sp, #24]
 523 00a0 0594     		str	r4, [sp, #20]
 524 00a2 0490     		str	r0, [sp, #16]
 525 00a4 0391     		str	r1, [sp, #12]
 526 00a6 0292     		str	r2, [sp, #8]
 527 00a8 1199     		ldr	r1, [sp, #68]
 528 00aa 0191     		str	r1, [sp, #4]
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s 			page 24


 529 00ac 109A     		ldr	r2, [sp, #64]
 530 00ae 0092     		str	r2, [sp]
 531 00b0 1E4B     		ldr	r3, .L56+8
 532 00b2 0022     		movs	r2, #0
 533 00b4 1146     		mov	r1, r2
 534 00b6 0220     		movs	r0, #2
 535 00b8 FFF7FEFF 		bl	UTIL_ADV_TRACE_COND_FSend
 536              	.LVL38:
 172:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                HEX16(keyItem->KeyValue));
 537              		.loc 1 172 9 discriminator 1 view .LVU126
 538              	.L36:
 175:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* KEY_EXTRACTABLE */
 539              		.loc 1 175 1 is_stmt 0 view .LVU127
 540 00bc 15B0     		add	sp, sp, #84
 541              	.LCFI14:
 542              		.cfi_remember_state
 543              		.cfi_def_cfa_offset 36
 544              		@ sp needed
 545 00be BDE8F08F 		pop	{r4, r5, r6, r7, r8, r9, r10, fp, pc}
 546              	.LVL39:
 547              	.L49:
 548              	.LCFI15:
 549              		.cfi_restore_state
 142:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 550              		.loc 1 142 13 is_stmt 1 view .LVU128
 142:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 551              		.loc 1 142 13 view .LVU129
 552 00c2 1B4B     		ldr	r3, .L56+12
 553 00c4 0022     		movs	r2, #0
 554 00c6 1146     		mov	r1, r2
 555 00c8 0220     		movs	r0, #2
 556              	.LVL40:
 142:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 557              		.loc 1 142 13 is_stmt 0 view .LVU130
 558 00ca FFF7FEFF 		bl	UTIL_ADV_TRACE_COND_FSend
 559              	.LVL41:
 142:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 560              		.loc 1 142 13 is_stmt 1 view .LVU131
 561 00ce BEE7     		b	.L39
 562              	.LVL42:
 563              	.L50:
 146:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 564              		.loc 1 146 13 view .LVU132
 146:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 565              		.loc 1 146 13 view .LVU133
 566 00d0 184B     		ldr	r3, .L56+16
 567 00d2 0022     		movs	r2, #0
 568 00d4 1146     		mov	r1, r2
 569 00d6 0220     		movs	r0, #2
 570              	.LVL43:
 146:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 571              		.loc 1 146 13 is_stmt 0 view .LVU134
 572 00d8 FFF7FEFF 		bl	UTIL_ADV_TRACE_COND_FSend
 573              	.LVL44:
 146:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 574              		.loc 1 146 13 is_stmt 1 view .LVU135
 575 00dc B7E7     		b	.L39
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s 			page 25


 576              	.LVL45:
 577              	.L51:
 150:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 578              		.loc 1 150 13 view .LVU136
 150:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 579              		.loc 1 150 13 view .LVU137
 580 00de 164B     		ldr	r3, .L56+20
 581 00e0 0022     		movs	r2, #0
 582 00e2 1146     		mov	r1, r2
 583 00e4 0220     		movs	r0, #2
 584              	.LVL46:
 150:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 585              		.loc 1 150 13 is_stmt 0 view .LVU138
 586 00e6 FFF7FEFF 		bl	UTIL_ADV_TRACE_COND_FSend
 587              	.LVL47:
 150:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 588              		.loc 1 150 13 is_stmt 1 view .LVU139
 589 00ea B0E7     		b	.L39
 590              	.LVL48:
 591              	.L52:
 154:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 592              		.loc 1 154 13 view .LVU140
 154:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 593              		.loc 1 154 13 view .LVU141
 594 00ec 134B     		ldr	r3, .L56+24
 595 00ee 0022     		movs	r2, #0
 596 00f0 1146     		mov	r1, r2
 597 00f2 0220     		movs	r0, #2
 598              	.LVL49:
 154:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 599              		.loc 1 154 13 is_stmt 0 view .LVU142
 600 00f4 FFF7FEFF 		bl	UTIL_ADV_TRACE_COND_FSend
 601              	.LVL50:
 154:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 602              		.loc 1 154 13 is_stmt 1 view .LVU143
 603 00f8 A9E7     		b	.L39
 604              	.LVL51:
 605              	.L53:
 158:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 606              		.loc 1 158 13 view .LVU144
 158:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 607              		.loc 1 158 13 view .LVU145
 608 00fa 114B     		ldr	r3, .L56+28
 609 00fc 0022     		movs	r2, #0
 610 00fe 1146     		mov	r1, r2
 611 0100 0220     		movs	r0, #2
 612              	.LVL52:
 158:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 613              		.loc 1 158 13 is_stmt 0 view .LVU146
 614 0102 FFF7FEFF 		bl	UTIL_ADV_TRACE_COND_FSend
 615              	.LVL53:
 158:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 616              		.loc 1 158 13 is_stmt 1 view .LVU147
 617 0106 A2E7     		b	.L39
 618              	.LVL54:
 619              	.L54:
 162:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s 			page 26


 620              		.loc 1 162 13 view .LVU148
 162:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 621              		.loc 1 162 13 view .LVU149
 622 0108 0E4B     		ldr	r3, .L56+32
 623 010a 0022     		movs	r2, #0
 624 010c 1146     		mov	r1, r2
 625 010e 0220     		movs	r0, #2
 626              	.LVL55:
 162:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 627              		.loc 1 162 13 is_stmt 0 view .LVU150
 628 0110 FFF7FEFF 		bl	UTIL_ADV_TRACE_COND_FSend
 629              	.LVL56:
 162:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 630              		.loc 1 162 13 is_stmt 1 view .LVU151
 631 0114 9BE7     		b	.L39
 632              	.LVL57:
 633              	.L55:
 166:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 634              		.loc 1 166 13 view .LVU152
 166:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 635              		.loc 1 166 13 view .LVU153
 636 0116 0C4B     		ldr	r3, .L56+36
 637 0118 0022     		movs	r2, #0
 638 011a 1146     		mov	r1, r2
 639 011c 0220     		movs	r0, #2
 640              	.LVL58:
 166:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 641              		.loc 1 166 13 is_stmt 0 view .LVU154
 642 011e FFF7FEFF 		bl	UTIL_ADV_TRACE_COND_FSend
 643              	.LVL59:
 166:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 644              		.loc 1 166 13 is_stmt 1 view .LVU155
 645 0122 94E7     		b	.L39
 646              	.L57:
 647              		.align	2
 648              	.L56:
 649 0124 C0000000 		.word	.LC8
 650 0128 00000000 		.word	.LC0
 651 012c D8000000 		.word	.LC9
 652 0130 18000000 		.word	.LC1
 653 0134 30000000 		.word	.LC2
 654 0138 48000000 		.word	.LC3
 655 013c 60000000 		.word	.LC4
 656 0140 78000000 		.word	.LC5
 657 0144 90000000 		.word	.LC6
 658 0148 A8000000 		.word	.LC7
 659              		.cfi_endproc
 660              	.LFE104:
 662              		.section	.rodata.SecureElementInit.str1.4,"aMS",%progbits,1
 663              		.align	2
 664              	.LC13:
 665 0000 23232323 		.ascii	"###### OTAA ######\015\012\000"
 665      2323204F 
 665      54414120 
 665      23232323 
 665      23230D0A 
 666 0015 000000   		.align	2
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s 			page 27


 667              	.LC14:
 668 0018 23232323 		.ascii	"###### ABP  ######\015\012\000"
 668      23232041 
 668      42502020 
 668      23232323 
 668      23230D0A 
 669 002d 000000   		.align	2
 670              	.LC11:
 671 0030 01010101 		.ascii	"\001\001\001\001\001\001\001\001\000"
 671      01010101 
 671      00
 672 0039 000000   		.align	2
 673              	.LC12:
 674 003c 2B7E1516 		.ascii	"+~\025\026(\256\322\246\253\367\025\210\011\317O<\000"
 674      28AED2A6 
 674      ABF71588 
 674      09CF4F3C 
 674      00
 675              		.section	.text.SecureElementInit,"ax",%progbits
 676              		.align	1
 677              		.global	SecureElementInit
 678              		.syntax unified
 679              		.thumb
 680              		.thumb_func
 682              	SecureElementInit:
 683              	.LVL60:
 684              	.LFB107:
 487:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if (!defined (LORAWAN_KMS) || (LORAWAN_KMS == 0))
 685              		.loc 1 487 1 view -0
 686              		.cfi_startproc
 687              		@ args = 0, pretend = 0, frame = 192
 688              		@ frame_needed = 0, uses_anonymous_args = 0
 487:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if (!defined (LORAWAN_KMS) || (LORAWAN_KMS == 0))
 689              		.loc 1 487 1 is_stmt 0 view .LVU157
 690 0000 70B5     		push	{r4, r5, r6, lr}
 691              	.LCFI16:
 692              		.cfi_def_cfa_offset 16
 693              		.cfi_offset 4, -16
 694              		.cfi_offset 5, -12
 695              		.cfi_offset 6, -8
 696              		.cfi_offset 14, -4
 697 0002 B0B0     		sub	sp, sp, #192
 698              	.LCFI17:
 699              		.cfi_def_cfa_offset 208
 700 0004 0546     		mov	r5, r0
 701 0006 0E46     		mov	r6, r1
 489:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 702              		.loc 1 489 5 is_stmt 1 view .LVU158
 489:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 703              		.loc 1 489 28 is_stmt 0 view .LVU159
 704 0008 6C46     		mov	r4, sp
 705 000a C022     		movs	r2, #192
 706 000c 0021     		movs	r1, #0
 707              	.LVL61:
 489:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 708              		.loc 1 489 28 view .LVU160
 709 000e 2046     		mov	r0, r4
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s 			page 28


 710              	.LVL62:
 489:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 711              		.loc 1 489 28 view .LVU161
 712 0010 FFF7FEFF 		bl	memset
 713              	.LVL63:
 714 0014 3C4B     		ldr	r3, .L63
 715 0016 93E80300 		ldm	r3, {r0, r1}
 716 001a 84E80300 		stm	r4, {r0, r1}
 717 001e 3B4A     		ldr	r2, .L63+4
 718 0020 02AB     		add	r3, sp, #8
 719 0022 92E80300 		ldm	r2, {r0, r1}
 720 0026 83E80300 		stm	r3, {r0, r1}
 721 002a 394C     		ldr	r4, .L63+8
 722 002c A446     		mov	ip, r4
 723 002e BCE80F00 		ldmia	ip!, {r0, r1, r2, r3}
 724 0032 CDF81100 		str	r0, [sp, #17]	@ unaligned
 725 0036 CDF81510 		str	r1, [sp, #21]	@ unaligned
 726 003a CDF81920 		str	r2, [sp, #25]	@ unaligned
 727 003e CDF81D30 		str	r3, [sp, #29]	@ unaligned
 728 0042 0123     		movs	r3, #1
 729 0044 8DF82130 		strb	r3, [sp, #33]
 730 0048 A446     		mov	ip, r4
 731 004a BCE80F00 		ldmia	ip!, {r0, r1, r2, r3}
 732 004e CDF82200 		str	r0, [sp, #34]	@ unaligned
 733 0052 CDF82610 		str	r1, [sp, #38]	@ unaligned
 734 0056 CDF82A20 		str	r2, [sp, #42]	@ unaligned
 735 005a CDF82E30 		str	r3, [sp, #46]	@ unaligned
 736 005e 0223     		movs	r3, #2
 737 0060 8DF83230 		strb	r3, [sp, #50]
 738 0064 A446     		mov	ip, r4
 739 0066 BCE80F00 		ldmia	ip!, {r0, r1, r2, r3}
 740 006a CDF83300 		str	r0, [sp, #51]	@ unaligned
 741 006e CDF83710 		str	r1, [sp, #55]	@ unaligned
 742 0072 CDF83B20 		str	r2, [sp, #59]	@ unaligned
 743 0076 CDF83F30 		str	r3, [sp, #63]	@ unaligned
 744 007a 0323     		movs	r3, #3
 745 007c 8DF84330 		strb	r3, [sp, #67]
 746 0080 0DF1440C 		add	ip, sp, #68
 747 0084 94E80F00 		ldm	r4, {r0, r1, r2, r3}
 748 0088 8CE80F00 		stm	ip, {r0, r1, r2, r3}
 749 008c 0423     		movs	r3, #4
 750 008e 8DF85430 		strb	r3, [sp, #84]
 751 0092 7F23     		movs	r3, #127
 752 0094 8DF86530 		strb	r3, [sp, #101]
 753 0098 8023     		movs	r3, #128
 754 009a 8DF87630 		strb	r3, [sp, #118]
 755 009e 8123     		movs	r3, #129
 756 00a0 8DF88730 		strb	r3, [sp, #135]
 757 00a4 8223     		movs	r3, #130
 758 00a6 8DF89830 		strb	r3, [sp, #152]
 759 00aa 8323     		movs	r3, #131
 760 00ac 8DF8A930 		strb	r3, [sp, #169]
 509:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 761              		.loc 1 509 5 is_stmt 1 view .LVU162
 509:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 762              		.loc 1 509 7 is_stmt 0 view .LVU163
 763 00b0 2DB3     		cbz	r5, .L60
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s 			page 29


 515:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 764              		.loc 1 515 5 is_stmt 1 view .LVU164
 515:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 765              		.loc 1 515 11 is_stmt 0 view .LVU165
 766 00b2 184B     		ldr	r3, .L63+12
 767 00b4 1D60     		str	r5, [r3]
 518:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #else /* LORAWAN_KMS == 1 */
 768              		.loc 1 518 5 is_stmt 1 view .LVU166
 769 00b6 C022     		movs	r2, #192
 770 00b8 6946     		mov	r1, sp
 771 00ba 2846     		mov	r0, r5
 772 00bc FFF7FEFF 		bl	memcpy1
 773              	.LVL64:
 579:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     PrintKey(APP_KEY);
 774              		.loc 1 579 5 view .LVU167
 579:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     PrintKey(APP_KEY);
 775              		.loc 1 579 5 view .LVU168
 776 00c0 154B     		ldr	r3, .L63+16
 777 00c2 0022     		movs	r2, #0
 778 00c4 1146     		mov	r1, r2
 779 00c6 0220     		movs	r0, #2
 780 00c8 FFF7FEFF 		bl	UTIL_ADV_TRACE_COND_FSend
 781              	.LVL65:
 579:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     PrintKey(APP_KEY);
 782              		.loc 1 579 5 view .LVU169
 580:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     PrintKey(NWK_KEY);
 783              		.loc 1 580 5 view .LVU170
 784 00cc 0020     		movs	r0, #0
 785 00ce FFF7FEFF 		bl	PrintKey
 786              	.LVL66:
 581:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     MW_LOG(TS_OFF, VLEVEL_M, "###### ABP  ######\r\n");
 787              		.loc 1 581 5 view .LVU171
 788 00d2 0120     		movs	r0, #1
 789 00d4 FFF7FEFF 		bl	PrintKey
 790              	.LVL67:
 582:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     PrintKey(APP_S_KEY);
 791              		.loc 1 582 5 view .LVU172
 582:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     PrintKey(APP_S_KEY);
 792              		.loc 1 582 5 view .LVU173
 793 00d8 104B     		ldr	r3, .L63+20
 794 00da 0022     		movs	r2, #0
 795 00dc 1146     		mov	r1, r2
 796 00de 0220     		movs	r0, #2
 797 00e0 FFF7FEFF 		bl	UTIL_ADV_TRACE_COND_FSend
 798              	.LVL68:
 582:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     PrintKey(APP_S_KEY);
 799              		.loc 1 582 5 view .LVU174
 583:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     PrintKey(NWK_S_KEY);
 800              		.loc 1 583 5 view .LVU175
 801 00e4 0320     		movs	r0, #3
 802 00e6 FFF7FEFF 		bl	PrintKey
 803              	.LVL69:
 584:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* KEY_EXTRACTABLE */
 804              		.loc 1 584 5 view .LVU176
 805 00ea 0220     		movs	r0, #2
 806 00ec FFF7FEFF 		bl	PrintKey
 807              	.LVL70:
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s 			page 30


 589:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 808              		.loc 1 589 5 view .LVU177
 589:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 809              		.loc 1 589 8 is_stmt 0 view .LVU178
 810 00f0 3EB1     		cbz	r6, .L61
 592:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 811              		.loc 1 592 9 is_stmt 1 view .LVU179
 812 00f2 084B     		ldr	r3, .L63+12
 813 00f4 1868     		ldr	r0, [r3]
 814 00f6 B047     		blx	r6
 815              	.LVL71:
 596:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** }
 816              		.loc 1 596 12 is_stmt 0 view .LVU180
 817 00f8 0020     		movs	r0, #0
 818              	.L59:
 597:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 819              		.loc 1 597 1 view .LVU181
 820 00fa 30B0     		add	sp, sp, #192
 821              	.LCFI18:
 822              		.cfi_remember_state
 823              		.cfi_def_cfa_offset 16
 824              		@ sp needed
 825 00fc 70BD     		pop	{r4, r5, r6, pc}
 826              	.LVL72:
 827              	.L60:
 828              	.LCFI19:
 829              		.cfi_restore_state
 511:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 830              		.loc 1 511 16 view .LVU182
 831 00fe 0220     		movs	r0, #2
 832 0100 FBE7     		b	.L59
 833              	.L61:
 596:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** }
 834              		.loc 1 596 12 view .LVU183
 835 0102 0020     		movs	r0, #0
 836 0104 F9E7     		b	.L59
 837              	.L64:
 838 0106 00BF     		.align	2
 839              	.L63:
 840 0108 00000000 		.word	.LANCHOR1
 841 010c 30000000 		.word	.LC11
 842 0110 3C000000 		.word	.LC12
 843 0114 00000000 		.word	.LANCHOR0
 844 0118 00000000 		.word	.LC13
 845 011c 18000000 		.word	.LC14
 846              		.cfi_endproc
 847              	.LFE107:
 849              		.section	.text.SecureElementDeleteDynamicKeys,"ax",%progbits
 850              		.align	1
 851              		.global	SecureElementDeleteDynamicKeys
 852              		.syntax unified
 853              		.thumb
 854              		.thumb_func
 856              	SecureElementDeleteDynamicKeys:
 857              	.LVL73:
 858              	.LFB109:
 662:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s 			page 31


 663:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** SecureElementStatus_t SecureElementDeleteDynamicKeys( KeyIdentifier_t keyID, uint32_t *key_label )
 664:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** {
 859              		.loc 1 664 1 is_stmt 1 view -0
 860              		.cfi_startproc
 861              		@ args = 0, pretend = 0, frame = 0
 862              		@ frame_needed = 0, uses_anonymous_args = 0
 863              		@ link register save eliminated.
 665:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if (!defined (LORAWAN_KMS) || (LORAWAN_KMS == 0))
 666:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     return SECURE_ELEMENT_ERROR;
 864              		.loc 1 666 5 view .LVU185
 667:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #else /* LORAWAN_KMS == 1 */
 668:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_RV rv;
 669:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_SESSION_HANDLE session;
 670:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_FLAGS session_flags = CKF_SERIAL_SESSION;    /* Read ONLY session */
 671:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_OBJECT_HANDLE hObject[NUM_OF_KEYS];
 672:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_ULONG local_template_label[] = {GlobalTemplateLabel, 0UL};
 673:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_ATTRIBUTE dynamic_key_template = {CKA_LABEL, (CK_VOID_PTR)local_template_label, sizeof(local
 674:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     uint32_t ulCount = 0;
 675:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 676:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (SECURE_ELEMENT_SUCCESS != GetSpecificLabelByID(keyID, &local_template_label[1]))
 677:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 678:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return SECURE_ELEMENT_ERROR;
 679:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 680:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     *key_label = local_template_label[1];
 681:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 682:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Open session with KMS */
 683:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     rv = C_OpenSession(0,    session_flags, NULL, 0, &session);
 684:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 685:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Search from Template pattern */
 686:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (rv == CKR_OK)
 687:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 688:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         rv = C_FindObjectsInit(session, &dynamic_key_template, sizeof(dynamic_key_template) / sizeo
 689:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 690:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 691:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Find all existing keys handle Template pattern */
 692:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (rv == CKR_OK)
 693:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 694:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         rv = C_FindObjects(session, hObject, NUM_OF_KEYS, (CK_ULONG *) &ulCount);
 695:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 696:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 697:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (rv == CKR_OK)
 698:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 699:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         rv = C_FindObjectsFinal(session);
 700:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 701:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 702:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (ulCount <= NUM_OF_KEYS)
 703:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 704:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         for (uint8_t i = 0; i < ulCount; i++)
 705:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 706:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             if (rv == CKR_OK)
 707:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             {
 708:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                 rv = C_DestroyObject(session, hObject[i]);
 709:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             }
 710:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 711:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 712:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 713:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Close sessions */
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s 			page 32


 714:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (session > 0)
 715:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 716:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         (void)C_CloseSession(session);
 717:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 718:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 719:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (rv != CKR_OK)
 720:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 721:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return SECURE_ELEMENT_ERROR;
 722:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 723:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     return SECURE_ELEMENT_SUCCESS;
 724:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* LORAWAN_KMS == 1 */
 725:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** }
 865              		.loc 1 725 1 is_stmt 0 view .LVU186
 866 0000 0620     		movs	r0, #6
 867              	.LVL74:
 868              		.loc 1 725 1 view .LVU187
 869 0002 7047     		bx	lr
 870              		.cfi_endproc
 871              	.LFE109:
 873              		.section	.text.SecureElementSetObjHandler,"ax",%progbits
 874              		.align	1
 875              		.global	SecureElementSetObjHandler
 876              		.syntax unified
 877              		.thumb
 878              		.thumb_func
 880              	SecureElementSetObjHandler:
 881              	.LVL75:
 882              	.LFB110:
 726:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 727:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** SecureElementStatus_t SecureElementSetObjHandler( KeyIdentifier_t keyID, uint32_t keyIndex )
 728:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** {
 883              		.loc 1 728 1 is_stmt 1 view -0
 884              		.cfi_startproc
 885              		@ args = 0, pretend = 0, frame = 0
 886              		@ frame_needed = 0, uses_anonymous_args = 0
 887              		@ link register save eliminated.
 729:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if (!defined (LORAWAN_KMS) || (LORAWAN_KMS == 0))
 730:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     return SECURE_ELEMENT_ERROR;
 888              		.loc 1 730 5 view .LVU189
 731:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #else /* LORAWAN_KMS == 1 */
 732:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     for (uint8_t i = 0; i < NUM_OF_KEYS; i++)
 733:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 734:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         if (SeNvm->KeyList[i].KeyID == keyID)
 735:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 736:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             SeNvm->KeyList[i].Object_Index = (CK_OBJECT_HANDLE) keyIndex;
 737:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             return SECURE_ELEMENT_SUCCESS;
 738:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 739:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 740:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     return SECURE_ELEMENT_ERROR_INVALID_KEY_ID;
 741:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* LORAWAN_KMS */
 742:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** }
 889              		.loc 1 742 1 is_stmt 0 view .LVU190
 890 0000 0620     		movs	r0, #6
 891              	.LVL76:
 892              		.loc 1 742 1 view .LVU191
 893 0002 7047     		bx	lr
 894              		.cfi_endproc
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s 			page 33


 895              	.LFE110:
 897              		.section	.text.SecureElementComputeAesCmac,"ax",%progbits
 898              		.align	1
 899              		.global	SecureElementComputeAesCmac
 900              		.syntax unified
 901              		.thumb
 902              		.thumb_func
 904              	SecureElementComputeAesCmac:
 905              	.LVL77:
 906              	.LFB112:
 743:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** /* ST_WORKAROUND_END */
 744:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 745:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** SecureElementStatus_t SecureElementSetKey( KeyIdentifier_t keyID, uint8_t* key )
 746:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** {
 747:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( key == NULL )
 748:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 749:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return SECURE_ELEMENT_ERROR_NPE;
 750:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 751:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 752:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if (!defined (LORAWAN_KMS) || (LORAWAN_KMS == 0))
 753:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     for( uint8_t i = 0; i < NUM_OF_KEYS; i++ )
 754:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 755:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         if( SeNvm->KeyList[i].KeyID == keyID )
 756:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 757:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             /* ST_WORKAROUND_BEGIN: reduced LORAMAC_MAX_MC_CTX */
 758:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if ( LORAMAC_MAX_MC_CTX == 1 )
 759:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             if ( keyID == MC_KEY_0 )
 760:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #else /* LORAMAC_MAX_MC_CTX > 1 */
 761:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             if( ( keyID == MC_KEY_0 ) || ( keyID == MC_KEY_1 ) || ( keyID == MC_KEY_2 ) || ( keyID 
 762:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* LORAMAC_MAX_MC_CTX */
 763:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             /* ST_WORKAROUND_END */
 764:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             {  // Decrypt the key if its a Mckey
 765:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                 SecureElementStatus_t retval           = SECURE_ELEMENT_ERROR;
 766:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                 uint8_t               decryptedKey[16] = { 0 };
 767:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 768:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                 retval = SecureElementAesEncrypt( key, 16, MC_KE_KEY, decryptedKey );
 769:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 770:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                 memcpy1( SeNvm->KeyList[i].KeyValue, decryptedKey, SE_KEY_SIZE );
 771:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                 return retval;
 772:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             }
 773:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             else
 774:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             {
 775:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                 memcpy1( SeNvm->KeyList[i].KeyValue, key, SE_KEY_SIZE );
 776:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                 return SECURE_ELEMENT_SUCCESS;
 777:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             }
 778:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 779:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 780:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 781:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     return SECURE_ELEMENT_ERROR_INVALID_KEY_ID;
 782:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #else /* LORAWAN_KMS == 1 */
 783:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SecureElementStatus_t retval = SECURE_ELEMENT_ERROR;
 784:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_RV rv;
 785:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_SESSION_HANDLE session;
 786:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_FLAGS session_flags = CKF_SERIAL_SESSION;  /* Read ONLY session */
 787:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_OBJECT_HANDLE key_handle;
 788:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_ULONG template_class = CKO_SECRET_KEY;
 789:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_ULONG template_type = CKK_AES;
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s 			page 34


 790:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if (defined (KEY_EXTRACTABLE) && (KEY_EXTRACTABLE == 1))
 791:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_ULONG template_true = CK_TRUE;
 792:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #else
 793:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_ULONG template_false = CK_TRUE;
 794:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* KEY_EXTRACTABLE */
 795:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     uint32_t key_ui32[] =
 796:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 797:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         key[3]  | (key[2] << 8)  | (key[1] << 16)  | (key[0] << 24),
 798:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         key[7]  | (key[6] << 8)  | (key[5] << 16)  | (key[4] << 24),
 799:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         key[11] | (key[10] << 8) | (key[9] << 16)  | (key[8] << 24),
 800:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         key[15] | (key[14] << 8) | (key[13] << 16) | (key[12] << 24),
 801:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     };
 802:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 803:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     uint32_t specific_label[] = {GlobalTemplateLabel, 0UL};
 804:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_ATTRIBUTE key_attribute_template[] =
 805:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 806:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         { CKA_CLASS, (CK_VOID_PTR) &template_class,    sizeof(CK_BBOOL)      },
 807:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         { CKA_KEY_TYPE, (CK_VOID_PTR) &template_type,     sizeof(CK_BBOOL)      },
 808:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         { CKA_VALUE, (CK_VOID_PTR)key_ui32,           sizeof(key_ui32)      },
 809:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if (defined (KEY_EXTRACTABLE) && (KEY_EXTRACTABLE == 1))
 810:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         { CKA_EXTRACTABLE, (CK_VOID_PTR) &template_true,     sizeof(CK_BBOOL)      },
 811:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #else
 812:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         { CKA_EXTRACTABLE, (CK_VOID_PTR) &template_false,    sizeof(CK_BBOOL)      },
 813:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* KEY_EXTRACTABLE */
 814:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         { CKA_LABEL, (CK_VOID_PTR)specific_label,     sizeof(specific_label)},
 815:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     };
 816:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 817:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* ST_WORKAROUND_BEGIN: reduced LORAMAC_MAX_MC_CTX */
 818:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if ( LORAMAC_MAX_MC_CTX == 1 )
 819:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if ( keyID == MC_KEY_0 )
 820:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #else /* LORAMAC_MAX_MC_CTX > 1 */
 821:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( ( keyID == MC_KEY_0 ) || ( keyID == MC_KEY_1 ) || ( keyID == MC_KEY_2 ) || ( keyID == MC_KE
 822:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* LORAMAC_MAX_MC_CTX */
 823:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* ST_WORKAROUND_END */
 824:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {  // Decrypt the key if its a Mckey
 825:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         uint8_t decryptedKey[16] = { 0 };
 826:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         if (SECURE_ELEMENT_SUCCESS != SecureElementAesEncrypt( key, 16, MC_KE_KEY, decryptedKey ))
 827:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 828:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             return SECURE_ELEMENT_ERROR;
 829:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 830:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 831:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         key_ui32[0] = decryptedKey[3]  | (decryptedKey[2] << 8)  | (decryptedKey[1] << 16)  | (decr
 832:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         key_ui32[1] = decryptedKey[7]  | (decryptedKey[6] << 8)  | (decryptedKey[5] << 16)  | (decr
 833:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         key_ui32[2] = decryptedKey[11] | (decryptedKey[10] << 8) | (decryptedKey[9] << 16)  | (decr
 834:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         key_ui32[3] = decryptedKey[15] | (decryptedKey[14] << 8) | (decryptedKey[13] << 16) | (decr
 835:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 836:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 837:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (SECURE_ELEMENT_SUCCESS != GetKeyIndexByID(keyID, &key_handle))
 838:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 839:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return SECURE_ELEMENT_ERROR;
 840:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 841:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 842:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (SECURE_ELEMENT_SUCCESS != SecureElementDeleteDynamicKeys(keyID, &specific_label[1]))
 843:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 844:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return SECURE_ELEMENT_ERROR;
 845:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 846:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s 			page 35


 847:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Open session with KMS */
 848:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     rv = C_OpenSession(0, session_flags, NULL, 0, &session);
 849:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 850:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Get key to display */
 851:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (rv == CKR_OK)
 852:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 853:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         rv = C_CreateObject(session, key_attribute_template, sizeof(key_attribute_template) / sizeo
 854:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                             &key_handle);
 855:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 856:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 857:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (rv == CKR_OK)
 858:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 859:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         retval = SecureElementSetObjHandler(keyID, key_handle);
 860:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 861:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 862:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     PrintKey(keyID);
 863:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 864:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Close sessions */
 865:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     (void)C_CloseSession(session);
 866:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 867:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (rv != CKR_OK)
 868:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 869:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         retval = SECURE_ELEMENT_ERROR;
 870:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 871:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     return retval;
 872:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* LORAWAN_KMS */
 873:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** }
 874:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 875:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** SecureElementStatus_t SecureElementComputeAesCmac( uint8_t* micBxBuffer, uint8_t* buffer, uint16_t 
 876:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                                                    KeyIdentifier_t keyID, uint32_t* cmac )
 877:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** {
 907              		.loc 1 877 1 is_stmt 1 view -0
 908              		.cfi_startproc
 909              		@ args = 4, pretend = 0, frame = 0
 910              		@ frame_needed = 0, uses_anonymous_args = 0
 878:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( keyID >= LORAMAC_CRYPTO_MULTICAST_KEYS )
 911              		.loc 1 878 5 view .LVU193
 912              		.loc 1 878 7 is_stmt 0 view .LVU194
 913 0000 7E2B     		cmp	r3, #126
 914 0002 0AD8     		bhi	.L69
 877:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( keyID >= LORAMAC_CRYPTO_MULTICAST_KEYS )
 915              		.loc 1 877 1 view .LVU195
 916 0004 00B5     		push	{lr}
 917              	.LCFI20:
 918              		.cfi_def_cfa_offset 4
 919              		.cfi_offset 14, -4
 920 0006 83B0     		sub	sp, sp, #12
 921              	.LCFI21:
 922              		.cfi_def_cfa_offset 16
 879:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 880:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         // Never accept multicast key identifier for cmac computation
 881:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return SECURE_ELEMENT_ERROR_INVALID_KEY_ID;
 882:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 883:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 884:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     return ComputeCmac( micBxBuffer, buffer, size, keyID, cmac );
 923              		.loc 1 884 5 is_stmt 1 view .LVU196
 924              		.loc 1 884 12 is_stmt 0 view .LVU197
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s 			page 36


 925 0008 DDF810C0 		ldr	ip, [sp, #16]
 926 000c CDF800C0 		str	ip, [sp]
 927 0010 FFF7FEFF 		bl	ComputeCmac
 928              	.LVL78:
 885:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** }
 929              		.loc 1 885 1 view .LVU198
 930 0014 03B0     		add	sp, sp, #12
 931              	.LCFI22:
 932              		.cfi_def_cfa_offset 4
 933              		@ sp needed
 934 0016 5DF804FB 		ldr	pc, [sp], #4
 935              	.LVL79:
 936              	.L69:
 937              	.LCFI23:
 938              		.cfi_def_cfa_offset 0
 939              		.cfi_restore 14
 881:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 940              		.loc 1 881 16 view .LVU199
 941 001a 0320     		movs	r0, #3
 942              	.LVL80:
 943              		.loc 1 885 1 view .LVU200
 944 001c 7047     		bx	lr
 945              		.cfi_endproc
 946              	.LFE112:
 948              		.section	.text.SecureElementVerifyAesCmac,"ax",%progbits
 949              		.align	1
 950              		.global	SecureElementVerifyAesCmac
 951              		.syntax unified
 952              		.thumb
 953              		.thumb_func
 955              	SecureElementVerifyAesCmac:
 956              	.LVL81:
 957              	.LFB113:
 886:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 887:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** SecureElementStatus_t SecureElementVerifyAesCmac( uint8_t* buffer, uint16_t size, uint32_t expected
 888:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                                                   KeyIdentifier_t keyID )
 889:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** {
 958              		.loc 1 889 1 is_stmt 1 view -0
 959              		.cfi_startproc
 960              		@ args = 0, pretend = 0, frame = 8
 961              		@ frame_needed = 0, uses_anonymous_args = 0
 890:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( buffer == NULL )
 962              		.loc 1 890 5 view .LVU202
 963              		.loc 1 890 7 is_stmt 0 view .LVU203
 964 0000 90B1     		cbz	r0, .L76
 889:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( buffer == NULL )
 965              		.loc 1 889 1 view .LVU204
 966 0002 10B5     		push	{r4, lr}
 967              	.LCFI24:
 968              		.cfi_def_cfa_offset 8
 969              		.cfi_offset 4, -8
 970              		.cfi_offset 14, -4
 971 0004 84B0     		sub	sp, sp, #16
 972              	.LCFI25:
 973              		.cfi_def_cfa_offset 24
 974 0006 8C46     		mov	ip, r1
 975 0008 1446     		mov	r4, r2
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s 			page 37


 976 000a 0146     		mov	r1, r0
 977              	.LVL82:
 891:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 892:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return SECURE_ELEMENT_ERROR_NPE;
 893:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 894:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 895:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SecureElementStatus_t retval   = SECURE_ELEMENT_ERROR;
 978              		.loc 1 895 5 is_stmt 1 view .LVU205
 896:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if (!defined (LORAWAN_KMS) || (LORAWAN_KMS == 0))
 897:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     uint32_t              compCmac = 0;
 979              		.loc 1 897 5 view .LVU206
 980              		.loc 1 897 27 is_stmt 0 view .LVU207
 981 000c 0020     		movs	r0, #0
 982              	.LVL83:
 983              		.loc 1 897 27 view .LVU208
 984 000e 0390     		str	r0, [sp, #12]
 898:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     retval                         = ComputeCmac( NULL, buffer, size, keyID, &compCmac );
 985              		.loc 1 898 5 is_stmt 1 view .LVU209
 986              		.loc 1 898 38 is_stmt 0 view .LVU210
 987 0010 03AA     		add	r2, sp, #12
 988              	.LVL84:
 989              		.loc 1 898 38 view .LVU211
 990 0012 0092     		str	r2, [sp]
 991 0014 6246     		mov	r2, ip
 992 0016 FFF7FEFF 		bl	ComputeCmac
 993              	.LVL85:
 899:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( retval != SECURE_ELEMENT_SUCCESS )
 994              		.loc 1 899 5 is_stmt 1 view .LVU212
 995              		.loc 1 899 7 is_stmt 0 view .LVU213
 996 001a 18B9     		cbnz	r0, .L75
 900:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 901:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return retval;
 902:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 903:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 904:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( expectedCmac != compCmac )
 997              		.loc 1 904 5 is_stmt 1 view .LVU214
 998              		.loc 1 904 22 is_stmt 0 view .LVU215
 999 001c 039B     		ldr	r3, [sp, #12]
 1000              		.loc 1 904 7 view .LVU216
 1001 001e A342     		cmp	r3, r4
 1002 0020 00D0     		beq	.L75
 905:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 906:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         retval = SECURE_ELEMENT_FAIL_CMAC;
 1003              		.loc 1 906 16 view .LVU217
 1004 0022 0120     		movs	r0, #1
 1005              	.LVL86:
 1006              	.L75:
 907:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 908:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #else /* LORAWAN_KMS == 1 */
 909:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_RV rv;
 910:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_SESSION_HANDLE session;
 911:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_FLAGS session_flags = CKF_SERIAL_SESSION;    /* Read ONLY session */
 912:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_OBJECT_HANDLE object_handle;
 913:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 914:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (buffer == NULL)
 915:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 916:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return SECURE_ELEMENT_ERROR_NPE;
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s 			page 38


 917:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 918:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 919:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* AES CMAC Authentication variables */
 920:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_MECHANISM aes_cmac_mechanism = { CKM_AES_CMAC, (CK_VOID_PTR)NULL, 0 };
 921:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 922:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     retval = GetKeyIndexByID(keyID, &object_handle);
 923:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (retval != SECURE_ELEMENT_SUCCESS)
 924:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 925:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return retval;
 926:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 927:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 928:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Open session with KMS */
 929:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     rv = C_OpenSession(0,    session_flags, NULL, 0, &session);
 930:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 931:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Configure session to Verify the message in AES CMAC with settings included into the mechanis
 932:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (rv == CKR_OK)
 933:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 934:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         rv = C_VerifyInit(session, &aes_cmac_mechanism, object_handle);
 935:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 936:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 937:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Verify the message */
 938:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (rv == CKR_OK)
 939:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 940:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         memcpy1(input_align_combined_buf, buffer, size);
 941:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         rv = C_Verify(session, (CK_BYTE_PTR)input_align_combined_buf, size, (CK_BYTE_PTR)&expectedC
 942:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 943:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 944:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     (void)C_CloseSession(session);
 945:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 946:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (rv != CKR_OK)
 947:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 948:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         retval = SECURE_ELEMENT_ERROR;
 949:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 950:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 951:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* LORAWAN_KMS */
 952:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 953:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     return retval;
 954:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** }
 1007              		.loc 1 954 1 view .LVU218
 1008 0024 04B0     		add	sp, sp, #16
 1009              	.LCFI26:
 1010              		.cfi_def_cfa_offset 8
 1011              		@ sp needed
 1012 0026 10BD     		pop	{r4, pc}
 1013              	.LVL87:
 1014              	.L76:
 1015              	.LCFI27:
 1016              		.cfi_def_cfa_offset 0
 1017              		.cfi_restore 4
 1018              		.cfi_restore 14
 892:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 1019              		.loc 1 892 16 view .LVU219
 1020 0028 0220     		movs	r0, #2
 1021              	.LVL88:
 1022              		.loc 1 954 1 view .LVU220
 1023 002a 7047     		bx	lr
 1024              		.cfi_endproc
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s 			page 39


 1025              	.LFE113:
 1027              		.section	.text.SecureElementAesEncrypt,"ax",%progbits
 1028              		.align	1
 1029              		.global	SecureElementAesEncrypt
 1030              		.syntax unified
 1031              		.thumb
 1032              		.thumb_func
 1034              	SecureElementAesEncrypt:
 1035              	.LVL89:
 1036              	.LFB114:
 955:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 956:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** SecureElementStatus_t SecureElementAesEncrypt( uint8_t* buffer, uint16_t size, KeyIdentifier_t keyI
 957:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                                                uint8_t* encBuffer )
 958:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** {
 1037              		.loc 1 958 1 is_stmt 1 view -0
 1038              		.cfi_startproc
 1039              		@ args = 0, pretend = 0, frame = 248
 1040              		@ frame_needed = 0, uses_anonymous_args = 0
 1041              		.loc 1 958 1 is_stmt 0 view .LVU222
 1042 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 1043              	.LCFI28:
 1044              		.cfi_def_cfa_offset 24
 1045              		.cfi_offset 4, -24
 1046              		.cfi_offset 5, -20
 1047              		.cfi_offset 6, -16
 1048              		.cfi_offset 7, -12
 1049              		.cfi_offset 8, -8
 1050              		.cfi_offset 14, -4
 1051 0004 BEB0     		sub	sp, sp, #248
 1052              	.LCFI29:
 1053              		.cfi_def_cfa_offset 272
 959:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( buffer == NULL || encBuffer == NULL )
 1054              		.loc 1 959 5 is_stmt 1 view .LVU223
 1055              		.loc 1 959 7 is_stmt 0 view .LVU224
 1056 0006 50B3     		cbz	r0, .L86
 1057 0008 0C46     		mov	r4, r1
 1058 000a 1546     		mov	r5, r2
 1059 000c 1E46     		mov	r6, r3
 1060 000e 0746     		mov	r7, r0
 1061              		.loc 1 959 24 discriminator 1 view .LVU225
 1062 0010 43B3     		cbz	r3, .L87
 960:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 961:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return SECURE_ELEMENT_ERROR_NPE;
 962:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 963:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 964:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     // Check if the size is divisible by 16,
 965:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( ( size % 16 ) != 0 )
 1063              		.loc 1 965 5 is_stmt 1 view .LVU226
 1064              		.loc 1 965 7 is_stmt 0 view .LVU227
 1065 0012 11F00F0F 		tst	r1, #15
 1066 0016 28D1     		bne	.L88
 966:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 967:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return SECURE_ELEMENT_ERROR_BUF_SIZE;
 968:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 969:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 970:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if (!defined (LORAWAN_KMS) || (LORAWAN_KMS == 0))
 971:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     lorawan_aes_context aesContext;
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s 			page 40


 1067              		.loc 1 971 5 is_stmt 1 view .LVU228
 972:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     memset1( aesContext.ksch, '\0', 240 );
 1068              		.loc 1 972 5 view .LVU229
 1069 0018 F022     		movs	r2, #240
 1070              	.LVL90:
 1071              		.loc 1 972 5 is_stmt 0 view .LVU230
 1072 001a 0021     		movs	r1, #0
 1073              	.LVL91:
 1074              		.loc 1 972 5 view .LVU231
 1075 001c 01A8     		add	r0, sp, #4
 1076              	.LVL92:
 1077              		.loc 1 972 5 view .LVU232
 1078 001e FFF7FEFF 		bl	memset1
 1079              	.LVL93:
 973:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 974:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     Key_t*                pItem;
 1080              		.loc 1 974 5 is_stmt 1 view .LVU233
 975:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SecureElementStatus_t retval = GetKeyByID( keyID, &pItem );
 1081              		.loc 1 975 5 view .LVU234
 1082              		.loc 1 975 36 is_stmt 0 view .LVU235
 1083 0022 6946     		mov	r1, sp
 1084 0024 2846     		mov	r0, r5
 1085 0026 FFF7FEFF 		bl	GetKeyByID
 1086              	.LVL94:
 976:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 977:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( retval == SECURE_ELEMENT_SUCCESS )
 1087              		.loc 1 977 5 is_stmt 1 view .LVU236
 1088              		.loc 1 977 7 is_stmt 0 view .LVU237
 1089 002a 8046     		mov	r8, r0
 1090 002c 18B1     		cbz	r0, .L90
 1091              	.LVL95:
 1092              	.L83:
 978:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 979:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         lorawan_aes_set_key(pItem->KeyValue, 16, &aesContext);
 980:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 981:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         uint8_t block = 0;
 982:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 983:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         while( size != 0 )
 984:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 985:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             lorawan_aes_encrypt(&buffer[block], &encBuffer[block], &aesContext);
 986:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             block = block + 16;
 987:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             size  = size - 16;
 988:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 989:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 990:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #else /* LORAWAN_KMS == 1 */
 991:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_RV rv;
 992:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_SESSION_HANDLE session;
 993:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_FLAGS session_flags = CKF_SERIAL_SESSION;    /* Read ONLY session */
 994:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     uint32_t encrypted_length = 0;
 995:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_OBJECT_HANDLE object_handle;
 996:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     uint8_t dummy_tag[SE_KEY_SIZE] = {0};
 997:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     uint32_t dummy_tag_lenth = 0;
 998:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 999:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_MECHANISM aes_ecb_mechanism = { CKM_AES_ECB, (CK_VOID_PTR *) NULL, 0 };
1000:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1001:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SecureElementStatus_t retval = GetKeyIndexByID(keyID, &object_handle);
1002:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (retval != SECURE_ELEMENT_SUCCESS)
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s 			page 41


1003:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
1004:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return retval;
1005:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
1006:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1007:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Open session with KMS */
1008:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     rv = C_OpenSession(0,    session_flags, NULL, 0, &session);
1009:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1010:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Configure session to encrypt message in AES ECB with settings included into the mechanism */
1011:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (rv == CKR_OK)
1012:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
1013:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         rv = C_EncryptInit(session, &aes_ecb_mechanism, object_handle);
1014:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
1015:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1016:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Encrypt clear message */
1017:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (rv == CKR_OK)
1018:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
1019:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         memcpy1(input_align_combined_buf, buffer, size);
1020:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         encrypted_length = sizeof(output_align);
1021:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         rv = C_EncryptUpdate(session, (CK_BYTE_PTR)input_align_combined_buf, size,
1022:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                              output_align, (CK_ULONG_PTR)&encrypted_length);
1023:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         memcpy1(encBuffer, output_align, size);
1024:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
1025:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1026:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* In this case C_EncryptFinal is just called to Free the Alloc mem */
1027:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (rv == CKR_OK)
1028:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
1029:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         dummy_tag_lenth = sizeof(tag);
1030:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         rv = C_EncryptFinal(session, &dummy_tag[0], (CK_ULONG_PTR)&dummy_tag_lenth);
1031:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
1032:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1033:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Close session with KMS */
1034:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     (void)C_CloseSession(session);
1035:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1036:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (rv != CKR_OK)
1037:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
1038:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         retval = SECURE_ELEMENT_ERROR;
1039:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
1040:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* LORAWAN_KMS */
1041:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1042:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     return retval;
1043:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** }
 1093              		.loc 1 1043 1 view .LVU238
 1094 002e 4046     		mov	r0, r8
 1095 0030 3EB0     		add	sp, sp, #248
 1096              	.LCFI30:
 1097              		.cfi_remember_state
 1098              		.cfi_def_cfa_offset 24
 1099              		@ sp needed
 1100 0032 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 1101              	.LVL96:
 1102              	.L90:
 1103              	.LCFI31:
 1104              		.cfi_restore_state
 1105              	.LBB8:
 979:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 1106              		.loc 1 979 9 is_stmt 1 view .LVU239
 1107 0036 01AA     		add	r2, sp, #4
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s 			page 42


 1108 0038 1021     		movs	r1, #16
 1109 003a 0098     		ldr	r0, [sp]
 1110              	.LVL97:
 979:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 1111              		.loc 1 979 9 is_stmt 0 view .LVU240
 1112 003c 0130     		adds	r0, r0, #1
 1113 003e FFF7FEFF 		bl	lorawan_aes_set_key
 1114              	.LVL98:
 981:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 1115              		.loc 1 981 9 is_stmt 1 view .LVU241
 983:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 1116              		.loc 1 983 9 view .LVU242
 981:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 1117              		.loc 1 981 17 is_stmt 0 view .LVU243
 1118 0042 4546     		mov	r5, r8
 983:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 1119              		.loc 1 983 14 view .LVU244
 1120 0044 08E0     		b	.L84
 1121              	.LVL99:
 1122              	.L85:
 985:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             block = block + 16;
 1123              		.loc 1 985 13 is_stmt 1 view .LVU245
 1124 0046 01AA     		add	r2, sp, #4
 1125 0048 7119     		adds	r1, r6, r5
 1126 004a 7819     		adds	r0, r7, r5
 1127 004c FFF7FEFF 		bl	lorawan_aes_encrypt
 1128              	.LVL100:
 986:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             size  = size - 16;
 1129              		.loc 1 986 13 view .LVU246
 986:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             size  = size - 16;
 1130              		.loc 1 986 19 is_stmt 0 view .LVU247
 1131 0050 1035     		adds	r5, r5, #16
 1132              	.LVL101:
 986:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             size  = size - 16;
 1133              		.loc 1 986 19 view .LVU248
 1134 0052 EDB2     		uxtb	r5, r5
 1135              	.LVL102:
 987:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 1136              		.loc 1 987 13 is_stmt 1 view .LVU249
 987:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 1137              		.loc 1 987 19 is_stmt 0 view .LVU250
 1138 0054 103C     		subs	r4, r4, #16
 1139              	.LVL103:
 987:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 1140              		.loc 1 987 19 view .LVU251
 1141 0056 A4B2     		uxth	r4, r4
 1142              	.LVL104:
 1143              	.L84:
 983:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 1144              		.loc 1 983 14 is_stmt 1 view .LVU252
 1145 0058 002C     		cmp	r4, #0
 1146 005a F4D1     		bne	.L85
 1147 005c E7E7     		b	.L83
 1148              	.LVL105:
 1149              	.L86:
 983:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 1150              		.loc 1 983 14 is_stmt 0 view .LVU253
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s 			page 43


 1151              	.LBE8:
 961:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 1152              		.loc 1 961 16 view .LVU254
 1153 005e 4FF00208 		mov	r8, #2
 1154 0062 E4E7     		b	.L83
 1155              	.L87:
 961:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 1156              		.loc 1 961 16 view .LVU255
 1157 0064 4FF00208 		mov	r8, #2
 1158 0068 E1E7     		b	.L83
 1159              	.L88:
 967:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 1160              		.loc 1 967 16 view .LVU256
 1161 006a 4FF00508 		mov	r8, #5
 1162 006e DEE7     		b	.L83
 1163              		.cfi_endproc
 1164              	.LFE114:
 1166              		.section	.text.SecureElementSetKey,"ax",%progbits
 1167              		.align	1
 1168              		.global	SecureElementSetKey
 1169              		.syntax unified
 1170              		.thumb
 1171              		.thumb_func
 1173              	SecureElementSetKey:
 1174              	.LVL106:
 1175              	.LFB111:
 746:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( key == NULL )
 1176              		.loc 1 746 1 is_stmt 1 view -0
 1177              		.cfi_startproc
 1178              		@ args = 0, pretend = 0, frame = 16
 1179              		@ frame_needed = 0, uses_anonymous_args = 0
 746:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( key == NULL )
 1180              		.loc 1 746 1 is_stmt 0 view .LVU258
 1181 0000 30B5     		push	{r4, r5, lr}
 1182              	.LCFI32:
 1183              		.cfi_def_cfa_offset 12
 1184              		.cfi_offset 4, -12
 1185              		.cfi_offset 5, -8
 1186              		.cfi_offset 14, -4
 1187 0002 85B0     		sub	sp, sp, #20
 1188              	.LCFI33:
 1189              		.cfi_def_cfa_offset 32
 747:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 1190              		.loc 1 747 5 is_stmt 1 view .LVU259
 747:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 1191              		.loc 1 747 7 is_stmt 0 view .LVU260
 1192 0004 0029     		cmp	r1, #0
 1193 0006 38D0     		beq	.L97
 1194 0008 8C46     		mov	ip, r1
 1195              	.LBB9:
 753:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 1196              		.loc 1 753 18 view .LVU261
 1197 000a 0023     		movs	r3, #0
 1198              	.LVL107:
 1199              	.L93:
 753:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 1200              		.loc 1 753 25 is_stmt 1 discriminator 1 view .LVU262
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s 			page 44


 753:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 1201              		.loc 1 753 5 is_stmt 0 discriminator 1 view .LVU263
 1202 000c 092B     		cmp	r3, #9
 1203 000e 30D8     		bhi	.L99
 755:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 1204              		.loc 1 755 9 is_stmt 1 view .LVU264
 755:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 1205              		.loc 1 755 18 is_stmt 0 view .LVU265
 1206 0010 1B4A     		ldr	r2, .L102
 1207 0012 1168     		ldr	r1, [r2]
 755:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 1208              		.loc 1 755 30 view .LVU266
 1209 0014 1C46     		mov	r4, r3
 1210 0016 03EB0312 		add	r2, r3, r3, lsl #4
 1211 001a 0A44     		add	r2, r2, r1
 1212 001c 127C     		ldrb	r2, [r2, #16]	@ zero_extendqisi2
 755:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
 1213              		.loc 1 755 11 view .LVU267
 1214 001e 8242     		cmp	r2, r0
 1215 0020 02D0     		beq	.L100
 753:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 1216              		.loc 1 753 42 is_stmt 1 discriminator 2 view .LVU268
 753:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 1217              		.loc 1 753 43 is_stmt 0 discriminator 2 view .LVU269
 1218 0022 0133     		adds	r3, r3, #1
 1219              	.LVL108:
 753:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 1220              		.loc 1 753 43 discriminator 2 view .LVU270
 1221 0024 DBB2     		uxtb	r3, r3
 1222              	.LVL109:
 753:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 1223              		.loc 1 753 43 discriminator 2 view .LVU271
 1224 0026 F1E7     		b	.L93
 1225              	.L100:
 759:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #else /* LORAMAC_MAX_MC_CTX > 1 */
 1226              		.loc 1 759 13 is_stmt 1 view .LVU272
 759:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #else /* LORAMAC_MAX_MC_CTX > 1 */
 1227              		.loc 1 759 16 is_stmt 0 view .LVU273
 1228 0028 8028     		cmp	r0, #128
 1229 002a 0AD0     		beq	.L101
 775:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                 return SECURE_ELEMENT_SUCCESS;
 1230              		.loc 1 775 17 is_stmt 1 view .LVU274
 775:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                 return SECURE_ELEMENT_SUCCESS;
 1231              		.loc 1 775 43 is_stmt 0 view .LVU275
 1232 002c 03EB0313 		add	r3, r3, r3, lsl #4
 1233              	.LVL110:
 775:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                 return SECURE_ELEMENT_SUCCESS;
 1234              		.loc 1 775 43 view .LVU276
 1235 0030 1033     		adds	r3, r3, #16
 1236 0032 0B44     		add	r3, r3, r1
 775:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                 return SECURE_ELEMENT_SUCCESS;
 1237              		.loc 1 775 17 view .LVU277
 1238 0034 1022     		movs	r2, #16
 1239 0036 6146     		mov	r1, ip
 1240 0038 581C     		adds	r0, r3, #1
 1241              	.LVL111:
 775:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                 return SECURE_ELEMENT_SUCCESS;
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s 			page 45


 1242              		.loc 1 775 17 view .LVU278
 1243 003a FFF7FEFF 		bl	memcpy1
 1244              	.LVL112:
 776:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             }
 1245              		.loc 1 776 17 is_stmt 1 view .LVU279
 776:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             }
 1246              		.loc 1 776 24 is_stmt 0 view .LVU280
 1247 003e 0025     		movs	r5, #0
 1248 0040 18E0     		b	.L92
 1249              	.LVL113:
 1250              	.L101:
 1251              	.LBB10:
 765:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                 uint8_t               decryptedKey[16] = { 0 };
 1252              		.loc 1 765 17 is_stmt 1 view .LVU281
 766:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 1253              		.loc 1 766 17 view .LVU282
 766:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 1254              		.loc 1 766 39 is_stmt 0 view .LVU283
 1255 0042 0023     		movs	r3, #0
 1256              	.LVL114:
 766:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 1257              		.loc 1 766 39 view .LVU284
 1258 0044 0093     		str	r3, [sp]
 1259 0046 0193     		str	r3, [sp, #4]
 1260 0048 0293     		str	r3, [sp, #8]
 1261 004a 0393     		str	r3, [sp, #12]
 768:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 1262              		.loc 1 768 17 is_stmt 1 view .LVU285
 768:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 1263              		.loc 1 768 26 is_stmt 0 view .LVU286
 1264 004c 6B46     		mov	r3, sp
 1265 004e 7F22     		movs	r2, #127
 1266 0050 1021     		movs	r1, #16
 1267 0052 6046     		mov	r0, ip
 1268              	.LVL115:
 768:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 1269              		.loc 1 768 26 view .LVU287
 1270 0054 FFF7FEFF 		bl	SecureElementAesEncrypt
 1271              	.LVL116:
 768:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 1272              		.loc 1 768 26 view .LVU288
 1273 0058 0546     		mov	r5, r0
 1274              	.LVL117:
 770:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                 return retval;
 1275              		.loc 1 770 17 is_stmt 1 view .LVU289
 770:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                 return retval;
 1276              		.loc 1 770 31 is_stmt 0 view .LVU290
 1277 005a 094B     		ldr	r3, .L102
 1278 005c 1868     		ldr	r0, [r3]
 770:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                 return retval;
 1279              		.loc 1 770 43 view .LVU291
 1280 005e 04EB0414 		add	r4, r4, r4, lsl #4
 1281 0062 1034     		adds	r4, r4, #16
 1282 0064 2044     		add	r0, r0, r4
 770:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                 return retval;
 1283              		.loc 1 770 17 view .LVU292
 1284 0066 1022     		movs	r2, #16
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s 			page 46


 1285 0068 6946     		mov	r1, sp
 1286 006a 0130     		adds	r0, r0, #1
 1287 006c FFF7FEFF 		bl	memcpy1
 1288              	.LVL118:
 771:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             }
 1289              		.loc 1 771 17 is_stmt 1 view .LVU293
 1290 0070 00E0     		b	.L92
 1291              	.LVL119:
 1292              	.L99:
 771:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             }
 1293              		.loc 1 771 17 is_stmt 0 view .LVU294
 1294              	.LBE10:
 1295              	.LBE9:
 781:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #else /* LORAWAN_KMS == 1 */
 1296              		.loc 1 781 12 view .LVU295
 1297 0072 0325     		movs	r5, #3
 1298              	.LVL120:
 1299              	.L92:
 873:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
 1300              		.loc 1 873 1 discriminator 1 view .LVU296
 1301 0074 2846     		mov	r0, r5
 1302 0076 05B0     		add	sp, sp, #20
 1303              	.LCFI34:
 1304              		.cfi_remember_state
 1305              		.cfi_def_cfa_offset 12
 1306              		@ sp needed
 1307 0078 30BD     		pop	{r4, r5, pc}
 1308              	.LVL121:
 1309              	.L97:
 1310              	.LCFI35:
 1311              		.cfi_restore_state
 749:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 1312              		.loc 1 749 16 view .LVU297
 1313 007a 0225     		movs	r5, #2
 1314 007c FAE7     		b	.L92
 1315              	.L103:
 1316 007e 00BF     		.align	2
 1317              	.L102:
 1318 0080 00000000 		.word	.LANCHOR0
 1319              		.cfi_endproc
 1320              	.LFE111:
 1322              		.section	.text.SecureElementDeriveAndStoreKey,"ax",%progbits
 1323              		.align	1
 1324              		.global	SecureElementDeriveAndStoreKey
 1325              		.syntax unified
 1326              		.thumb
 1327              		.thumb_func
 1329              	SecureElementDeriveAndStoreKey:
 1330              	.LVL122:
 1331              	.LFB115:
1044:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1045:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** SecureElementStatus_t SecureElementDeriveAndStoreKey( uint8_t* input, KeyIdentifier_t rootKeyID,
1046:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                                                       KeyIdentifier_t targetKeyID )
1047:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** {
 1332              		.loc 1 1047 1 is_stmt 1 view -0
 1333              		.cfi_startproc
 1334              		@ args = 0, pretend = 0, frame = 16
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s 			page 47


 1335              		@ frame_needed = 0, uses_anonymous_args = 0
1048:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( input == NULL )
 1336              		.loc 1 1048 5 view .LVU299
 1337              		.loc 1 1048 7 is_stmt 0 view .LVU300
 1338 0000 D0B1     		cbz	r0, .L107
1047:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( input == NULL )
 1339              		.loc 1 1047 1 view .LVU301
 1340 0002 10B5     		push	{r4, lr}
 1341              	.LCFI36:
 1342              		.cfi_def_cfa_offset 8
 1343              		.cfi_offset 4, -8
 1344              		.cfi_offset 14, -4
 1345 0004 84B0     		sub	sp, sp, #16
 1346              	.LCFI37:
 1347              		.cfi_def_cfa_offset 24
 1348 0006 1446     		mov	r4, r2
 1349 0008 8446     		mov	ip, r0
1049:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
1050:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return SECURE_ELEMENT_ERROR_NPE;
1051:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
1052:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1053:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     SecureElementStatus_t retval  = SECURE_ELEMENT_ERROR;
 1350              		.loc 1 1053 5 is_stmt 1 view .LVU302
 1351              	.LVL123:
1054:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1055:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     // In case of MC_KE_KEY, only McRootKey can be used as root key
1056:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( targetKeyID == MC_KE_KEY )
 1352              		.loc 1 1056 5 view .LVU303
 1353              		.loc 1 1056 7 is_stmt 0 view .LVU304
 1354 000a 7F2A     		cmp	r2, #127
 1355 000c 01D1     		bne	.L106
1057:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
1058:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         if( rootKeyID != MC_ROOT_KEY )
 1356              		.loc 1 1058 9 is_stmt 1 view .LVU305
 1357              		.loc 1 1058 11 is_stmt 0 view .LVU306
 1358 000e 0429     		cmp	r1, #4
 1359 0010 14D1     		bne	.L108
 1360              	.L106:
1059:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
1060:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             return SECURE_ELEMENT_ERROR_INVALID_KEY_ID;
1061:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
1062:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
1063:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1064:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if (!defined (LORAWAN_KMS) || (LORAWAN_KMS == 0))
1065:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     uint8_t key[16] = { 0 };
 1361              		.loc 1 1065 5 is_stmt 1 view .LVU307
 1362              		.loc 1 1065 13 is_stmt 0 view .LVU308
 1363 0012 0023     		movs	r3, #0
 1364 0014 0093     		str	r3, [sp]
 1365 0016 0193     		str	r3, [sp, #4]
 1366 0018 0293     		str	r3, [sp, #8]
 1367 001a 0393     		str	r3, [sp, #12]
1066:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     // Derive key
1067:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     retval = SecureElementAesEncrypt( input, 16, rootKeyID, key );
 1368              		.loc 1 1067 5 is_stmt 1 view .LVU309
 1369              		.loc 1 1067 14 is_stmt 0 view .LVU310
 1370 001c 6B46     		mov	r3, sp
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s 			page 48


 1371 001e 0A46     		mov	r2, r1
 1372              	.LVL124:
 1373              		.loc 1 1067 14 view .LVU311
 1374 0020 1021     		movs	r1, #16
 1375              	.LVL125:
 1376              		.loc 1 1067 14 view .LVU312
 1377 0022 6046     		mov	r0, ip
 1378              	.LVL126:
 1379              		.loc 1 1067 14 view .LVU313
 1380 0024 FFF7FEFF 		bl	SecureElementAesEncrypt
 1381              	.LVL127:
1068:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( retval != SECURE_ELEMENT_SUCCESS )
 1382              		.loc 1 1068 5 is_stmt 1 view .LVU314
 1383              		.loc 1 1068 7 is_stmt 0 view .LVU315
 1384 0028 08B1     		cbz	r0, .L113
 1385              	.LVL128:
 1386              	.L105:
1069:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
1070:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return retval;
1071:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
1072:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1073:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     // Store key
1074:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     retval = SecureElementSetKey( targetKeyID, key );
1075:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( retval != SECURE_ELEMENT_SUCCESS )
1076:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
1077:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return retval;
1078:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
1079:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1080:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     return SECURE_ELEMENT_SUCCESS;
1081:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #else /* LORAWAN_KMS == 1 */
1082:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_RV rv;
1083:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_SESSION_HANDLE session;
1084:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_FLAGS session_flags = CKF_SERIAL_SESSION;    /* Read ONLY session */
1085:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Key derivation */
1086:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_MECHANISM            mech = {CKM_AES_ECB_ENCRYPT_DATA, input, SE_KEY_SIZE};
1087:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_OBJECT_HANDLE  derived_object_handle;
1088:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_OBJECT_HANDLE    rootkey_object_handle;
1089:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     uint32_t specific_label[] = {GlobalTemplateLabel, 0UL};
1090:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     CK_ATTRIBUTE DeriveKey_template = {CKA_LABEL, (CK_VOID_PTR)specific_label, sizeof(specific_labe
1091:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1092:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Derive key */
1093:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (SECURE_ELEMENT_SUCCESS != GetKeyIndexByID(rootKeyID, &rootkey_object_handle))
1094:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
1095:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return SECURE_ELEMENT_ERROR;
1096:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
1097:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1098:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (SECURE_ELEMENT_SUCCESS != GetKeyIndexByID(targetKeyID, &derived_object_handle))
1099:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
1100:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return SECURE_ELEMENT_ERROR;
1101:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
1102:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1103:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (SECURE_ELEMENT_SUCCESS != SecureElementDeleteDynamicKeys(targetKeyID, &specific_label[1]))
1104:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
1105:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return SECURE_ELEMENT_ERROR;
1106:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
1107:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1108:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Open session with KMS */
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s 			page 49


1109:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     rv = C_OpenSession(0,    session_flags, NULL, 0, &session);
1110:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1111:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Derive key with pass phrase */
1112:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (rv == CKR_OK)
1113:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
1114:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         rv = C_DeriveKey(session, &(mech), rootkey_object_handle,
1115:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                          &DeriveKey_template, sizeof(DeriveKey_template) / sizeof(CK_ATTRIBUTE), &d
1116:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
1117:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1118:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (rv == CKR_OK)
1119:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
1120:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         /* Store Derived Index in table */
1121:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         retval = SecureElementSetObjHandler(targetKeyID, derived_object_handle);
1122:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
1123:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1124:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     PrintKey(targetKeyID);
1125:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1126:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* Close session with KMS */
1127:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     (void)C_CloseSession(session);
1128:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1129:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if (rv != CKR_OK)
1130:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
1131:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         retval = SECURE_ELEMENT_ERROR;
1132:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
1133:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     return retval;
1134:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* LORAWAN_KMS */
1135:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** }
 1387              		.loc 1 1135 1 view .LVU316
 1388 002a 04B0     		add	sp, sp, #16
 1389              	.LCFI38:
 1390              		.cfi_remember_state
 1391              		.cfi_def_cfa_offset 8
 1392              		@ sp needed
 1393 002c 10BD     		pop	{r4, pc}
 1394              	.LVL129:
 1395              	.L113:
 1396              	.LCFI39:
 1397              		.cfi_restore_state
1074:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( retval != SECURE_ELEMENT_SUCCESS )
 1398              		.loc 1 1074 5 is_stmt 1 view .LVU317
1074:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( retval != SECURE_ELEMENT_SUCCESS )
 1399              		.loc 1 1074 14 is_stmt 0 view .LVU318
 1400 002e 6946     		mov	r1, sp
 1401 0030 2046     		mov	r0, r4
 1402              	.LVL130:
1074:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( retval != SECURE_ELEMENT_SUCCESS )
 1403              		.loc 1 1074 14 view .LVU319
 1404 0032 FFF7FEFF 		bl	SecureElementSetKey
 1405              	.LVL131:
1075:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
 1406              		.loc 1 1075 5 is_stmt 1 view .LVU320
 1407 0036 F8E7     		b	.L105
 1408              	.LVL132:
 1409              	.L107:
 1410              	.LCFI40:
 1411              		.cfi_def_cfa_offset 0
 1412              		.cfi_restore 4
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s 			page 50


 1413              		.cfi_restore 14
1050:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 1414              		.loc 1 1050 16 is_stmt 0 view .LVU321
 1415 0038 0220     		movs	r0, #2
 1416              	.LVL133:
 1417              		.loc 1 1135 1 view .LVU322
 1418 003a 7047     		bx	lr
 1419              	.LVL134:
 1420              	.L108:
 1421              	.LCFI41:
 1422              		.cfi_def_cfa_offset 24
 1423              		.cfi_offset 4, -8
 1424              		.cfi_offset 14, -4
1060:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 1425              		.loc 1 1060 20 view .LVU323
 1426 003c 0320     		movs	r0, #3
 1427              	.LVL135:
1060:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
 1428              		.loc 1 1060 20 view .LVU324
 1429 003e F4E7     		b	.L105
 1430              		.cfi_endproc
 1431              	.LFE115:
 1433              		.section	.text.SecureElementProcessJoinAccept,"ax",%progbits
 1434              		.align	1
 1435              		.global	SecureElementProcessJoinAccept
 1436              		.syntax unified
 1437              		.thumb
 1438              		.thumb_func
 1440              	SecureElementProcessJoinAccept:
 1441              	.LVL136:
 1442              	.LFB116:
1136:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1137:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** SecureElementStatus_t SecureElementProcessJoinAccept( JoinReqIdentifier_t joinReqType, uint8_t* joi
1138:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                                                       uint16_t devNonce, uint8_t* encJoinAccept,
1139:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                                                       uint8_t encJoinAcceptSize, uint8_t* decJoinAc
1140:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                                                       uint8_t* versionMinor )
1141:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** {
 1443              		.loc 1 1141 1 is_stmt 1 view -0
 1444              		.cfi_startproc
 1445              		@ args = 12, pretend = 0, frame = 0
 1446              		@ frame_needed = 0, uses_anonymous_args = 0
 1447              		.loc 1 1141 1 is_stmt 0 view .LVU326
 1448 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 1449              	.LCFI42:
 1450              		.cfi_def_cfa_offset 24
 1451              		.cfi_offset 4, -24
 1452              		.cfi_offset 5, -20
 1453              		.cfi_offset 6, -16
 1454              		.cfi_offset 7, -12
 1455              		.cfi_offset 8, -8
 1456              		.cfi_offset 14, -4
 1457 0004 9DF81840 		ldrb	r4, [sp, #24]	@ zero_extendqisi2
 1458 0008 079D     		ldr	r5, [sp, #28]
 1459 000a 089E     		ldr	r6, [sp, #32]
1142:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( ( encJoinAccept == NULL ) || ( decJoinAccept == NULL ) || ( versionMinor == NULL ) )
 1460              		.loc 1 1142 5 is_stmt 1 view .LVU327
 1461              		.loc 1 1142 7 is_stmt 0 view .LVU328
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s 			page 51


 1462 000c 7BB3     		cbz	r3, .L116
 1463 000e 9846     		mov	r8, r3
 1464              		.loc 1 1142 35 discriminator 1 view .LVU329
 1465 0010 7DB3     		cbz	r5, .L117
 1466              		.loc 1 1142 64 discriminator 2 view .LVU330
 1467 0012 86B3     		cbz	r6, .L118
1143:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
1144:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return SECURE_ELEMENT_ERROR_NPE;
1145:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
1146:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1147:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     // Check that frame size isn't bigger than a JoinAccept with CFList size
1148:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( encJoinAcceptSize > LORAMAC_JOIN_ACCEPT_FRAME_MAX_SIZE )
 1468              		.loc 1 1148 5 is_stmt 1 view .LVU331
 1469              		.loc 1 1148 7 is_stmt 0 view .LVU332
 1470 0014 212C     		cmp	r4, #33
 1471 0016 30D8     		bhi	.L119
1149:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
1150:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return SECURE_ELEMENT_ERROR_BUF_SIZE;
1151:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
1152:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1153:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     // Determine decryption key
1154:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     KeyIdentifier_t encKeyID = NWK_KEY;
 1472              		.loc 1 1154 5 is_stmt 1 view .LVU333
 1473              	.LVL137:
1155:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1156:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     /* ST_WORKAROUND_BEGIN: Keep NWK_KEY if 1.1.x keys are not defined */
1157:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if ( USE_LRWAN_1_1_X_CRYPTO == 1 )
1158:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( joinReqType != JOIN_REQ )
1159:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
1160:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         encKeyID = J_S_ENC_KEY;
1161:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
1162:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* USE_LRWAN_1_1_X_CRYPTO == 1 */
1163:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1164:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     memcpy1( decJoinAccept, encJoinAccept, encJoinAcceptSize );
 1474              		.loc 1 1164 5 view .LVU334
 1475 0018 A7B2     		uxth	r7, r4
 1476 001a 3A46     		mov	r2, r7
 1477              	.LVL138:
 1478              		.loc 1 1164 5 is_stmt 0 view .LVU335
 1479 001c 1946     		mov	r1, r3
 1480              	.LVL139:
 1481              		.loc 1 1164 5 view .LVU336
 1482 001e 2846     		mov	r0, r5
 1483              	.LVL140:
 1484              		.loc 1 1164 5 view .LVU337
 1485 0020 FFF7FEFF 		bl	memcpy1
 1486              	.LVL141:
1165:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1166:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     // Decrypt JoinAccept, skip MHDR
1167:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( SecureElementAesEncrypt( encJoinAccept + LORAMAC_MHDR_FIELD_SIZE, encJoinAcceptSize - LORAM
 1487              		.loc 1 1167 5 is_stmt 1 view .LVU338
 1488              		.loc 1 1167 9 is_stmt 0 view .LVU339
 1489 0024 791E     		subs	r1, r7, #1
 1490 0026 6B1C     		adds	r3, r5, #1
 1491 0028 0122     		movs	r2, #1
 1492 002a 89B2     		uxth	r1, r1
 1493 002c 08EB0200 		add	r0, r8, r2
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s 			page 52


 1494 0030 FFF7FEFF 		bl	SecureElementAesEncrypt
 1495              	.LVL142:
 1496              		.loc 1 1167 7 view .LVU340
 1497 0034 20BB     		cbnz	r0, .L120
1168:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                                  encKeyID, decJoinAccept + LORAMAC_MHDR_FIELD_SIZE ) != SECURE_ELEM
1169:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
1170:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return SECURE_ELEMENT_FAIL_ENCRYPT;
1171:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
1172:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1173:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     *versionMinor = ( ( decJoinAccept[11] & 0x80 ) == 0x80 ) ? 1 : 0;
 1498              		.loc 1 1173 5 is_stmt 1 view .LVU341
 1499              		.loc 1 1173 66 is_stmt 0 view .LVU342
 1500 0036 EB7A     		ldrb	r3, [r5, #11]	@ zero_extendqisi2
 1501 0038 DB09     		lsrs	r3, r3, #7
 1502              		.loc 1 1173 19 view .LVU343
 1503 003a 3370     		strb	r3, [r6]
1174:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1175:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     uint32_t mic = 0;
 1504              		.loc 1 1175 5 is_stmt 1 view .LVU344
 1505              	.LVL143:
1176:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1177:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     mic = ( ( uint32_t ) decJoinAccept[encJoinAcceptSize - LORAMAC_MIC_FIELD_SIZE] << 0 );
 1506              		.loc 1 1177 5 view .LVU345
 1507              		.loc 1 1177 39 is_stmt 0 view .LVU346
 1508 003c 2C44     		add	r4, r4, r5
 1509 003e 14F8042C 		ldrb	r2, [r4, #-4]	@ zero_extendqisi2
 1510              	.LVL144:
1178:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     mic |= ( ( uint32_t ) decJoinAccept[encJoinAcceptSize - LORAMAC_MIC_FIELD_SIZE + 1] << 8 );
 1511              		.loc 1 1178 5 is_stmt 1 view .LVU347
 1512              		.loc 1 1178 40 is_stmt 0 view .LVU348
 1513 0042 14F8031C 		ldrb	r1, [r4, #-3]	@ zero_extendqisi2
 1514              		.loc 1 1178 9 view .LVU349
 1515 0046 42EA0122 		orr	r2, r2, r1, lsl #8
 1516              	.LVL145:
1179:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     mic |= ( ( uint32_t ) decJoinAccept[encJoinAcceptSize - LORAMAC_MIC_FIELD_SIZE + 2] << 16 );
 1517              		.loc 1 1179 5 is_stmt 1 view .LVU350
 1518              		.loc 1 1179 40 is_stmt 0 view .LVU351
 1519 004a 14F8021C 		ldrb	r1, [r4, #-2]	@ zero_extendqisi2
 1520              		.loc 1 1179 9 view .LVU352
 1521 004e 42EA0142 		orr	r2, r2, r1, lsl #16
 1522              	.LVL146:
1180:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     mic |= ( ( uint32_t ) decJoinAccept[encJoinAcceptSize - LORAMAC_MIC_FIELD_SIZE + 3] << 24 );
 1523              		.loc 1 1180 5 is_stmt 1 view .LVU353
 1524              		.loc 1 1180 40 is_stmt 0 view .LVU354
 1525 0052 14F8011C 		ldrb	r1, [r4, #-1]	@ zero_extendqisi2
 1526              		.loc 1 1180 9 view .LVU355
 1527 0056 42EA0162 		orr	r2, r2, r1, lsl #24
 1528              	.LVL147:
1181:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1182:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     //  - Header buffer to be used for MIC computation
1183:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     //        - LoRaWAN 1.0.x : micHeader = [MHDR(1)]
1184:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     //        - LoRaWAN 1.1.x : micHeader = [JoinReqType(1), JoinEUI(8), DevNonce(2), MHDR(1)]
1185:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1186:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     // Verify mic
1187:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( *versionMinor == 0 )
 1529              		.loc 1 1187 5 is_stmt 1 view .LVU356
 1530              		.loc 1 1187 7 is_stmt 0 view .LVU357
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s 			page 53


 1531 005a 9BB9     		cbnz	r3, .L121
1188:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
1189:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         // For LoRaWAN 1.0.x
1190:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         //   cmac = aes128_cmac(NwkKey, MHDR |  JoinNonce | NetID | DevAddr | DLSettings | RxDelay 
1191:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         //   CFListType)
1192:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         if( SecureElementVerifyAesCmac( decJoinAccept, ( encJoinAcceptSize - LORAMAC_MIC_FIELD_SIZE
 1532              		.loc 1 1192 9 is_stmt 1 view .LVU358
 1533              		.loc 1 1192 13 is_stmt 0 view .LVU359
 1534 005c 391F     		subs	r1, r7, #4
 1535 005e 0123     		movs	r3, #1
 1536 0060 89B2     		uxth	r1, r1
 1537 0062 2846     		mov	r0, r5
 1538 0064 FFF7FEFF 		bl	SecureElementVerifyAesCmac
 1539              	.LVL148:
 1540              		.loc 1 1192 11 view .LVU360
 1541 0068 40B1     		cbz	r0, .L115
1193:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             SECURE_ELEMENT_SUCCESS )
1194:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
1195:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             return SECURE_ELEMENT_FAIL_CMAC;
 1542              		.loc 1 1195 20 view .LVU361
 1543 006a 0120     		movs	r0, #1
 1544 006c 06E0     		b	.L115
 1545              	.LVL149:
 1546              	.L116:
1144:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 1547              		.loc 1 1144 16 view .LVU362
 1548 006e 0220     		movs	r0, #2
 1549              	.LVL150:
1144:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 1550              		.loc 1 1144 16 view .LVU363
 1551 0070 04E0     		b	.L115
 1552              	.LVL151:
 1553              	.L117:
1144:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 1554              		.loc 1 1144 16 view .LVU364
 1555 0072 0220     		movs	r0, #2
 1556              	.LVL152:
1144:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 1557              		.loc 1 1144 16 view .LVU365
 1558 0074 02E0     		b	.L115
 1559              	.LVL153:
 1560              	.L118:
1144:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 1561              		.loc 1 1144 16 view .LVU366
 1562 0076 0220     		movs	r0, #2
 1563              	.LVL154:
1144:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 1564              		.loc 1 1144 16 view .LVU367
 1565 0078 00E0     		b	.L115
 1566              	.LVL155:
 1567              	.L119:
1150:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 1568              		.loc 1 1150 16 view .LVU368
 1569 007a 0520     		movs	r0, #5
 1570              	.LVL156:
 1571              	.L115:
1196:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s 			page 54


1197:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
1198:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #if( USE_LRWAN_1_1_X_CRYPTO == 1 )
1199:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     else if( *versionMinor == 1 )
1200:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
1201:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         uint8_t  micHeader11[JOIN_ACCEPT_MIC_COMPUTATION_OFFSET] = { 0 };
1202:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         uint16_t bufItr                                          = 0;
1203:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1204:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         micHeader11[bufItr++] = ( uint8_t ) joinReqType;
1205:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1206:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         memcpyr( micHeader11 + bufItr, joinEui, LORAMAC_JOIN_EUI_FIELD_SIZE );
1207:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         bufItr += LORAMAC_JOIN_EUI_FIELD_SIZE;
1208:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1209:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         micHeader11[bufItr++] = devNonce & 0xFF;
1210:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         micHeader11[bufItr++] = ( devNonce >> 8 ) & 0xFF;
1211:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1212:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         // For LoRaWAN 1.1.x and later:
1213:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         //   cmac = aes128_cmac(JSIntKey, JoinReqType | JoinEUI | DevNonce | MHDR | JoinNonce | Net
1214:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         //   DLSettings | RxDelay | CFList | CFListType)
1215:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         // Prepare the msg for integrity check (adding JoinReqType, JoinEUI and DevNonce)
1216:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         uint8_t localBuffer[LORAMAC_JOIN_ACCEPT_FRAME_MAX_SIZE + JOIN_ACCEPT_MIC_COMPUTATION_OFFSET
1217:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1218:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         memcpy1( localBuffer, micHeader11, JOIN_ACCEPT_MIC_COMPUTATION_OFFSET );
1219:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         memcpy1( localBuffer + JOIN_ACCEPT_MIC_COMPUTATION_OFFSET - 1, decJoinAccept, encJoinAccept
1220:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1221:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         if( SecureElementVerifyAesCmac( localBuffer,
1222:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                                         encJoinAcceptSize + JOIN_ACCEPT_MIC_COMPUTATION_OFFSET -
1223:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                                             LORAMAC_MHDR_FIELD_SIZE - LORAMAC_MIC_FIELD_SIZE,
1224:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****                                         mic, J_S_INT_KEY ) != SECURE_ELEMENT_SUCCESS )
1225:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         {
1226:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****             return SECURE_ELEMENT_FAIL_CMAC;
1227:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         }
1228:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
1229:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** #endif /* USE_LRWAN_1_1_X_CRYPTO == 1 */
1230:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     else
1231:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
1232:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return SECURE_ELEMENT_ERROR_INVALID_LORAWAM_SPEC_VERSION;
1233:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
1234:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1235:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     return SECURE_ELEMENT_SUCCESS;
1236:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** }
 1572              		.loc 1 1236 1 view .LVU369
 1573 007c BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 1574              	.LVL157:
 1575              	.L120:
1170:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 1576              		.loc 1 1170 16 view .LVU370
 1577 0080 0720     		movs	r0, #7
 1578 0082 FBE7     		b	.L115
 1579              	.LVL158:
 1580              	.L121:
1232:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 1581              		.loc 1 1232 16 view .LVU371
 1582 0084 0420     		movs	r0, #4
 1583 0086 F9E7     		b	.L115
 1584              		.cfi_endproc
 1585              	.LFE116:
 1587              		.section	.text.SecureElementRandomNumber,"ax",%progbits
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s 			page 55


 1588              		.align	1
 1589              		.global	SecureElementRandomNumber
 1590              		.syntax unified
 1591              		.thumb
 1592              		.thumb_func
 1594              	SecureElementRandomNumber:
 1595              	.LVL159:
 1596              	.LFB117:
1237:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1238:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** SecureElementStatus_t SecureElementRandomNumber( uint32_t* randomNum )
1239:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** {
 1597              		.loc 1 1239 1 is_stmt 1 view -0
 1598              		.cfi_startproc
 1599              		@ args = 0, pretend = 0, frame = 0
 1600              		@ frame_needed = 0, uses_anonymous_args = 0
1240:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( randomNum == NULL )
 1601              		.loc 1 1240 5 view .LVU373
 1602              		.loc 1 1240 7 is_stmt 0 view .LVU374
 1603 0000 38B1     		cbz	r0, .L126
1239:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( randomNum == NULL )
 1604              		.loc 1 1239 1 view .LVU375
 1605 0002 10B5     		push	{r4, lr}
 1606              	.LCFI43:
 1607              		.cfi_def_cfa_offset 8
 1608              		.cfi_offset 4, -8
 1609              		.cfi_offset 14, -4
 1610 0004 0446     		mov	r4, r0
1241:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
1242:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return SECURE_ELEMENT_ERROR_NPE;
1243:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
1244:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     *randomNum = Radio.Random();
 1611              		.loc 1 1244 5 is_stmt 1 view .LVU376
 1612              		.loc 1 1244 23 is_stmt 0 view .LVU377
 1613 0006 044B     		ldr	r3, .L131
 1614 0008 5B69     		ldr	r3, [r3, #20]
 1615              		.loc 1 1244 18 view .LVU378
 1616 000a 9847     		blx	r3
 1617              	.LVL160:
 1618              		.loc 1 1244 16 view .LVU379
 1619 000c 2060     		str	r0, [r4]
1245:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     return SECURE_ELEMENT_SUCCESS;
 1620              		.loc 1 1245 5 is_stmt 1 view .LVU380
 1621              		.loc 1 1245 12 is_stmt 0 view .LVU381
 1622 000e 0020     		movs	r0, #0
1246:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** }
 1623              		.loc 1 1246 1 view .LVU382
 1624 0010 10BD     		pop	{r4, pc}
 1625              	.LVL161:
 1626              	.L126:
 1627              	.LCFI44:
 1628              		.cfi_def_cfa_offset 0
 1629              		.cfi_restore 4
 1630              		.cfi_restore 14
1242:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 1631              		.loc 1 1242 16 view .LVU383
 1632 0012 0220     		movs	r0, #2
 1633              	.LVL162:
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s 			page 56


 1634              		.loc 1 1246 1 view .LVU384
 1635 0014 7047     		bx	lr
 1636              	.L132:
 1637 0016 00BF     		.align	2
 1638              	.L131:
 1639 0018 00000000 		.word	Radio
 1640              		.cfi_endproc
 1641              	.LFE117:
 1643              		.section	.text.SecureElementSetDevEui,"ax",%progbits
 1644              		.align	1
 1645              		.global	SecureElementSetDevEui
 1646              		.syntax unified
 1647              		.thumb
 1648              		.thumb_func
 1650              	SecureElementSetDevEui:
 1651              	.LVL163:
 1652              	.LFB118:
1247:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1248:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** SecureElementStatus_t SecureElementSetDevEui( uint8_t* devEui )
1249:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** {
 1653              		.loc 1 1249 1 is_stmt 1 view -0
 1654              		.cfi_startproc
 1655              		@ args = 0, pretend = 0, frame = 0
 1656              		@ frame_needed = 0, uses_anonymous_args = 0
1250:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( devEui == NULL )
 1657              		.loc 1 1250 5 view .LVU386
 1658              		.loc 1 1250 7 is_stmt 0 view .LVU387
 1659 0000 40B1     		cbz	r0, .L135
1249:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( devEui == NULL )
 1660              		.loc 1 1249 1 view .LVU388
 1661 0002 08B5     		push	{r3, lr}
 1662              	.LCFI45:
 1663              		.cfi_def_cfa_offset 8
 1664              		.cfi_offset 3, -8
 1665              		.cfi_offset 14, -4
 1666 0004 0146     		mov	r1, r0
1251:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
1252:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return SECURE_ELEMENT_ERROR_NPE;
1253:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
1254:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     memcpy1( SeNvm->DevEui, devEui, SE_EUI_SIZE );
 1667              		.loc 1 1254 5 is_stmt 1 view .LVU389
 1668 0006 0822     		movs	r2, #8
 1669 0008 034B     		ldr	r3, .L140
 1670 000a 1868     		ldr	r0, [r3]
 1671              	.LVL164:
 1672              		.loc 1 1254 5 is_stmt 0 view .LVU390
 1673 000c FFF7FEFF 		bl	memcpy1
 1674              	.LVL165:
1255:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     return SECURE_ELEMENT_SUCCESS;
 1675              		.loc 1 1255 5 is_stmt 1 view .LVU391
 1676              		.loc 1 1255 12 is_stmt 0 view .LVU392
 1677 0010 0020     		movs	r0, #0
1256:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** }
 1678              		.loc 1 1256 1 view .LVU393
 1679 0012 08BD     		pop	{r3, pc}
 1680              	.LVL166:
 1681              	.L135:
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s 			page 57


 1682              	.LCFI46:
 1683              		.cfi_def_cfa_offset 0
 1684              		.cfi_restore 3
 1685              		.cfi_restore 14
1252:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 1686              		.loc 1 1252 16 view .LVU394
 1687 0014 0220     		movs	r0, #2
 1688              	.LVL167:
 1689              		.loc 1 1256 1 view .LVU395
 1690 0016 7047     		bx	lr
 1691              	.L141:
 1692              		.align	2
 1693              	.L140:
 1694 0018 00000000 		.word	.LANCHOR0
 1695              		.cfi_endproc
 1696              	.LFE118:
 1698              		.section	.text.SecureElementGetDevEui,"ax",%progbits
 1699              		.align	1
 1700              		.global	SecureElementGetDevEui
 1701              		.syntax unified
 1702              		.thumb
 1703              		.thumb_func
 1705              	SecureElementGetDevEui:
 1706              	.LFB119:
1257:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1258:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** uint8_t* SecureElementGetDevEui( void )
1259:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** {
 1707              		.loc 1 1259 1 is_stmt 1 view -0
 1708              		.cfi_startproc
 1709              		@ args = 0, pretend = 0, frame = 0
 1710              		@ frame_needed = 0, uses_anonymous_args = 0
 1711              		@ link register save eliminated.
1260:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     return SeNvm->DevEui;
 1712              		.loc 1 1260 5 view .LVU397
1261:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** }
 1713              		.loc 1 1261 1 is_stmt 0 view .LVU398
 1714 0000 014B     		ldr	r3, .L143
 1715 0002 1868     		ldr	r0, [r3]
 1716 0004 7047     		bx	lr
 1717              	.L144:
 1718 0006 00BF     		.align	2
 1719              	.L143:
 1720 0008 00000000 		.word	.LANCHOR0
 1721              		.cfi_endproc
 1722              	.LFE119:
 1724              		.section	.text.SecureElementSetJoinEui,"ax",%progbits
 1725              		.align	1
 1726              		.global	SecureElementSetJoinEui
 1727              		.syntax unified
 1728              		.thumb
 1729              		.thumb_func
 1731              	SecureElementSetJoinEui:
 1732              	.LVL168:
 1733              	.LFB120:
1262:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1263:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** SecureElementStatus_t SecureElementSetJoinEui( uint8_t* joinEui )
1264:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** {
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s 			page 58


 1734              		.loc 1 1264 1 is_stmt 1 view -0
 1735              		.cfi_startproc
 1736              		@ args = 0, pretend = 0, frame = 0
 1737              		@ frame_needed = 0, uses_anonymous_args = 0
1265:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( joinEui == NULL )
 1738              		.loc 1 1265 5 view .LVU400
 1739              		.loc 1 1265 7 is_stmt 0 view .LVU401
 1740 0000 48B1     		cbz	r0, .L147
1264:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     if( joinEui == NULL )
 1741              		.loc 1 1264 1 view .LVU402
 1742 0002 08B5     		push	{r3, lr}
 1743              	.LCFI47:
 1744              		.cfi_def_cfa_offset 8
 1745              		.cfi_offset 3, -8
 1746              		.cfi_offset 14, -4
 1747 0004 0146     		mov	r1, r0
1266:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     {
1267:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****         return SECURE_ELEMENT_ERROR_NPE;
1268:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
1269:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     memcpy1( SeNvm->JoinEui, joinEui, SE_EUI_SIZE );
 1748              		.loc 1 1269 5 is_stmt 1 view .LVU403
 1749              		.loc 1 1269 19 is_stmt 0 view .LVU404
 1750 0006 054B     		ldr	r3, .L152
 1751 0008 1868     		ldr	r0, [r3]
 1752              	.LVL169:
 1753              		.loc 1 1269 5 view .LVU405
 1754 000a 0822     		movs	r2, #8
 1755 000c 1044     		add	r0, r0, r2
 1756 000e FFF7FEFF 		bl	memcpy1
 1757              	.LVL170:
1270:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     return SECURE_ELEMENT_SUCCESS;
 1758              		.loc 1 1270 5 is_stmt 1 view .LVU406
 1759              		.loc 1 1270 12 is_stmt 0 view .LVU407
 1760 0012 0020     		movs	r0, #0
1271:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** }
 1761              		.loc 1 1271 1 view .LVU408
 1762 0014 08BD     		pop	{r3, pc}
 1763              	.LVL171:
 1764              	.L147:
 1765              	.LCFI48:
 1766              		.cfi_def_cfa_offset 0
 1767              		.cfi_restore 3
 1768              		.cfi_restore 14
1267:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     }
 1769              		.loc 1 1267 16 view .LVU409
 1770 0016 0220     		movs	r0, #2
 1771              	.LVL172:
 1772              		.loc 1 1271 1 view .LVU410
 1773 0018 7047     		bx	lr
 1774              	.L153:
 1775 001a 00BF     		.align	2
 1776              	.L152:
 1777 001c 00000000 		.word	.LANCHOR0
 1778              		.cfi_endproc
 1779              	.LFE120:
 1781              		.section	.text.SecureElementGetJoinEui,"ax",%progbits
 1782              		.align	1
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s 			page 59


 1783              		.global	SecureElementGetJoinEui
 1784              		.syntax unified
 1785              		.thumb
 1786              		.thumb_func
 1788              	SecureElementGetJoinEui:
 1789              	.LFB121:
1272:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** 
1273:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** uint8_t* SecureElementGetJoinEui( void )
1274:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** {
 1790              		.loc 1 1274 1 is_stmt 1 view -0
 1791              		.cfi_startproc
 1792              		@ args = 0, pretend = 0, frame = 0
 1793              		@ frame_needed = 0, uses_anonymous_args = 0
 1794              		@ link register save eliminated.
1275:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c ****     return SeNvm->JoinEui;
 1795              		.loc 1 1275 5 view .LVU412
 1796              		.loc 1 1275 17 is_stmt 0 view .LVU413
 1797 0000 014B     		ldr	r3, .L155
 1798 0002 1868     		ldr	r0, [r3]
1276:Middlewares/Third_Party/LoRaWAN/Crypto/soft-se.c **** }
 1799              		.loc 1 1276 1 view .LVU414
 1800 0004 0830     		adds	r0, r0, #8
 1801 0006 7047     		bx	lr
 1802              	.L156:
 1803              		.align	2
 1804              	.L155:
 1805 0008 00000000 		.word	.LANCHOR0
 1806              		.cfi_endproc
 1807              	.LFE121:
 1809              		.section	.rodata
 1810              		.align	2
 1811              		.set	.LANCHOR1,. + 0
 1812              	.LC10:
 1813 0000 0080E101 		.ascii	"\000\200\341\001\001\001\001\001"
 1813      01010101 
 1814              		.section	.bss.SeNvm,"aw",%nobits
 1815              		.align	2
 1816              		.set	.LANCHOR0,. + 0
 1819              	SeNvm:
 1820 0000 00000000 		.space	4
 1821              		.text
 1822              	.Letext0:
 1823              		.file 2 "c:\\program files (x86)\\gnu arm embedded toolchain\\10 2021.10\\arm-none-eabi\\include\\
 1824              		.file 3 "c:\\program files (x86)\\gnu arm embedded toolchain\\10 2021.10\\arm-none-eabi\\include\\
 1825              		.file 4 "Middlewares/Third_Party/SubGHz_Phy/radio.h"
 1826              		.file 5 "Middlewares/Third_Party/SubGHz_Phy/radio_ex.h"
 1827              		.file 6 "Middlewares/Third_Party/LoRaWAN/Crypto/lorawan_aes.h"
 1828              		.file 7 "Middlewares/Third_Party/LoRaWAN/Crypto/cmac.h"
 1829              		.file 8 "Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacTypes.h"
 1830              		.file 9 "Middlewares/Third_Party/LoRaWAN/Mac/secure-element-nvm.h"
 1831              		.file 10 "Middlewares/Third_Party/LoRaWAN/Mac/secure-element.h"
 1832              		.file 11 "Middlewares/Third_Party/LoRaWAN/Utilities/utilities.h"
 1833              		.file 12 "Utilities/trace/adv_trace/stm32_adv_trace.h"
 1834              		.file 13 "<built-in>"
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s 			page 60


DEFINED SYMBOLS
                            *ABS*:00000000 soft-se.c
C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s:18     .text.GetKeyByID:00000000 $t
C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s:23     .text.GetKeyByID:00000000 GetKeyByID
C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s:117    .text.GetKeyByID:0000003c $d
C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s:122    .text.ComputeCmac:00000000 $t
C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s:127    .text.ComputeCmac:00000000 ComputeCmac
C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s:254    .text.SecureElementGetKeyByID:00000000 $t
C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s:260    .text.SecureElementGetKeyByID:00000000 SecureElementGetKeyByID
C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s:353    .text.SecureElementGetKeyByID:0000003c $d
C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s:358    .rodata.PrintKey.str1.4:00000000 $d
C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s:390    .text.PrintKey:00000000 $t
C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s:395    .text.PrintKey:00000000 PrintKey
C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s:649    .text.PrintKey:00000124 $d
C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s:663    .rodata.SecureElementInit.str1.4:00000000 $d
C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s:676    .text.SecureElementInit:00000000 $t
C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s:682    .text.SecureElementInit:00000000 SecureElementInit
C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s:840    .text.SecureElementInit:00000108 $d
C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s:850    .text.SecureElementDeleteDynamicKeys:00000000 $t
C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s:856    .text.SecureElementDeleteDynamicKeys:00000000 SecureElementDeleteDynamicKeys
C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s:874    .text.SecureElementSetObjHandler:00000000 $t
C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s:880    .text.SecureElementSetObjHandler:00000000 SecureElementSetObjHandler
C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s:898    .text.SecureElementComputeAesCmac:00000000 $t
C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s:904    .text.SecureElementComputeAesCmac:00000000 SecureElementComputeAesCmac
C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s:949    .text.SecureElementVerifyAesCmac:00000000 $t
C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s:955    .text.SecureElementVerifyAesCmac:00000000 SecureElementVerifyAesCmac
C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s:1028   .text.SecureElementAesEncrypt:00000000 $t
C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s:1034   .text.SecureElementAesEncrypt:00000000 SecureElementAesEncrypt
C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s:1167   .text.SecureElementSetKey:00000000 $t
C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s:1173   .text.SecureElementSetKey:00000000 SecureElementSetKey
C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s:1318   .text.SecureElementSetKey:00000080 $d
C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s:1323   .text.SecureElementDeriveAndStoreKey:00000000 $t
C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s:1329   .text.SecureElementDeriveAndStoreKey:00000000 SecureElementDeriveAndStoreKey
C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s:1434   .text.SecureElementProcessJoinAccept:00000000 $t
C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s:1440   .text.SecureElementProcessJoinAccept:00000000 SecureElementProcessJoinAccept
C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s:1588   .text.SecureElementRandomNumber:00000000 $t
C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s:1594   .text.SecureElementRandomNumber:00000000 SecureElementRandomNumber
C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s:1639   .text.SecureElementRandomNumber:00000018 $d
C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s:1644   .text.SecureElementSetDevEui:00000000 $t
C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s:1650   .text.SecureElementSetDevEui:00000000 SecureElementSetDevEui
C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s:1694   .text.SecureElementSetDevEui:00000018 $d
C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s:1699   .text.SecureElementGetDevEui:00000000 $t
C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s:1705   .text.SecureElementGetDevEui:00000000 SecureElementGetDevEui
C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s:1720   .text.SecureElementGetDevEui:00000008 $d
C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s:1725   .text.SecureElementSetJoinEui:00000000 $t
C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s:1731   .text.SecureElementSetJoinEui:00000000 SecureElementSetJoinEui
C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s:1777   .text.SecureElementSetJoinEui:0000001c $d
C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s:1782   .text.SecureElementGetJoinEui:00000000 $t
C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s:1788   .text.SecureElementGetJoinEui:00000000 SecureElementGetJoinEui
C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s:1805   .text.SecureElementGetJoinEui:00000008 $d
C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s:1810   .rodata:00000000 $d
C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s:1815   .bss.SeNvm:00000000 $d
C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s:1819   .bss.SeNvm:00000000 SeNvm

UNDEFINED SYMBOLS
AES_CMAC_Init
AES_CMAC_SetKey
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\ccSDGrTZ.s 			page 61


AES_CMAC_Update
AES_CMAC_Final
UTIL_ADV_TRACE_COND_FSend
memset
memcpy1
memset1
lorawan_aes_set_key
lorawan_aes_encrypt
Radio
