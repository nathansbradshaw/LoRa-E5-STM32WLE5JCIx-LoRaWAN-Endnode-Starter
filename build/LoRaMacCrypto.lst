ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 1


   1              		.cpu cortex-m4
   2              		.arch armv7e-m
   3              		.fpu softvfp
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 1
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"LoRaMacCrypto.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.section	.text.PrepareB0,"ax",%progbits
  18              		.align	1
  19              		.syntax unified
  20              		.thumb
  21              		.thumb_func
  23              	PrepareB0:
  24              	.LVL0:
  25              	.LFB105:
  26              		.file 1 "Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c"
   1:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /*!
   2:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \file      LoRaMacCrypto.c
   3:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *
   4:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \brief     LoRa MAC layer cryptography implementation
   5:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *
   6:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \copyright Revised BSD License, see section \ref LICENSE.
   7:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *
   8:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \code
   9:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *                ______                              _
  10:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *               / _____)             _              | |
  11:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *              ( (____  _____ ____ _| |_ _____  ____| |__
  12:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *               \____ \| ___ |    (_   _) ___ |/ ___)  _ \
  13:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *               _____) ) ____| | | || |_| ____( (___| | | |
  14:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *              (______/|_____)_|_|_| \__)_____)\____)_| |_|
  15:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *              (C)2013-2017 Semtech
  16:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *
  17:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *               ___ _____ _   ___ _  _____ ___  ___  ___ ___
  18:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *              / __|_   _/_\ / __| |/ / __/ _ \| _ \/ __| __|
  19:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *              \__ \ | |/ _ \ (__| ' <| _| (_) |   / (__| _|
  20:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *              |___/ |_/_/ \_\___|_|\_\_| \___/|_|_\\___|___|
  21:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *              embedded.connectivity.solutions===============
  22:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *
  23:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \endcode
  24:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *
  25:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \author    Miguel Luis ( Semtech )
  26:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *
  27:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \author    Gregory Cristian ( Semtech )
  28:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *
  29:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \author    Daniel Jaeckle ( STACKFORCE )
  30:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *
  31:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \author    Johannes Bruder ( STACKFORCE )
  32:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  */
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 2


  33:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /**
  34:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****   ******************************************************************************
  35:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****   *
  36:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****   *          Portions COPYRIGHT 2020 STMicroelectronics
  37:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****   *
  38:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****   * @file    LoRaMacCrypto.c
  39:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****   * @author  MCD Application Team
  40:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****   * @brief   LoRa MAC layer cryptography implementation
  41:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****   ******************************************************************************
  42:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****   */
  43:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #include <stdbool.h>
  44:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #include <stdlib.h>
  45:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #include <stdint.h>
  46:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
  47:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #include "utilities.h"
  48:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #include "secure-element.h"
  49:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
  50:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #include "LoRaMacParser.h"
  51:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #include "LoRaMacSerializer.h"
  52:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #include "LoRaMacCrypto.h"
  53:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
  54:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /*
  55:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * Frame direction definition for uplink communications
  56:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  */
  57:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #define UPLINK                          0
  58:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
  59:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /*
  60:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * Frame direction definition for downlink communications
  61:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  */
  62:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #define DOWNLINK                        1
  63:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
  64:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /*
  65:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * CMAC/AES Message Integrity Code (MIC) Block B0 size
  66:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  */
  67:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #define MIC_BLOCK_BX_SIZE               16
  68:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
  69:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /* ST_WORKAROUND_BEGIN: reduced LORAMAC_MAX_MC_CTX */
  70:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /*
  71:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * Number of security context entries
  72:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  */
  73:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #define NUM_OF_SEC_CTX                  LORAMAC_MAX_MC_CTX + 1
  74:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /* ST_WORKAROUND_END */
  75:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
  76:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /*
  77:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * Maximum size of the message that can be handled by the crypto operations
  78:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  */
  79:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #define CRYPTO_MAXMESSAGE_SIZE          256
  80:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
  81:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /*
  82:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * Maximum size of the buffer for crypto operations
  83:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  */
  84:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #define CRYPTO_BUFFER_SIZE              CRYPTO_MAXMESSAGE_SIZE + MIC_BLOCK_BX_SIZE
  85:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
  86:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /*
  87:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * Key-Address item
  88:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  */
  89:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** typedef struct sKeyAddr
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 3


  90:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
  91:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     /*
  92:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****      * Address identifier
  93:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****      */
  94:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     AddressIdentifier_t AddrID;
  95:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     /*
  96:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****      * Application session key
  97:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****      */
  98:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     KeyIdentifier_t AppSkey;
  99:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     /*
 100:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****      * Network session key
 101:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****      */
 102:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     KeyIdentifier_t NwkSkey;
 103:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     /*
 104:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****      * Rootkey (Multicast only)
 105:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****      */
 106:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     KeyIdentifier_t RootKey;
 107:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }KeyAddr_t;
 108:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 109:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if( USE_LRWAN_1_1_X_CRYPTO == 1 )
 110:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /*
 111:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * RJcount0 is a counter incremented with every Type 0 or 2 Rejoin frame transmitted.
 112:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  */
 113:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** static uint16_t RJcount0;
 114:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* USE_LRWAN_1_1_X_CRYPTO == 1 */
 115:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 116:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /*
 117:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * Non volatile module context.
 118:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  */
 119:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** static LoRaMacCryptoNvmData_t* CryptoNvm;
 120:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 121:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /*
 122:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * Key-Address list
 123:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  */
 124:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** static KeyAddr_t KeyAddrList[NUM_OF_SEC_CTX] =
 125:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 126:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /* ST_WORKAROUND_BEGIN: reduced LORAMAC_MAX_MC_CTX */
 127:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if ( LORAMAC_MAX_MC_CTX > 0 )
 128:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         { MULTICAST_0_ADDR, MC_APP_S_KEY_0, MC_NWK_S_KEY_0, MC_KEY_0 },
 129:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* LORAMAC_MAX_MC_CTX > 0 */
 130:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if ( LORAMAC_MAX_MC_CTX > 1 )
 131:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         { MULTICAST_1_ADDR, MC_APP_S_KEY_1, MC_NWK_S_KEY_1, MC_KEY_1 },
 132:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* LORAMAC_MAX_MC_CTX > 1 */
 133:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if ( LORAMAC_MAX_MC_CTX > 2 )
 134:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         { MULTICAST_2_ADDR, MC_APP_S_KEY_2, MC_NWK_S_KEY_2, MC_KEY_2 },
 135:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* LORAMAC_MAX_MC_CTX > 2 */
 136:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if ( LORAMAC_MAX_MC_CTX > 3 )
 137:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         { MULTICAST_3_ADDR, MC_APP_S_KEY_3, MC_NWK_S_KEY_3, MC_KEY_3 },
 138:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* LORAMAC_MAX_MC_CTX > 3 */
 139:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /* ST_WORKAROUND_END */
 140:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if ( USE_LRWAN_1_1_X_CRYPTO == 1 ) /* ST_WORKAROUND: integrate 1.1.x keys only if required */
 141:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         { UNICAST_DEV_ADDR, APP_S_KEY, S_NWK_S_INT_KEY, NO_KEY }
 142:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #else /* USE_LRWAN_1_1_X_CRYPTO == 0 */
 143:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         { UNICAST_DEV_ADDR, APP_S_KEY, NWK_S_KEY, NO_KEY }
 144:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* USE_LRWAN_1_1_X_CRYPTO */
 145:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     };
 146:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 4


 147:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /*
 148:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * Encrypts the payload
 149:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *
 150:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  keyID            - Key identifier
 151:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  address          - Address
 152:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  dir              - Frame direction ( Uplink or Downlink )
 153:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  frameCounter     - Frame counter
 154:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  size             - Size of data
 155:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN/OUT]  buffer       - Data buffer
 156:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \retval                      - Status of the operation
 157:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  */
 158:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** static LoRaMacCryptoStatus_t PayloadEncrypt( uint8_t* buffer, int16_t size, KeyIdentifier_t keyID, 
 159:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
 160:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( buffer == 0 )
 161:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 162:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_NPE;
 163:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 164:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 165:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t bufferIndex = 0;
 166:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint16_t ctr = 1;
 167:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t sBlock[16] = { 0 };
 168:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t aBlock[16] = { 0 };
 169:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 170:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[0] = 0x01;
 171:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 172:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[5] = dir;
 173:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 174:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[6] = address & 0xFF;
 175:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[7] = ( address >> 8 ) & 0xFF;
 176:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[8] = ( address >> 16 ) & 0xFF;
 177:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[9] = ( address >> 24 ) & 0xFF;
 178:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 179:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[10] = frameCounter & 0xFF;
 180:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[11] = ( frameCounter >> 8 ) & 0xFF;
 181:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[12] = ( frameCounter >> 16 ) & 0xFF;
 182:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[13] = ( frameCounter >> 24 ) & 0xFF;
 183:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 184:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     while( size > 0 )
 185:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 186:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         aBlock[15] = ctr & 0xFF;
 187:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         ctr++;
 188:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         if( SecureElementAesEncrypt( aBlock, 16, keyID, sBlock ) != SECURE_ELEMENT_SUCCESS )
 189:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
 190:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             return LORAMAC_CRYPTO_ERROR_SECURE_ELEMENT_FUNC;
 191:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
 192:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 193:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         for( uint8_t i = 0; i < ( ( size > 16 ) ? 16 : size ); i++ )
 194:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
 195:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             buffer[bufferIndex + i] = buffer[bufferIndex + i] ^ sBlock[i];
 196:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
 197:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         size -= 16;
 198:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         bufferIndex += 16;
 199:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 200:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 201:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     return LORAMAC_CRYPTO_SUCCESS;
 202:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 203:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 5


 204:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if( USE_LRWAN_1_1_X_CRYPTO == 1 )
 205:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /*
 206:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * Encrypts the FOpts
 207:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *
 208:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  address          - Address
 209:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  dir              - Frame direction ( Uplink or Downlink )
 210:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  fCntID           - Frame counter identifier
 211:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  frameCounter     - Frame counter
 212:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  size             - Size of data
 213:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN/OUT]  buffer       - Data buffer
 214:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \retval                      - Status of the operation
 215:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  */
 216:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** static LoRaMacCryptoStatus_t FOptsEncrypt( uint16_t size, uint32_t address, uint8_t dir, FCntIdenti
 217:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
 218:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( buffer == 0 )
 219:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 220:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_NPE;
 221:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 222:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 223:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t bufferIndex = 0;
 224:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t sBlock[16] = { 0 };
 225:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t aBlock[16] = { 0 };
 226:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 227:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[0] = 0x01;
 228:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 229:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( CryptoNvm->LrWanVersion.Value > 0x01010000 )
 230:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 231:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         // Introduced in LoRaWAN 1.1.1 specification
 232:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         switch( fCntID )
 233:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
 234:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             case FCNT_UP:
 235:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             {
 236:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****                 aBlock[4] = 0x01;
 237:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****                 break;
 238:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             }
 239:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             case N_FCNT_DOWN:
 240:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             {
 241:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****                 aBlock[4] = 0x01;
 242:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****                 break;
 243:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             }
 244:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             case A_FCNT_DOWN:
 245:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             {
 246:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****                 aBlock[4] = 0x02;
 247:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****                 break;
 248:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             }
 249:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             default:
 250:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****                 return LORAMAC_CRYPTO_FAIL_PARAM;
 251:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
 252:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 253:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 254:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[5] = dir;
 255:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 256:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[6] = address & 0xFF;
 257:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[7] = ( address >> 8 ) & 0xFF;
 258:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[8] = ( address >> 16 ) & 0xFF;
 259:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[9] = ( address >> 24 ) & 0xFF;
 260:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 6


 261:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[10] = frameCounter & 0xFF;
 262:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[11] = ( frameCounter >> 8 ) & 0xFF;
 263:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[12] = ( frameCounter >> 16 ) & 0xFF;
 264:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[13] = ( frameCounter >> 24 ) & 0xFF;
 265:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 266:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( CryptoNvm->LrWanVersion.Value > 0x01010000 )
 267:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 268:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         // Introduced in LoRaWAN 1.1.1 specification
 269:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         aBlock[15] = 0x01;
 270:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 271:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 272:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( size > 0 )
 273:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 274:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         if( SecureElementAesEncrypt( aBlock, 16, NWK_S_ENC_KEY, sBlock ) != SECURE_ELEMENT_SUCCESS 
 275:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
 276:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             return LORAMAC_CRYPTO_ERROR_SECURE_ELEMENT_FUNC;
 277:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
 278:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         for( uint8_t i = 0; i < size; i++ )
 279:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
 280:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             buffer[bufferIndex + i] = buffer[bufferIndex + i] ^ sBlock[i];
 281:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
 282:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 283:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 284:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     return LORAMAC_CRYPTO_SUCCESS;
 285:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 286:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* USE_LRWAN_1_1_X_CRYPTO == 1 */
 287:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 288:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /*
 289:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * Prepares B0 block for cmac computation.
 290:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *
 291:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  msgLen         - Length of message
 292:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  keyID          - Key identifier
 293:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  isAck          - True if it is a acknowledge frame ( Sets ConfFCnt in B0 block )
 294:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  devAddr        - Device address
 295:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  dir            - Frame direction ( Uplink:0, Downlink:1 )
 296:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  fCnt           - Frame counter
 297:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN/OUT]  b0         - B0 block
 298:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \retval                    - Status of the operation
 299:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  */
 300:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** static LoRaMacCryptoStatus_t PrepareB0( uint16_t msgLen, KeyIdentifier_t keyID, bool isAck, uint8_t
 301:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
  27              		.loc 1 301 1 view -0
  28              		.cfi_startproc
  29              		@ args = 12, pretend = 0, frame = 0
  30              		@ frame_needed = 0, uses_anonymous_args = 0
  31              		@ link register save eliminated.
  32              		.loc 1 301 1 is_stmt 0 view .LVU1
  33 0000 10B4     		push	{r4}
  34              	.LCFI0:
  35              		.cfi_def_cfa_offset 4
  36              		.cfi_offset 4, -4
  37 0002 019C     		ldr	r4, [sp, #4]
  38 0004 0299     		ldr	r1, [sp, #8]
  39              	.LVL1:
  40              		.loc 1 301 1 view .LVU2
  41 0006 039A     		ldr	r2, [sp, #12]
  42              	.LVL2:
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 7


 302:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( b0 == 0 )
  43              		.loc 1 302 5 is_stmt 1 view .LVU3
  44              		.loc 1 302 7 is_stmt 0 view .LVU4
  45 0008 DAB1     		cbz	r2, .L3
  46 000a 8446     		mov	ip, r0
 303:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 304:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_NPE;
 305:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 306:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 307:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     b0[0] = 0x49;
  47              		.loc 1 307 5 is_stmt 1 view .LVU5
  48              		.loc 1 307 11 is_stmt 0 view .LVU6
  49 000c 4920     		movs	r0, #73
  50              	.LVL3:
  51              		.loc 1 307 11 view .LVU7
  52 000e 1070     		strb	r0, [r2]
 308:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     /* ST_WORAROUND_BEGIN: These bytes are only used for the LRWAN 1.1.x */
 309:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if ( USE_LRWAN_1_1_X_CRYPTO == 1 )
 310:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( ( isAck == true ) && ( dir == DOWNLINK ) )
 311:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 312:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         // confFCnt contains the frame counter value modulo 2^16 of the "confirmed" uplink or downl
 313:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         uint16_t confFCnt = 0;
 314:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 315:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         confFCnt = ( uint16_t )( CryptoNvm->FCntList.FCntUp % 65536 );
 316:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 317:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         b0[1] = confFCnt & 0xFF;
 318:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         b0[2] = ( confFCnt >> 8 ) & 0xFF;
 319:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 320:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     else
 321:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* USE_LRWAN_1_1_X_CRYPTO == 1 */
 322:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     /* ST_WORAROUND_END */
 323:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 324:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         b0[1] = 0x00;
  53              		.loc 1 324 9 is_stmt 1 view .LVU8
  54              		.loc 1 324 15 is_stmt 0 view .LVU9
  55 0010 0020     		movs	r0, #0
  56 0012 5070     		strb	r0, [r2, #1]
 325:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         b0[2] = 0x00;
  57              		.loc 1 325 9 is_stmt 1 view .LVU10
  58              		.loc 1 325 15 is_stmt 0 view .LVU11
  59 0014 9070     		strb	r0, [r2, #2]
 326:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 327:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 328:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     b0[3] = 0x00;
  60              		.loc 1 328 5 is_stmt 1 view .LVU12
  61              		.loc 1 328 11 is_stmt 0 view .LVU13
  62 0016 D070     		strb	r0, [r2, #3]
 329:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     b0[4] = 0x00;
  63              		.loc 1 329 5 is_stmt 1 view .LVU14
  64              		.loc 1 329 11 is_stmt 0 view .LVU15
  65 0018 1071     		strb	r0, [r2, #4]
 330:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 331:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     b0[5] = dir;
  66              		.loc 1 331 5 is_stmt 1 view .LVU16
  67              		.loc 1 331 11 is_stmt 0 view .LVU17
  68 001a 5371     		strb	r3, [r2, #5]
 332:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 8


 333:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     b0[6] = devAddr & 0xFF;
  69              		.loc 1 333 5 is_stmt 1 view .LVU18
  70              		.loc 1 333 11 is_stmt 0 view .LVU19
  71 001c 9471     		strb	r4, [r2, #6]
 334:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     b0[7] = ( devAddr >> 8 ) & 0xFF;
  72              		.loc 1 334 5 is_stmt 1 view .LVU20
  73              		.loc 1 334 23 is_stmt 0 view .LVU21
  74 001e 230A     		lsrs	r3, r4, #8
  75              	.LVL4:
  76              		.loc 1 334 11 view .LVU22
  77 0020 D371     		strb	r3, [r2, #7]
 335:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     b0[8] = ( devAddr >> 16 ) & 0xFF;
  78              		.loc 1 335 5 is_stmt 1 view .LVU23
  79              		.loc 1 335 23 is_stmt 0 view .LVU24
  80 0022 230C     		lsrs	r3, r4, #16
  81              		.loc 1 335 11 view .LVU25
  82 0024 1372     		strb	r3, [r2, #8]
 336:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     b0[9] = ( devAddr >> 24 ) & 0xFF;
  83              		.loc 1 336 5 is_stmt 1 view .LVU26
  84              		.loc 1 336 23 is_stmt 0 view .LVU27
  85 0026 240E     		lsrs	r4, r4, #24
  86              		.loc 1 336 11 view .LVU28
  87 0028 5472     		strb	r4, [r2, #9]
 337:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 338:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     b0[10] = fCnt & 0xFF;
  88              		.loc 1 338 5 is_stmt 1 view .LVU29
  89              		.loc 1 338 12 is_stmt 0 view .LVU30
  90 002a 9172     		strb	r1, [r2, #10]
 339:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     b0[11] = ( fCnt >> 8 ) & 0xFF;
  91              		.loc 1 339 5 is_stmt 1 view .LVU31
  92              		.loc 1 339 21 is_stmt 0 view .LVU32
  93 002c 0B0A     		lsrs	r3, r1, #8
  94              		.loc 1 339 12 view .LVU33
  95 002e D372     		strb	r3, [r2, #11]
 340:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     b0[12] = ( fCnt >> 16 ) & 0xFF;
  96              		.loc 1 340 5 is_stmt 1 view .LVU34
  97              		.loc 1 340 21 is_stmt 0 view .LVU35
  98 0030 0B0C     		lsrs	r3, r1, #16
  99              		.loc 1 340 12 view .LVU36
 100 0032 1373     		strb	r3, [r2, #12]
 341:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     b0[13] = ( fCnt >> 24 ) & 0xFF;
 101              		.loc 1 341 5 is_stmt 1 view .LVU37
 102              		.loc 1 341 21 is_stmt 0 view .LVU38
 103 0034 090E     		lsrs	r1, r1, #24
 104              		.loc 1 341 12 view .LVU39
 105 0036 5173     		strb	r1, [r2, #13]
 342:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 343:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     b0[14] = 0x00;
 106              		.loc 1 343 5 is_stmt 1 view .LVU40
 107              		.loc 1 343 12 is_stmt 0 view .LVU41
 108 0038 9073     		strb	r0, [r2, #14]
 344:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 345:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     b0[15] = msgLen & 0xFF;
 109              		.loc 1 345 5 is_stmt 1 view .LVU42
 110              		.loc 1 345 12 is_stmt 0 view .LVU43
 111 003a 82F80FC0 		strb	ip, [r2, #15]
 346:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 9


 347:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     return LORAMAC_CRYPTO_SUCCESS;
 112              		.loc 1 347 5 is_stmt 1 view .LVU44
 113              	.LVL5:
 114              	.L2:
 348:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 115              		.loc 1 348 1 is_stmt 0 view .LVU45
 116 003e 10BC     		pop	{r4}
 117              	.LCFI1:
 118              		.cfi_remember_state
 119              		.cfi_restore 4
 120              		.cfi_def_cfa_offset 0
 121              	.LVL6:
 122              		.loc 1 348 1 view .LVU46
 123 0040 7047     		bx	lr
 124              	.LVL7:
 125              	.L3:
 126              	.LCFI2:
 127              		.cfi_restore_state
 304:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 128              		.loc 1 304 16 view .LVU47
 129 0042 0A20     		movs	r0, #10
 130              	.LVL8:
 304:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 131              		.loc 1 304 16 view .LVU48
 132 0044 FBE7     		b	.L2
 133              		.cfi_endproc
 134              	.LFE105:
 136              		.section	.text.GetKeyAddrItem,"ax",%progbits
 137              		.align	1
 138              		.syntax unified
 139              		.thumb
 140              		.thumb_func
 142              	GetKeyAddrItem:
 143              	.LVL9:
 144              	.LFB108:
 349:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 350:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /*
 351:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * Computes cmac with adding B0 block in front.
 352:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *
 353:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *  cmac = aes128_cmac(keyID, B0 | msg)
 354:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *
 355:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  msg            - Message to compute the integrity code
 356:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  len            - Length of message
 357:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  keyID          - Key identifier
 358:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  isAck          - True if it is a acknowledge frame ( Sets ConfFCnt in B0 block )
 359:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  devAddr        - Device address
 360:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  dir            - Frame direction ( Uplink:0, Downlink:1 )
 361:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  fCnt           - Frame counter
 362:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[OUT] cmac           - Computed cmac
 363:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \retval                    - Status of the operation
 364:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  */
 365:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** static LoRaMacCryptoStatus_t ComputeCmacB0( uint8_t* msg, uint16_t len, KeyIdentifier_t keyID, bool
 366:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
 367:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( ( msg == 0 ) || ( cmac == 0 ) )
 368:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 369:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_NPE;
 370:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 10


 371:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( len > CRYPTO_MAXMESSAGE_SIZE )
 372:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 373:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_BUF_SIZE;
 374:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 375:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 376:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t micBuff[MIC_BLOCK_BX_SIZE];
 377:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 378:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Initialize the first Block
 379:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     PrepareB0( len, keyID, isAck, dir, devAddr, fCnt, micBuff );
 380:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 381:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( SecureElementComputeAesCmac( micBuff, msg, len, keyID, cmac ) != SECURE_ELEMENT_SUCCESS )
 382:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 383:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_SECURE_ELEMENT_FUNC;
 384:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 385:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     return LORAMAC_CRYPTO_SUCCESS;
 386:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 387:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 388:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /*!
 389:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * Verifies cmac with adding B0 block in front.
 390:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *
 391:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  msg            - Message to compute the integrity code
 392:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  len            - Length of message
 393:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  keyID          - Key identifier
 394:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  isAck          - True if it is a acknowledge frame ( Sets ConfFCnt in B0 block )
 395:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  devAddr        - Device address
 396:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  dir            - Frame direction ( Uplink:0, Downlink:1 )
 397:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  fCnt           - Frame counter
 398:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[in]  expectedCmac   - Expected cmac
 399:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \retval                    - Status of the operation
 400:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  */
 401:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** static LoRaMacCryptoStatus_t VerifyCmacB0( uint8_t* msg, uint16_t len, KeyIdentifier_t keyID, bool 
 402:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
 403:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( msg == 0 )
 404:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 405:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_NPE;
 406:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 407:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( len > CRYPTO_MAXMESSAGE_SIZE )
 408:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 409:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_BUF_SIZE;
 410:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 411:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 412:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t micBuff[CRYPTO_BUFFER_SIZE];
 413:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     memset1( micBuff, 0, CRYPTO_BUFFER_SIZE );
 414:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 415:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Initialize the first Block
 416:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     PrepareB0( len, keyID, isAck, dir, devAddr, fCnt, micBuff );
 417:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 418:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Copy the given data to the mic computation buffer
 419:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     memcpy1( ( micBuff + MIC_BLOCK_BX_SIZE ), msg, len );
 420:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 421:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     SecureElementStatus_t retval = SECURE_ELEMENT_ERROR;
 422:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     retval = SecureElementVerifyAesCmac( micBuff, ( len + MIC_BLOCK_BX_SIZE ), expectedCmac, keyID 
 423:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 424:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( retval == SECURE_ELEMENT_SUCCESS )
 425:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 426:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_SUCCESS;
 427:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 11


 428:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     else if( retval == SECURE_ELEMENT_FAIL_CMAC )
 429:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 430:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_FAIL_MIC;
 431:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 432:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 433:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     return LORAMAC_CRYPTO_ERROR_SECURE_ELEMENT_FUNC;
 434:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 435:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 436:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if( USE_LRWAN_1_1_X_CRYPTO == 1 )
 437:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /*
 438:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * Prpares B1 block for cmac computation.
 439:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *
 440:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  msgLen         - Length of message
 441:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  keyID          - Key identifier
 442:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  isAck          - True if it is a acknowledge frame ( Sets ConfFCnt in B0 block )
 443:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  txDr           - Data rate used for the transmission
 444:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  txCh           - Index of the channel used for the transmission
 445:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  devAddr        - Device address
 446:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  fCntUp         - Frame counter
 447:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN/OUT]  b0         - B0 block
 448:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \retval                    - Status of the operation
 449:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  */
 450:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** static LoRaMacCryptoStatus_t PrepareB1( uint16_t msgLen, KeyIdentifier_t keyID, bool isAck, uint8_t
 451:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
 452:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( b1 == 0 )
 453:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 454:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_NPE;
 455:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 456:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 457:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     b1[0] = 0x49;
 458:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 459:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( isAck == true )
 460:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 461:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         // confFCnt contains the frame counter value modulo 2^16 of the "confirmed" uplink frame th
 462:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         uint16_t confFCnt = ( uint16_t )( *CryptoNvm->LastDownFCnt % 65536 );
 463:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         b1[1] = confFCnt & 0xFF;
 464:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         b1[2] = ( confFCnt >> 8 ) & 0xFF;
 465:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 466:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     else
 467:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 468:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         b1[1] = 0x00;
 469:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         b1[2] = 0x00;
 470:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 471:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 472:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     b1[3] = txDr;
 473:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     b1[4] = txCh;
 474:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     b1[5] = UPLINK;  // dir = Uplink
 475:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 476:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     b1[6] = devAddr & 0xFF;
 477:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     b1[7] = ( devAddr >> 8 ) & 0xFF;
 478:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     b1[8] = ( devAddr >> 16 ) & 0xFF;
 479:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     b1[9] = ( devAddr >> 24 ) & 0xFF;
 480:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 481:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     b1[10] = fCntUp & 0xFF;
 482:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     b1[11] = ( fCntUp >> 8 ) & 0xFF;
 483:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     b1[12] = ( fCntUp >> 16 ) & 0xFF;
 484:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     b1[13] = ( fCntUp >> 24 ) & 0xFF;
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 12


 485:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 486:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     b1[14] = 0x00;
 487:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 488:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     b1[15] = msgLen & 0xFF;
 489:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 490:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     return LORAMAC_CRYPTO_SUCCESS;
 491:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 492:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 493:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /*
 494:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * Computes cmac with adding B1 block in front ( only for Uplink frames LoRaWAN 1.1 )
 495:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *
 496:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *  cmac = aes128_cmac(keyID, B1 | msg)
 497:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *
 498:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  msg            - Message to calculate the Integrity code
 499:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  len            - Length of message
 500:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  keyID          - Key identifier
 501:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  isAck          - True if it is a acknowledge frame ( Sets ConfFCnt in B0 block )
 502:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  txDr           - Data rate used for the transmission
 503:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  txCh           - Index of the channel used for the transmission
 504:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  devAddr        - Device address
 505:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  fCntUp         - Uplink Frame counter
 506:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[OUT] cmac           - Computed cmac
 507:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \retval                    - Status of the operation
 508:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  */
 509:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** static LoRaMacCryptoStatus_t ComputeCmacB1( uint8_t* msg, uint16_t len, KeyIdentifier_t keyID, bool
 510:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
 511:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( ( msg == 0 ) || ( cmac == 0 ) )
 512:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 513:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_NPE;
 514:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 515:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( len > CRYPTO_MAXMESSAGE_SIZE )
 516:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 517:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_BUF_SIZE;
 518:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 519:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 520:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t micBuff[MIC_BLOCK_BX_SIZE];
 521:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 522:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Initialize the first Block
 523:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     PrepareB1( len, keyID, isAck, txDr, txCh, devAddr, fCntUp, micBuff );
 524:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 525:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( SecureElementComputeAesCmac( micBuff, msg, len, keyID, cmac ) != SECURE_ELEMENT_SUCCESS )
 526:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 527:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_SECURE_ELEMENT_FUNC;
 528:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 529:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     return LORAMAC_CRYPTO_SUCCESS;
 530:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 531:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* USE_LRWAN_1_1_X_CRYPTO == 1 */
 532:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 533:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /*
 534:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * Gets security item from list.
 535:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *
 536:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  addrID          - Address identifier
 537:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[OUT] keyItem        - Key item reference
 538:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \retval                    - Status of the operation
 539:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  */
 540:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** static LoRaMacCryptoStatus_t GetKeyAddrItem( AddressIdentifier_t addrID, KeyAddr_t** item )
 541:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 13


 145              		.loc 1 541 1 is_stmt 1 view -0
 146              		.cfi_startproc
 147              		@ args = 0, pretend = 0, frame = 0
 148              		@ frame_needed = 0, uses_anonymous_args = 0
 149              		@ link register save eliminated.
 542:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     for( uint8_t i = 0; i < NUM_OF_SEC_CTX; i++ )
 150              		.loc 1 542 5 view .LVU50
 151              	.LBB2:
 152              		.loc 1 542 10 view .LVU51
 153              		.loc 1 542 18 is_stmt 0 view .LVU52
 154 0000 0023     		movs	r3, #0
 155              	.LVL10:
 156              	.L6:
 157              		.loc 1 542 25 is_stmt 1 discriminator 1 view .LVU53
 158              		.loc 1 542 5 is_stmt 0 discriminator 1 view .LVU54
 159 0002 012B     		cmp	r3, #1
 160 0004 0ED8     		bhi	.L10
 543:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 544:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         if( KeyAddrList[i].AddrID == addrID )
 161              		.loc 1 544 9 is_stmt 1 view .LVU55
 162              		.loc 1 544 27 is_stmt 0 view .LVU56
 163 0006 9C46     		mov	ip, r3
 164 0008 074A     		ldr	r2, .L12
 165 000a 12F82320 		ldrb	r2, [r2, r3, lsl #2]	@ zero_extendqisi2
 166              		.loc 1 544 11 view .LVU57
 167 000e 8242     		cmp	r2, r0
 168 0010 02D0     		beq	.L11
 542:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     for( uint8_t i = 0; i < NUM_OF_SEC_CTX; i++ )
 169              		.loc 1 542 45 is_stmt 1 discriminator 2 view .LVU58
 542:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     for( uint8_t i = 0; i < NUM_OF_SEC_CTX; i++ )
 170              		.loc 1 542 46 is_stmt 0 discriminator 2 view .LVU59
 171 0012 0133     		adds	r3, r3, #1
 172              	.LVL11:
 542:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     for( uint8_t i = 0; i < NUM_OF_SEC_CTX; i++ )
 173              		.loc 1 542 46 discriminator 2 view .LVU60
 174 0014 DBB2     		uxtb	r3, r3
 175              	.LVL12:
 542:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     for( uint8_t i = 0; i < NUM_OF_SEC_CTX; i++ )
 176              		.loc 1 542 46 discriminator 2 view .LVU61
 177 0016 F4E7     		b	.L6
 178              	.L11:
 545:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
 546:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             *item = &( KeyAddrList[i] );
 179              		.loc 1 546 13 is_stmt 1 view .LVU62
 180              		.loc 1 546 21 is_stmt 0 view .LVU63
 181 0018 034B     		ldr	r3, .L12
 182              	.LVL13:
 183              		.loc 1 546 21 view .LVU64
 184 001a 03EB8C03 		add	r3, r3, ip, lsl #2
 185              		.loc 1 546 19 view .LVU65
 186 001e 0B60     		str	r3, [r1]
 547:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             return LORAMAC_CRYPTO_SUCCESS;
 187              		.loc 1 547 13 is_stmt 1 view .LVU66
 188              		.loc 1 547 20 is_stmt 0 view .LVU67
 189 0020 0020     		movs	r0, #0
 190              	.LVL14:
 191              		.loc 1 547 20 view .LVU68
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 14


 192 0022 7047     		bx	lr
 193              	.LVL15:
 194              	.L10:
 195              		.loc 1 547 20 view .LVU69
 196              	.LBE2:
 548:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
 549:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 550:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     return LORAMAC_CRYPTO_ERROR_INVALID_ADDR_ID;
 197              		.loc 1 550 12 view .LVU70
 198 0024 0C20     		movs	r0, #12
 199              	.LVL16:
 551:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 200              		.loc 1 551 1 view .LVU71
 201 0026 7047     		bx	lr
 202              	.L13:
 203              		.align	2
 204              	.L12:
 205 0028 00000000 		.word	.LANCHOR0
 206              		.cfi_endproc
 207              	.LFE108:
 209              		.section	.text.GetLastFcntDown,"ax",%progbits
 210              		.align	1
 211              		.syntax unified
 212              		.thumb
 213              		.thumb_func
 215              	GetLastFcntDown:
 216              	.LVL17:
 217              	.LFB110:
 552:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 553:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /*
 554:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * Derives a session key as of LoRaWAN versions prior to 1.1.0
 555:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *
 556:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  keyID          - Key Identifier for the key to be calculated
 557:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  joinNonce      - Sever nonce
 558:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  netID          - Network Identifier
 559:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  deviceNonce    - Device nonce
 560:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \retval                    - Status of the operation
 561:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  */
 562:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** static LoRaMacCryptoStatus_t DeriveSessionKey10x( KeyIdentifier_t keyID, uint32_t joinNonce, uint32
 563:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
 564:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t compBase[16] = { 0 };
 565:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 566:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     /* ST_WORKAROUND_BEGIN: integrate 1.1.x keys only if required */
 567:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     switch( keyID )
 568:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 569:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if ( USE_LRWAN_1_1_X_CRYPTO == 1 )
 570:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         case F_NWK_S_INT_KEY:
 571:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         case S_NWK_S_INT_KEY:
 572:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         case NWK_S_ENC_KEY:
 573:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #else /* USE_LRWAN_1_1_X_CRYPTO == 0 */
 574:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         case NWK_S_KEY:
 575:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* USE_LRWAN_1_1_X_CRYPTO */
 576:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             compBase[0] = 0x01;
 577:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 578:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         case APP_S_KEY:
 579:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             compBase[0] = 0x02;
 580:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 15


 581:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         default:
 582:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             return LORAMAC_CRYPTO_ERROR_INVALID_KEY_ID;
 583:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 584:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****    /* ST_WORKAROUND_END */
 585:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 586:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBase[1] = ( uint8_t )( ( joinNonce >> 0 ) & 0xFF );
 587:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBase[2] = ( uint8_t )( ( joinNonce >> 8 ) & 0xFF );
 588:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBase[3] = ( uint8_t )( ( joinNonce >> 16 ) & 0xFF );
 589:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 590:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBase[4] = ( uint8_t )( ( netID >> 0 ) & 0xFF );
 591:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBase[5] = ( uint8_t )( ( netID >> 8 ) & 0xFF );
 592:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBase[6] = ( uint8_t )( ( netID >> 16 ) & 0xFF );
 593:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 594:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBase[7] = ( uint8_t )( ( devNonce >> 0 ) & 0xFF );
 595:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBase[8] = ( uint8_t )( ( devNonce >> 8 ) & 0xFF );
 596:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 597:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( SecureElementDeriveAndStoreKey( compBase, NWK_KEY, keyID ) != SECURE_ELEMENT_SUCCESS )
 598:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 599:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_SECURE_ELEMENT_FUNC;
 600:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 601:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 602:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     return LORAMAC_CRYPTO_SUCCESS;
 603:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 604:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 605:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if( USE_LRWAN_1_1_X_CRYPTO == 1 )
 606:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /*
 607:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * Derives a session key as of LoRaWAN 1.1.0
 608:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *
 609:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  keyID          - Key Identifier for the key to be calculated
 610:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  joinNonce      - Sever nonce
 611:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  joinEUI        - Join Server EUI
 612:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  deviceNonce    - Device nonce
 613:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \retval                    - Status of the operation
 614:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  */
 615:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** static LoRaMacCryptoStatus_t DeriveSessionKey11x( KeyIdentifier_t keyID, uint32_t joinNonce, uint8_
 616:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
 617:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( joinEUI == 0 )
 618:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 619:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_NPE;
 620:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 621:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 622:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t compBase[16] = { 0 };
 623:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     KeyIdentifier_t rootKeyId = NWK_KEY;
 624:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 625:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     switch( keyID )
 626:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 627:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         case F_NWK_S_INT_KEY:
 628:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             compBase[0] = 0x01;
 629:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 630:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         case S_NWK_S_INT_KEY:
 631:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             compBase[0] = 0x03;
 632:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 633:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         case NWK_S_ENC_KEY:
 634:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             compBase[0] = 0x04;
 635:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 636:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         case APP_S_KEY:
 637:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             rootKeyId = APP_KEY;
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 16


 638:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             compBase[0] = 0x02;
 639:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 640:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         default:
 641:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             return LORAMAC_CRYPTO_ERROR_INVALID_KEY_ID;
 642:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 643:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 644:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBase[1] = ( uint8_t )( ( joinNonce >> 0 ) & 0xFF );
 645:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBase[2] = ( uint8_t )( ( joinNonce >> 8 ) & 0xFF );
 646:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBase[3] = ( uint8_t )( ( joinNonce >> 16 ) & 0xFF );
 647:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 648:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     memcpyr( compBase + 4, joinEUI, 8 );
 649:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 650:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBase[12] = ( uint8_t )( ( devNonce >> 0 ) & 0xFF );
 651:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBase[13] = ( uint8_t )( ( devNonce >> 8 ) & 0xFF );
 652:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 653:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( SecureElementDeriveAndStoreKey( compBase, rootKeyId, keyID ) != SECURE_ELEMENT_SUCCESS )
 654:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 655:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_SECURE_ELEMENT_FUNC;
 656:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 657:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 658:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     return LORAMAC_CRYPTO_SUCCESS;
 659:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 660:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 661:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /*
 662:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * Derives a life time session key (JSIntKey or JSEncKey)  as of LoRaWAN 1.1.0
 663:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *
 664:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  keyID          - Key Identifier for the key to be calculated
 665:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]  devEUI         - Device EUI
 666:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \retval                    - Status of the operation
 667:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  */
 668:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** static LoRaMacCryptoStatus_t DeriveLifeTimeSessionKey( KeyIdentifier_t keyID, uint8_t* devEUI )
 669:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
 670:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( devEUI == 0 )
 671:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 672:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_NPE;
 673:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 674:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 675:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t compBase[16] = { 0 };
 676:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 677:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     switch( keyID )
 678:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 679:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         case J_S_INT_KEY:
 680:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             compBase[0] = 0x06;
 681:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 682:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         case J_S_ENC_KEY:
 683:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             compBase[0] = 0x05;
 684:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 685:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         default:
 686:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             return LORAMAC_CRYPTO_ERROR_INVALID_KEY_ID;
 687:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 688:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 689:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     memcpyr( compBase + 1, devEUI, 8 );
 690:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 691:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( SecureElementDeriveAndStoreKey( compBase, NWK_KEY, keyID ) != SECURE_ELEMENT_SUCCESS )
 692:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 693:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_SECURE_ELEMENT_FUNC;
 694:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 17


 695:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 696:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     return LORAMAC_CRYPTO_SUCCESS;
 697:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 698:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* USE_LRWAN_1_1_X_CRYPTO == 1 */
 699:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 700:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /*
 701:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * Gets the last received frame counter
 702:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *
 703:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]     fCntID       - Frame counter identifier
 704:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]     lastDown     - Last downlink counter value
 705:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *
 706:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \retval                     - Status of the operation
 707:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  */
 708:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** static LoRaMacCryptoStatus_t GetLastFcntDown( FCntIdentifier_t fCntID, uint32_t* lastDown )
 709:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
 218              		.loc 1 709 1 is_stmt 1 view -0
 219              		.cfi_startproc
 220              		@ args = 0, pretend = 0, frame = 0
 221              		@ frame_needed = 0, uses_anonymous_args = 0
 222              		@ link register save eliminated.
 710:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( lastDown == NULL )
 223              		.loc 1 710 5 view .LVU73
 224              		.loc 1 710 7 is_stmt 0 view .LVU74
 225 0000 0B46     		mov	r3, r1
 226 0002 0029     		cmp	r1, #0
 227 0004 24D0     		beq	.L21
 711:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 712:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_NPE;
 713:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 714:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     switch( fCntID )
 228              		.loc 1 714 5 is_stmt 1 view .LVU75
 229 0006 0138     		subs	r0, r0, #1
 230              	.LVL18:
 231              		.loc 1 714 5 is_stmt 0 view .LVU76
 232 0008 0328     		cmp	r0, #3
 233 000a 23D8     		bhi	.L22
 234 000c DFE800F0 		tbb	[pc, r0]
 235              	.L17:
 236 0010 02       		.byte	(.L20-.L17)/2
 237 0011 0A       		.byte	(.L19-.L17)/2
 238 0012 12       		.byte	(.L18-.L17)/2
 239 0013 1A       		.byte	(.L16-.L17)/2
 240              		.p2align 1
 241              	.L20:
 715:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 716:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         case N_FCNT_DOWN:
 717:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             *lastDown = CryptoNvm->FCntList.NFCntDown;
 242              		.loc 1 717 13 is_stmt 1 view .LVU77
 243              		.loc 1 717 34 is_stmt 0 view .LVU78
 244 0014 104A     		ldr	r2, .L23
 245 0016 1268     		ldr	r2, [r2]
 246              		.loc 1 717 44 view .LVU79
 247 0018 1169     		ldr	r1, [r2, #16]
 248              	.LVL19:
 249              		.loc 1 717 23 view .LVU80
 250 001a 1960     		str	r1, [r3]
 718:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             CryptoNvm->LastDownFCnt = CryptoNvm->FCntList.NFCntDown;
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 18


 251              		.loc 1 718 13 is_stmt 1 view .LVU81
 252              		.loc 1 718 58 is_stmt 0 view .LVU82
 253 001c 1369     		ldr	r3, [r2, #16]
 254              	.LVL20:
 255              		.loc 1 718 37 view .LVU83
 256 001e 1362     		str	r3, [r2, #32]
 719:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 257              		.loc 1 719 13 is_stmt 1 view .LVU84
 720:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         case A_FCNT_DOWN:
 721:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             *lastDown = CryptoNvm->FCntList.AFCntDown;
 722:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             CryptoNvm->LastDownFCnt = CryptoNvm->FCntList.AFCntDown;
 723:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 724:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         case FCNT_DOWN:
 725:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             *lastDown = CryptoNvm->FCntList.FCntDown;
 726:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             CryptoNvm->LastDownFCnt = CryptoNvm->FCntList.FCntDown;
 727:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 728:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if ( LORAMAC_MAX_MC_CTX > 0 )
 729:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         case MC_FCNT_DOWN_0:
 730:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             *lastDown = CryptoNvm->FCntList.McFCntDown[0];
 731:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 732:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* LORAMAC_MAX_MC_CTX > 0 */
 733:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if ( LORAMAC_MAX_MC_CTX > 1 )
 734:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         case MC_FCNT_DOWN_1:
 735:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             *lastDown = CryptoNvm->FCntList.McFCntDown[1];
 736:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 737:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* LORAMAC_MAX_MC_CTX > 1 */
 738:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if ( LORAMAC_MAX_MC_CTX > 2 )
 739:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         case MC_FCNT_DOWN_2:
 740:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             *lastDown = CryptoNvm->FCntList.McFCntDown[2];
 741:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 742:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* LORAMAC_MAX_MC_CTX > 2 */
 743:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if ( LORAMAC_MAX_MC_CTX > 3 )
 744:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         case MC_FCNT_DOWN_3:
 745:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             *lastDown = CryptoNvm->FCntList.McFCntDown[3];
 746:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 747:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* LORAMAC_MAX_MC_CTX > 3 */
 748:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         default:
 749:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             return LORAMAC_CRYPTO_FAIL_FCNT_ID;
 750:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 751:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     return LORAMAC_CRYPTO_SUCCESS;
 258              		.loc 1 751 12 is_stmt 0 view .LVU85
 259 0020 0020     		movs	r0, #0
 719:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 260              		.loc 1 719 13 view .LVU86
 261 0022 7047     		bx	lr
 262              	.LVL21:
 263              	.L19:
 721:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             CryptoNvm->LastDownFCnt = CryptoNvm->FCntList.AFCntDown;
 264              		.loc 1 721 13 is_stmt 1 view .LVU87
 721:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             CryptoNvm->LastDownFCnt = CryptoNvm->FCntList.AFCntDown;
 265              		.loc 1 721 34 is_stmt 0 view .LVU88
 266 0024 0C4A     		ldr	r2, .L23
 267 0026 1268     		ldr	r2, [r2]
 721:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             CryptoNvm->LastDownFCnt = CryptoNvm->FCntList.AFCntDown;
 268              		.loc 1 721 44 view .LVU89
 269 0028 5169     		ldr	r1, [r2, #20]
 270              	.LVL22:
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 19


 721:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             CryptoNvm->LastDownFCnt = CryptoNvm->FCntList.AFCntDown;
 271              		.loc 1 721 23 view .LVU90
 272 002a 1960     		str	r1, [r3]
 722:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 273              		.loc 1 722 13 is_stmt 1 view .LVU91
 722:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 274              		.loc 1 722 58 is_stmt 0 view .LVU92
 275 002c 5369     		ldr	r3, [r2, #20]
 276              	.LVL23:
 722:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 277              		.loc 1 722 37 view .LVU93
 278 002e 1362     		str	r3, [r2, #32]
 723:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         case FCNT_DOWN:
 279              		.loc 1 723 13 is_stmt 1 view .LVU94
 280              		.loc 1 751 12 is_stmt 0 view .LVU95
 281 0030 0020     		movs	r0, #0
 723:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         case FCNT_DOWN:
 282              		.loc 1 723 13 view .LVU96
 283 0032 7047     		bx	lr
 284              	.LVL24:
 285              	.L18:
 725:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             CryptoNvm->LastDownFCnt = CryptoNvm->FCntList.FCntDown;
 286              		.loc 1 725 13 is_stmt 1 view .LVU97
 725:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             CryptoNvm->LastDownFCnt = CryptoNvm->FCntList.FCntDown;
 287              		.loc 1 725 34 is_stmt 0 view .LVU98
 288 0034 084A     		ldr	r2, .L23
 289 0036 1268     		ldr	r2, [r2]
 725:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             CryptoNvm->LastDownFCnt = CryptoNvm->FCntList.FCntDown;
 290              		.loc 1 725 44 view .LVU99
 291 0038 9169     		ldr	r1, [r2, #24]
 292              	.LVL25:
 725:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             CryptoNvm->LastDownFCnt = CryptoNvm->FCntList.FCntDown;
 293              		.loc 1 725 23 view .LVU100
 294 003a 1960     		str	r1, [r3]
 726:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 295              		.loc 1 726 13 is_stmt 1 view .LVU101
 726:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 296              		.loc 1 726 58 is_stmt 0 view .LVU102
 297 003c 9369     		ldr	r3, [r2, #24]
 298              	.LVL26:
 726:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 299              		.loc 1 726 37 view .LVU103
 300 003e 1362     		str	r3, [r2, #32]
 727:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if ( LORAMAC_MAX_MC_CTX > 0 )
 301              		.loc 1 727 13 is_stmt 1 view .LVU104
 302              		.loc 1 751 12 is_stmt 0 view .LVU105
 303 0040 0020     		movs	r0, #0
 727:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if ( LORAMAC_MAX_MC_CTX > 0 )
 304              		.loc 1 727 13 view .LVU106
 305 0042 7047     		bx	lr
 306              	.LVL27:
 307              	.L16:
 730:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 308              		.loc 1 730 13 is_stmt 1 view .LVU107
 730:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 309              		.loc 1 730 34 is_stmt 0 view .LVU108
 310 0044 044A     		ldr	r2, .L23
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 20


 311 0046 1268     		ldr	r2, [r2]
 730:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 312              		.loc 1 730 55 view .LVU109
 313 0048 D269     		ldr	r2, [r2, #28]
 730:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 314              		.loc 1 730 23 view .LVU110
 315 004a 0A60     		str	r2, [r1]
 731:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* LORAMAC_MAX_MC_CTX > 0 */
 316              		.loc 1 731 13 is_stmt 1 view .LVU111
 317              		.loc 1 751 12 is_stmt 0 view .LVU112
 318 004c 0020     		movs	r0, #0
 731:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* LORAMAC_MAX_MC_CTX > 0 */
 319              		.loc 1 731 13 view .LVU113
 320 004e 7047     		bx	lr
 321              	.LVL28:
 322              	.L21:
 712:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 323              		.loc 1 712 16 view .LVU114
 324 0050 0A20     		movs	r0, #10
 325              	.LVL29:
 712:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 326              		.loc 1 712 16 view .LVU115
 327 0052 7047     		bx	lr
 328              	.L22:
 714:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 329              		.loc 1 714 5 view .LVU116
 330 0054 0520     		movs	r0, #5
 752:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 331              		.loc 1 752 1 view .LVU117
 332 0056 7047     		bx	lr
 333              	.L24:
 334              		.align	2
 335              	.L23:
 336 0058 00000000 		.word	.LANCHOR1
 337              		.cfi_endproc
 338              	.LFE110:
 340              		.section	.text.CheckFCntDown,"ax",%progbits
 341              		.align	1
 342              		.syntax unified
 343              		.thumb
 344              		.thumb_func
 346              	CheckFCntDown:
 347              	.LVL30:
 348              	.LFB111:
 753:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 754:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /*
 755:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * Checks the downlink counter value
 756:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *
 757:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]     fCntID       - Frame counter identifier
 758:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]     currentDown  - Current downlink counter value
 759:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *
 760:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \retval                     - Status of the operation
 761:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  */
 762:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** static bool CheckFCntDown( FCntIdentifier_t fCntID, uint32_t currentDown )
 763:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
 349              		.loc 1 763 1 is_stmt 1 view -0
 350              		.cfi_startproc
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 21


 351              		@ args = 0, pretend = 0, frame = 8
 352              		@ frame_needed = 0, uses_anonymous_args = 0
 353              		.loc 1 763 1 is_stmt 0 view .LVU119
 354 0000 10B5     		push	{r4, lr}
 355              	.LCFI3:
 356              		.cfi_def_cfa_offset 8
 357              		.cfi_offset 4, -8
 358              		.cfi_offset 14, -4
 359 0002 82B0     		sub	sp, sp, #8
 360              	.LCFI4:
 361              		.cfi_def_cfa_offset 16
 362 0004 0C46     		mov	r4, r1
 764:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint32_t lastDown = 0;
 363              		.loc 1 764 5 is_stmt 1 view .LVU120
 364              		.loc 1 764 14 is_stmt 0 view .LVU121
 365 0006 0023     		movs	r3, #0
 366 0008 0193     		str	r3, [sp, #4]
 765:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( GetLastFcntDown( fCntID, &lastDown ) != LORAMAC_CRYPTO_SUCCESS )
 367              		.loc 1 765 5 is_stmt 1 view .LVU122
 368              		.loc 1 765 9 is_stmt 0 view .LVU123
 369 000a 01A9     		add	r1, sp, #4
 370              	.LVL31:
 371              		.loc 1 765 9 view .LVU124
 372 000c FFF7FEFF 		bl	GetLastFcntDown
 373              	.LVL32:
 374              		.loc 1 765 7 view .LVU125
 375 0010 48B9     		cbnz	r0, .L27
 766:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 767:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return false;
 768:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 769:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( ( currentDown > lastDown ) ||
 376              		.loc 1 769 5 is_stmt 1 view .LVU126
 377              		.loc 1 769 23 is_stmt 0 view .LVU127
 378 0012 019B     		ldr	r3, [sp, #4]
 379              		.loc 1 769 7 view .LVU128
 380 0014 A342     		cmp	r3, r4
 381 0016 09D3     		bcc	.L28
 382              		.loc 1 769 36 discriminator 1 view .LVU129
 383 0018 B3F1FF3F 		cmp	r3, #-1
 384 001c 01D0     		beq	.L31
 770:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         // For LoRaWAN 1.0.X only. Allow downlink frames of 0
 771:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         ( lastDown == FCNT_DOWN_INITAL_VALUE ) )
 772:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 773:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return true;
 774:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 775:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     else
 776:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 777:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return false;
 385              		.loc 1 777 16 view .LVU130
 386 001e 0020     		movs	r0, #0
 387 0020 02E0     		b	.L26
 388              	.L31:
 773:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 389              		.loc 1 773 16 view .LVU131
 390 0022 0120     		movs	r0, #1
 391 0024 00E0     		b	.L26
 392              	.L27:
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 22


 767:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 393              		.loc 1 767 16 view .LVU132
 394 0026 0020     		movs	r0, #0
 395              	.L26:
 778:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 779:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 396              		.loc 1 779 1 view .LVU133
 397 0028 02B0     		add	sp, sp, #8
 398              	.LCFI5:
 399              		.cfi_remember_state
 400              		.cfi_def_cfa_offset 8
 401              		@ sp needed
 402 002a 10BD     		pop	{r4, pc}
 403              	.LVL33:
 404              	.L28:
 405              	.LCFI6:
 406              		.cfi_restore_state
 773:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 407              		.loc 1 773 16 view .LVU134
 408 002c 0120     		movs	r0, #1
 409 002e FBE7     		b	.L26
 410              		.cfi_endproc
 411              	.LFE111:
 413              		.section	.text.UpdateFCntDown,"ax",%progbits
 414              		.align	1
 415              		.syntax unified
 416              		.thumb
 417              		.thumb_func
 419              	UpdateFCntDown:
 420              	.LVL34:
 421              	.LFB112:
 780:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 781:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /*!
 782:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * Updates the reference downlink counter
 783:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *
 784:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]     fCntID        - Frame counter identifier
 785:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \param[IN]     currentDown   - Current downlink counter value
 786:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *
 787:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * \retval                     - Status of the operation
 788:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  */
 789:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** static void UpdateFCntDown( FCntIdentifier_t fCntID, uint32_t currentDown )
 790:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
 422              		.loc 1 790 1 is_stmt 1 view -0
 423              		.cfi_startproc
 424              		@ args = 0, pretend = 0, frame = 0
 425              		@ frame_needed = 0, uses_anonymous_args = 0
 426              		@ link register save eliminated.
 791:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     switch( fCntID )
 427              		.loc 1 791 5 view .LVU136
 428 0000 0138     		subs	r0, r0, #1
 429              	.LVL35:
 430              		.loc 1 791 5 is_stmt 0 view .LVU137
 431 0002 0328     		cmp	r0, #3
 432 0004 12D8     		bhi	.L32
 433 0006 DFE800F0 		tbb	[pc, r0]
 434              	.L35:
 435 000a 02       		.byte	(.L38-.L35)/2
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 23


 436 000b 06       		.byte	(.L37-.L35)/2
 437 000c 0A       		.byte	(.L36-.L35)/2
 438 000d 0E       		.byte	(.L34-.L35)/2
 439              		.p2align 1
 440              	.L38:
 792:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 793:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         case N_FCNT_DOWN:
 794:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             CryptoNvm->FCntList.NFCntDown = currentDown;
 441              		.loc 1 794 13 is_stmt 1 view .LVU138
 442              		.loc 1 794 22 is_stmt 0 view .LVU139
 443 000e 084B     		ldr	r3, .L39
 444 0010 1B68     		ldr	r3, [r3]
 445              		.loc 1 794 43 view .LVU140
 446 0012 1961     		str	r1, [r3, #16]
 795:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 447              		.loc 1 795 13 is_stmt 1 view .LVU141
 448 0014 7047     		bx	lr
 449              	.L37:
 796:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         case A_FCNT_DOWN:
 797:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             CryptoNvm->FCntList.AFCntDown = currentDown;
 450              		.loc 1 797 13 view .LVU142
 451              		.loc 1 797 22 is_stmt 0 view .LVU143
 452 0016 064B     		ldr	r3, .L39
 453 0018 1B68     		ldr	r3, [r3]
 454              		.loc 1 797 43 view .LVU144
 455 001a 5961     		str	r1, [r3, #20]
 798:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 456              		.loc 1 798 13 is_stmt 1 view .LVU145
 457 001c 7047     		bx	lr
 458              	.L36:
 799:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         case FCNT_DOWN:
 800:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             CryptoNvm->FCntList.FCntDown = currentDown;
 459              		.loc 1 800 13 view .LVU146
 460              		.loc 1 800 22 is_stmt 0 view .LVU147
 461 001e 044B     		ldr	r3, .L39
 462 0020 1B68     		ldr	r3, [r3]
 463              		.loc 1 800 42 view .LVU148
 464 0022 9961     		str	r1, [r3, #24]
 801:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 465              		.loc 1 801 13 is_stmt 1 view .LVU149
 466 0024 7047     		bx	lr
 467              	.L34:
 802:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if ( LORAMAC_MAX_MC_CTX > 0 )
 803:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         case MC_FCNT_DOWN_0:
 804:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             CryptoNvm->FCntList.McFCntDown[0] = currentDown;
 468              		.loc 1 804 13 view .LVU150
 469              		.loc 1 804 22 is_stmt 0 view .LVU151
 470 0026 024B     		ldr	r3, .L39
 471 0028 1B68     		ldr	r3, [r3]
 472              		.loc 1 804 47 view .LVU152
 473 002a D961     		str	r1, [r3, #28]
 805:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 474              		.loc 1 805 13 is_stmt 1 view .LVU153
 475              	.L32:
 806:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* LORAMAC_MAX_MC_CTX > 0 */
 807:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if ( LORAMAC_MAX_MC_CTX > 1 )
 808:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         case MC_FCNT_DOWN_1:
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 24


 809:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             CryptoNvm->FCntList.McFCntDown[1] = currentDown;
 810:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 811:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* LORAMAC_MAX_MC_CTX > 1 */
 812:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if ( LORAMAC_MAX_MC_CTX > 2 )
 813:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         case MC_FCNT_DOWN_2:
 814:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             CryptoNvm->FCntList.McFCntDown[2] = currentDown;
 815:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 816:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* LORAMAC_MAX_MC_CTX > 2 */
 817:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if ( LORAMAC_MAX_MC_CTX > 3 )
 818:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         case MC_FCNT_DOWN_3:
 819:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             CryptoNvm->FCntList.McFCntDown[3] = currentDown;
 820:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 821:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* LORAMAC_MAX_MC_CTX > 3 */
 822:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         default:
 823:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 824:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 825:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 476              		.loc 1 825 1 is_stmt 0 view .LVU154
 477 002c 7047     		bx	lr
 478              	.L40:
 479 002e 00BF     		.align	2
 480              	.L39:
 481 0030 00000000 		.word	.LANCHOR1
 482              		.cfi_endproc
 483              	.LFE112:
 485              		.section	.text.ResetFCnts,"ax",%progbits
 486              		.align	1
 487              		.syntax unified
 488              		.thumb
 489              		.thumb_func
 491              	ResetFCnts:
 492              	.LFB113:
 826:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 827:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /*!
 828:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  * Resets the frame counters
 829:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  */
 830:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** static void ResetFCnts( void )
 831:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
 493              		.loc 1 831 1 is_stmt 1 view -0
 494              		.cfi_startproc
 495              		@ args = 0, pretend = 0, frame = 0
 496              		@ frame_needed = 0, uses_anonymous_args = 0
 497              		@ link register save eliminated.
 832:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     CryptoNvm->FCntList.FCntUp = 0;
 498              		.loc 1 832 5 view .LVU156
 499              		.loc 1 832 14 is_stmt 0 view .LVU157
 500 0000 0A4B     		ldr	r3, .L44
 501 0002 1A68     		ldr	r2, [r3]
 502              		.loc 1 832 32 view .LVU158
 503 0004 0023     		movs	r3, #0
 504 0006 D360     		str	r3, [r2, #12]
 833:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     CryptoNvm->FCntList.NFCntDown = FCNT_DOWN_INITAL_VALUE;
 505              		.loc 1 833 5 is_stmt 1 view .LVU159
 506              		.loc 1 833 35 is_stmt 0 view .LVU160
 507 0008 4FF0FF31 		mov	r1, #-1
 508 000c 1161     		str	r1, [r2, #16]
 834:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     CryptoNvm->FCntList.AFCntDown = FCNT_DOWN_INITAL_VALUE;
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 25


 509              		.loc 1 834 5 is_stmt 1 view .LVU161
 510              		.loc 1 834 35 is_stmt 0 view .LVU162
 511 000e 5161     		str	r1, [r2, #20]
 835:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     CryptoNvm->FCntList.FCntDown = FCNT_DOWN_INITAL_VALUE;
 512              		.loc 1 835 5 is_stmt 1 view .LVU163
 513              		.loc 1 835 34 is_stmt 0 view .LVU164
 514 0010 9161     		str	r1, [r2, #24]
 836:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     CryptoNvm->LastDownFCnt = CryptoNvm->FCntList.FCntDown;
 515              		.loc 1 836 5 is_stmt 1 view .LVU165
 516              		.loc 1 836 29 is_stmt 0 view .LVU166
 517 0012 1162     		str	r1, [r2, #32]
 837:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 838:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     for( int32_t i = 0; i < LORAMAC_MAX_MC_CTX; i++ )
 518              		.loc 1 838 5 is_stmt 1 view .LVU167
 519              	.LBB3:
 520              		.loc 1 838 10 view .LVU168
 521              	.LVL36:
 522              	.L42:
 523              		.loc 1 838 25 discriminator 1 view .LVU169
 524              		.loc 1 838 5 is_stmt 0 discriminator 1 view .LVU170
 525 0014 002B     		cmp	r3, #0
 526 0016 00DD     		ble	.L43
 527              	.LBE3:
 839:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 840:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         CryptoNvm->FCntList.McFCntDown[i] = FCNT_DOWN_INITAL_VALUE;
 841:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 842:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 528              		.loc 1 842 1 view .LVU171
 529 0018 7047     		bx	lr
 530              	.L43:
 531              	.LBB4:
 840:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 532              		.loc 1 840 9 is_stmt 1 discriminator 3 view .LVU172
 840:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 533              		.loc 1 840 43 is_stmt 0 discriminator 3 view .LVU173
 534 001a 991D     		adds	r1, r3, #6
 535 001c 02EB8101 		add	r1, r2, r1, lsl #2
 536 0020 4FF0FF30 		mov	r0, #-1
 537 0024 4860     		str	r0, [r1, #4]
 838:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 538              		.loc 1 838 49 is_stmt 1 discriminator 3 view .LVU174
 838:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 539              		.loc 1 838 50 is_stmt 0 discriminator 3 view .LVU175
 540 0026 0133     		adds	r3, r3, #1
 541              	.LVL37:
 838:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 542              		.loc 1 838 50 discriminator 3 view .LVU176
 543 0028 F4E7     		b	.L42
 544              	.L45:
 545 002a 00BF     		.align	2
 546              	.L44:
 547 002c 00000000 		.word	.LANCHOR1
 548              	.LBE4:
 549              		.cfi_endproc
 550              	.LFE113:
 552              		.section	.text.ComputeCmacB0,"ax",%progbits
 553              		.align	1
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 26


 554              		.syntax unified
 555              		.thumb
 556              		.thumb_func
 558              	ComputeCmacB0:
 559              	.LVL38:
 560              	.LFB106:
 366:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( ( msg == 0 ) || ( cmac == 0 ) )
 561              		.loc 1 366 1 is_stmt 1 view -0
 562              		.cfi_startproc
 563              		@ args = 16, pretend = 0, frame = 16
 564              		@ frame_needed = 0, uses_anonymous_args = 0
 366:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( ( msg == 0 ) || ( cmac == 0 ) )
 565              		.loc 1 366 1 is_stmt 0 view .LVU178
 566 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 567              	.LCFI7:
 568              		.cfi_def_cfa_offset 24
 569              		.cfi_offset 4, -24
 570              		.cfi_offset 5, -20
 571              		.cfi_offset 6, -16
 572              		.cfi_offset 7, -12
 573              		.cfi_offset 8, -8
 574              		.cfi_offset 14, -4
 575 0004 88B0     		sub	sp, sp, #32
 576              	.LCFI8:
 577              		.cfi_def_cfa_offset 56
 578 0006 119E     		ldr	r6, [sp, #68]
 367:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 579              		.loc 1 367 5 is_stmt 1 view .LVU179
 367:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 580              		.loc 1 367 7 is_stmt 0 view .LVU180
 581 0008 F0B1     		cbz	r0, .L48
 582 000a 0C46     		mov	r4, r1
 583 000c 1546     		mov	r5, r2
 584 000e 1A46     		mov	r2, r3
 585              	.LVL39:
 367:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 586              		.loc 1 367 7 view .LVU181
 587 0010 8046     		mov	r8, r0
 367:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 588              		.loc 1 367 22 discriminator 1 view .LVU182
 589 0012 DEB1     		cbz	r6, .L49
 371:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 590              		.loc 1 371 5 is_stmt 1 view .LVU183
 371:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 591              		.loc 1 371 7 is_stmt 0 view .LVU184
 592 0014 B1F5807F 		cmp	r1, #256
 593 0018 1AD8     		bhi	.L50
 376:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 594              		.loc 1 376 5 is_stmt 1 view .LVU185
 379:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 595              		.loc 1 379 5 view .LVU186
 596 001a 04AF     		add	r7, sp, #16
 597 001c 0297     		str	r7, [sp, #8]
 598 001e 109B     		ldr	r3, [sp, #64]
 599              	.LVL40:
 379:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 600              		.loc 1 379 5 is_stmt 0 view .LVU187
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 27


 601 0020 0193     		str	r3, [sp, #4]
 602 0022 0F9B     		ldr	r3, [sp, #60]
 603 0024 0093     		str	r3, [sp]
 604 0026 9DF83830 		ldrb	r3, [sp, #56]	@ zero_extendqisi2
 605 002a 2946     		mov	r1, r5
 606              	.LVL41:
 379:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 607              		.loc 1 379 5 view .LVU188
 608 002c 2046     		mov	r0, r4
 609              	.LVL42:
 379:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 610              		.loc 1 379 5 view .LVU189
 611 002e FFF7FEFF 		bl	PrepareB0
 612              	.LVL43:
 381:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 613              		.loc 1 381 5 is_stmt 1 view .LVU190
 381:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 614              		.loc 1 381 9 is_stmt 0 view .LVU191
 615 0032 0096     		str	r6, [sp]
 616 0034 2B46     		mov	r3, r5
 617 0036 2246     		mov	r2, r4
 618 0038 4146     		mov	r1, r8
 619 003a 3846     		mov	r0, r7
 620 003c FFF7FEFF 		bl	SecureElementComputeAesCmac
 621              	.LVL44:
 381:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 622              		.loc 1 381 7 view .LVU192
 623 0040 40B9     		cbnz	r0, .L53
 624              	.LVL45:
 625              	.L47:
 386:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 626              		.loc 1 386 1 view .LVU193
 627 0042 08B0     		add	sp, sp, #32
 628              	.LCFI9:
 629              		.cfi_remember_state
 630              		.cfi_def_cfa_offset 24
 631              		@ sp needed
 632 0044 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 633              	.LVL46:
 634              	.L48:
 635              	.LCFI10:
 636              		.cfi_restore_state
 369:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 637              		.loc 1 369 16 view .LVU194
 638 0048 0A20     		movs	r0, #10
 639              	.LVL47:
 369:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 640              		.loc 1 369 16 view .LVU195
 641 004a FAE7     		b	.L47
 642              	.LVL48:
 643              	.L49:
 369:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 644              		.loc 1 369 16 view .LVU196
 645 004c 0A20     		movs	r0, #10
 646              	.LVL49:
 369:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 647              		.loc 1 369 16 view .LVU197
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 28


 648 004e F8E7     		b	.L47
 649              	.LVL50:
 650              	.L50:
 373:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 651              		.loc 1 373 16 view .LVU198
 652 0050 0E20     		movs	r0, #14
 653              	.LVL51:
 373:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 654              		.loc 1 373 16 view .LVU199
 655 0052 F6E7     		b	.L47
 656              	.LVL52:
 657              	.L53:
 383:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 658              		.loc 1 383 16 view .LVU200
 659 0054 0F20     		movs	r0, #15
 660 0056 F4E7     		b	.L47
 661              		.cfi_endproc
 662              	.LFE106:
 664              		.section	.text.DeriveSessionKey10x,"ax",%progbits
 665              		.align	1
 666              		.syntax unified
 667              		.thumb
 668              		.thumb_func
 670              	DeriveSessionKey10x:
 671              	.LVL53:
 672              	.LFB109:
 563:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t compBase[16] = { 0 };
 673              		.loc 1 563 1 is_stmt 1 view -0
 674              		.cfi_startproc
 675              		@ args = 0, pretend = 0, frame = 16
 676              		@ frame_needed = 0, uses_anonymous_args = 0
 563:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t compBase[16] = { 0 };
 677              		.loc 1 563 1 is_stmt 0 view .LVU202
 678 0000 10B5     		push	{r4, lr}
 679              	.LCFI11:
 680              		.cfi_def_cfa_offset 8
 681              		.cfi_offset 4, -8
 682              		.cfi_offset 14, -4
 683 0002 84B0     		sub	sp, sp, #16
 684              	.LCFI12:
 685              		.cfi_def_cfa_offset 24
 564:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 686              		.loc 1 564 5 is_stmt 1 view .LVU203
 564:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 687              		.loc 1 564 13 is_stmt 0 view .LVU204
 688 0004 0024     		movs	r4, #0
 689 0006 0094     		str	r4, [sp]
 690 0008 0194     		str	r4, [sp, #4]
 691 000a 0294     		str	r4, [sp, #8]
 692 000c 0394     		str	r4, [sp, #12]
 567:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 693              		.loc 1 567 5 is_stmt 1 view .LVU205
 694 000e 0228     		cmp	r0, #2
 695 0010 03D0     		beq	.L55
 696 0012 0328     		cmp	r0, #3
 697 0014 25D0     		beq	.L56
 698 0016 0B20     		movs	r0, #11
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 29


 699              	.LVL54:
 567:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 700              		.loc 1 567 5 is_stmt 0 view .LVU206
 701 0018 21E0     		b	.L57
 702              	.LVL55:
 703              	.L55:
 576:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 704              		.loc 1 576 13 is_stmt 1 view .LVU207
 576:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 705              		.loc 1 576 25 is_stmt 0 view .LVU208
 706 001a 0124     		movs	r4, #1
 707 001c 8DF80040 		strb	r4, [sp]
 577:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         case APP_S_KEY:
 708              		.loc 1 577 13 is_stmt 1 view .LVU209
 709              	.L58:
 586:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBase[2] = ( uint8_t )( ( joinNonce >> 8 ) & 0xFF );
 710              		.loc 1 586 5 view .LVU210
 586:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBase[2] = ( uint8_t )( ( joinNonce >> 8 ) & 0xFF );
 711              		.loc 1 586 17 is_stmt 0 view .LVU211
 712 0020 8DF80110 		strb	r1, [sp, #1]
 587:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBase[3] = ( uint8_t )( ( joinNonce >> 16 ) & 0xFF );
 713              		.loc 1 587 5 is_stmt 1 view .LVU212
 587:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBase[3] = ( uint8_t )( ( joinNonce >> 16 ) & 0xFF );
 714              		.loc 1 587 19 is_stmt 0 view .LVU213
 715 0024 C1F30724 		ubfx	r4, r1, #8, #8
 587:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBase[3] = ( uint8_t )( ( joinNonce >> 16 ) & 0xFF );
 716              		.loc 1 587 17 view .LVU214
 717 0028 8DF80240 		strb	r4, [sp, #2]
 588:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 718              		.loc 1 588 5 is_stmt 1 view .LVU215
 588:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 719              		.loc 1 588 19 is_stmt 0 view .LVU216
 720 002c C1F30741 		ubfx	r1, r1, #16, #8
 721              	.LVL56:
 588:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 722              		.loc 1 588 17 view .LVU217
 723 0030 8DF80310 		strb	r1, [sp, #3]
 590:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBase[5] = ( uint8_t )( ( netID >> 8 ) & 0xFF );
 724              		.loc 1 590 5 is_stmt 1 view .LVU218
 590:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBase[5] = ( uint8_t )( ( netID >> 8 ) & 0xFF );
 725              		.loc 1 590 17 is_stmt 0 view .LVU219
 726 0034 8DF80420 		strb	r2, [sp, #4]
 591:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBase[6] = ( uint8_t )( ( netID >> 16 ) & 0xFF );
 727              		.loc 1 591 5 is_stmt 1 view .LVU220
 591:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBase[6] = ( uint8_t )( ( netID >> 16 ) & 0xFF );
 728              		.loc 1 591 19 is_stmt 0 view .LVU221
 729 0038 C2F30721 		ubfx	r1, r2, #8, #8
 591:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBase[6] = ( uint8_t )( ( netID >> 16 ) & 0xFF );
 730              		.loc 1 591 17 view .LVU222
 731 003c 8DF80510 		strb	r1, [sp, #5]
 592:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 732              		.loc 1 592 5 is_stmt 1 view .LVU223
 592:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 733              		.loc 1 592 19 is_stmt 0 view .LVU224
 734 0040 C2F30742 		ubfx	r2, r2, #16, #8
 735              	.LVL57:
 592:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 30


 736              		.loc 1 592 17 view .LVU225
 737 0044 8DF80620 		strb	r2, [sp, #6]
 594:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBase[8] = ( uint8_t )( ( devNonce >> 8 ) & 0xFF );
 738              		.loc 1 594 5 is_stmt 1 view .LVU226
 594:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBase[8] = ( uint8_t )( ( devNonce >> 8 ) & 0xFF );
 739              		.loc 1 594 17 is_stmt 0 view .LVU227
 740 0048 8DF80730 		strb	r3, [sp, #7]
 595:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 741              		.loc 1 595 5 is_stmt 1 view .LVU228
 595:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 742              		.loc 1 595 19 is_stmt 0 view .LVU229
 743 004c 1B0A     		lsrs	r3, r3, #8
 744              	.LVL58:
 595:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 745              		.loc 1 595 17 view .LVU230
 746 004e 8DF80830 		strb	r3, [sp, #8]
 597:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 747              		.loc 1 597 5 is_stmt 1 view .LVU231
 597:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 748              		.loc 1 597 9 is_stmt 0 view .LVU232
 749 0052 0246     		mov	r2, r0
 750 0054 0121     		movs	r1, #1
 751 0056 6846     		mov	r0, sp
 752              	.LVL59:
 597:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 753              		.loc 1 597 9 view .LVU233
 754 0058 FFF7FEFF 		bl	SecureElementDeriveAndStoreKey
 755              	.LVL60:
 597:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 756              		.loc 1 597 7 view .LVU234
 757 005c 28B9     		cbnz	r0, .L61
 758              	.L57:
 603:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 759              		.loc 1 603 1 view .LVU235
 760 005e 04B0     		add	sp, sp, #16
 761              	.LCFI13:
 762              		.cfi_remember_state
 763              		.cfi_def_cfa_offset 8
 764              		@ sp needed
 765 0060 10BD     		pop	{r4, pc}
 766              	.LVL61:
 767              	.L56:
 768              	.LCFI14:
 769              		.cfi_restore_state
 579:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 770              		.loc 1 579 13 is_stmt 1 view .LVU236
 579:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 771              		.loc 1 579 25 is_stmt 0 view .LVU237
 772 0062 0224     		movs	r4, #2
 773 0064 8DF80040 		strb	r4, [sp]
 580:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         default:
 774              		.loc 1 580 13 is_stmt 1 view .LVU238
 775 0068 DAE7     		b	.L58
 776              	.LVL62:
 777              	.L61:
 599:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 778              		.loc 1 599 16 is_stmt 0 view .LVU239
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 31


 779 006a 0F20     		movs	r0, #15
 780 006c F7E7     		b	.L57
 781              		.cfi_endproc
 782              	.LFE109:
 784              		.section	.text.PayloadEncrypt,"ax",%progbits
 785              		.align	1
 786              		.syntax unified
 787              		.thumb
 788              		.thumb_func
 790              	PayloadEncrypt:
 791              	.LVL63:
 792              	.LFB104:
 159:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( buffer == 0 )
 793              		.loc 1 159 1 is_stmt 1 view -0
 794              		.cfi_startproc
 795              		@ args = 8, pretend = 0, frame = 32
 796              		@ frame_needed = 0, uses_anonymous_args = 0
 159:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( buffer == 0 )
 797              		.loc 1 159 1 is_stmt 0 view .LVU241
 798 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 799              	.LCFI15:
 800              		.cfi_def_cfa_offset 24
 801              		.cfi_offset 4, -24
 802              		.cfi_offset 5, -20
 803              		.cfi_offset 6, -16
 804              		.cfi_offset 7, -12
 805              		.cfi_offset 8, -8
 806              		.cfi_offset 14, -4
 807 0004 88B0     		sub	sp, sp, #32
 808              	.LCFI16:
 809              		.cfi_def_cfa_offset 56
 810 0006 9046     		mov	r8, r2
 811 0008 0F9A     		ldr	r2, [sp, #60]
 812              	.LVL64:
 160:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 813              		.loc 1 160 5 is_stmt 1 view .LVU242
 160:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 814              		.loc 1 160 7 is_stmt 0 view .LVU243
 815 000a 0028     		cmp	r0, #0
 816 000c 52D0     		beq	.L68
 817 000e 0D46     		mov	r5, r1
 818 0010 0446     		mov	r4, r0
 165:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint16_t ctr = 1;
 819              		.loc 1 165 5 is_stmt 1 view .LVU244
 820              	.LVL65:
 166:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t sBlock[16] = { 0 };
 821              		.loc 1 166 5 view .LVU245
 167:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t aBlock[16] = { 0 };
 822              		.loc 1 167 5 view .LVU246
 167:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t aBlock[16] = { 0 };
 823              		.loc 1 167 13 is_stmt 0 view .LVU247
 824 0012 0026     		movs	r6, #0
 825 0014 0496     		str	r6, [sp, #16]
 826 0016 0596     		str	r6, [sp, #20]
 827 0018 0696     		str	r6, [sp, #24]
 828 001a 0796     		str	r6, [sp, #28]
 168:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 32


 829              		.loc 1 168 5 is_stmt 1 view .LVU248
 168:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 830              		.loc 1 168 13 is_stmt 0 view .LVU249
 831 001c 0096     		str	r6, [sp]
 832 001e 0196     		str	r6, [sp, #4]
 833 0020 0296     		str	r6, [sp, #8]
 834 0022 0396     		str	r6, [sp, #12]
 170:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 835              		.loc 1 170 5 is_stmt 1 view .LVU250
 170:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 836              		.loc 1 170 15 is_stmt 0 view .LVU251
 837 0024 0127     		movs	r7, #1
 838 0026 8DF80070 		strb	r7, [sp]
 172:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 839              		.loc 1 172 5 is_stmt 1 view .LVU252
 172:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 840              		.loc 1 172 15 is_stmt 0 view .LVU253
 841 002a 9DF83810 		ldrb	r1, [sp, #56]	@ zero_extendqisi2
 842              	.LVL66:
 172:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 843              		.loc 1 172 15 view .LVU254
 844 002e 8DF80510 		strb	r1, [sp, #5]
 174:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[7] = ( address >> 8 ) & 0xFF;
 845              		.loc 1 174 5 is_stmt 1 view .LVU255
 174:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[7] = ( address >> 8 ) & 0xFF;
 846              		.loc 1 174 15 is_stmt 0 view .LVU256
 847 0032 8DF80630 		strb	r3, [sp, #6]
 175:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[8] = ( address >> 16 ) & 0xFF;
 848              		.loc 1 175 5 is_stmt 1 view .LVU257
 175:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[8] = ( address >> 16 ) & 0xFF;
 849              		.loc 1 175 27 is_stmt 0 view .LVU258
 850 0036 190A     		lsrs	r1, r3, #8
 175:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[8] = ( address >> 16 ) & 0xFF;
 851              		.loc 1 175 15 view .LVU259
 852 0038 8DF80710 		strb	r1, [sp, #7]
 176:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[9] = ( address >> 24 ) & 0xFF;
 853              		.loc 1 176 5 is_stmt 1 view .LVU260
 176:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[9] = ( address >> 24 ) & 0xFF;
 854              		.loc 1 176 27 is_stmt 0 view .LVU261
 855 003c 190C     		lsrs	r1, r3, #16
 176:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[9] = ( address >> 24 ) & 0xFF;
 856              		.loc 1 176 15 view .LVU262
 857 003e 8DF80810 		strb	r1, [sp, #8]
 177:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 858              		.loc 1 177 5 is_stmt 1 view .LVU263
 177:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 859              		.loc 1 177 27 is_stmt 0 view .LVU264
 860 0042 1B0E     		lsrs	r3, r3, #24
 861              	.LVL67:
 177:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 862              		.loc 1 177 15 view .LVU265
 863 0044 8DF80930 		strb	r3, [sp, #9]
 179:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[11] = ( frameCounter >> 8 ) & 0xFF;
 864              		.loc 1 179 5 is_stmt 1 view .LVU266
 179:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[11] = ( frameCounter >> 8 ) & 0xFF;
 865              		.loc 1 179 16 is_stmt 0 view .LVU267
 866 0048 8DF80A20 		strb	r2, [sp, #10]
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 33


 180:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[12] = ( frameCounter >> 16 ) & 0xFF;
 867              		.loc 1 180 5 is_stmt 1 view .LVU268
 180:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[12] = ( frameCounter >> 16 ) & 0xFF;
 868              		.loc 1 180 33 is_stmt 0 view .LVU269
 869 004c 130A     		lsrs	r3, r2, #8
 180:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[12] = ( frameCounter >> 16 ) & 0xFF;
 870              		.loc 1 180 16 view .LVU270
 871 004e 8DF80B30 		strb	r3, [sp, #11]
 181:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[13] = ( frameCounter >> 24 ) & 0xFF;
 872              		.loc 1 181 5 is_stmt 1 view .LVU271
 181:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[13] = ( frameCounter >> 24 ) & 0xFF;
 873              		.loc 1 181 33 is_stmt 0 view .LVU272
 874 0052 130C     		lsrs	r3, r2, #16
 181:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     aBlock[13] = ( frameCounter >> 24 ) & 0xFF;
 875              		.loc 1 181 16 view .LVU273
 876 0054 8DF80C30 		strb	r3, [sp, #12]
 182:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 877              		.loc 1 182 5 is_stmt 1 view .LVU274
 182:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 878              		.loc 1 182 33 is_stmt 0 view .LVU275
 879 0058 120E     		lsrs	r2, r2, #24
 182:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 880              		.loc 1 182 16 view .LVU276
 881 005a 8DF80D20 		strb	r2, [sp, #13]
 184:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 882              		.loc 1 184 5 is_stmt 1 view .LVU277
 184:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 883              		.loc 1 184 10 is_stmt 0 view .LVU278
 884 005e 14E0     		b	.L64
 885              	.LVL68:
 886              	.L66:
 887              	.LBB5:
 195:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
 888              		.loc 1 195 13 is_stmt 1 discriminator 3 view .LVU279
 195:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
 889              		.loc 1 195 58 is_stmt 0 discriminator 3 view .LVU280
 890 0060 F218     		adds	r2, r6, r3
 195:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
 891              		.loc 1 195 45 discriminator 3 view .LVU281
 892 0062 A05C     		ldrb	r0, [r4, r2]	@ zero_extendqisi2
 195:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
 893              		.loc 1 195 71 discriminator 3 view .LVU282
 894 0064 03F12001 		add	r1, r3, #32
 895 0068 6944     		add	r1, sp, r1
 896 006a 11F8101C 		ldrb	r1, [r1, #-16]	@ zero_extendqisi2
 195:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
 897              		.loc 1 195 37 discriminator 3 view .LVU283
 898 006e 4840     		eors	r0, r0, r1
 899 0070 A054     		strb	r0, [r4, r2]
 193:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
 900              		.loc 1 193 64 is_stmt 1 discriminator 3 view .LVU284
 193:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
 901              		.loc 1 193 65 is_stmt 0 discriminator 3 view .LVU285
 902 0072 0133     		adds	r3, r3, #1
 903              	.LVL69:
 193:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
 904              		.loc 1 193 65 discriminator 3 view .LVU286
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 34


 905 0074 DBB2     		uxtb	r3, r3
 906              	.LVL70:
 907              	.L65:
 193:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
 908              		.loc 1 193 29 is_stmt 1 discriminator 1 view .LVU287
 193:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
 909              		.loc 1 193 54 is_stmt 0 discriminator 1 view .LVU288
 910 0076 2A46     		mov	r2, r5
 911 0078 102D     		cmp	r5, #16
 912 007a A8BF     		it	ge
 913 007c 1022     		movge	r2, #16
 193:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
 914              		.loc 1 193 9 discriminator 1 view .LVU289
 915 007e 9342     		cmp	r3, r2
 916 0080 EEDB     		blt	.L66
 917              	.LBE5:
 197:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         bufferIndex += 16;
 918              		.loc 1 197 9 is_stmt 1 view .LVU290
 197:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         bufferIndex += 16;
 919              		.loc 1 197 14 is_stmt 0 view .LVU291
 920 0082 103D     		subs	r5, r5, #16
 921              	.LVL71:
 197:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         bufferIndex += 16;
 922              		.loc 1 197 14 view .LVU292
 923 0084 2DB2     		sxth	r5, r5
 924              	.LVL72:
 198:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 925              		.loc 1 198 9 is_stmt 1 view .LVU293
 198:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 926              		.loc 1 198 21 is_stmt 0 view .LVU294
 927 0086 1036     		adds	r6, r6, #16
 928              	.LVL73:
 198:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 929              		.loc 1 198 21 view .LVU295
 930 0088 F6B2     		uxtb	r6, r6
 931              	.LVL74:
 932              	.L64:
 184:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 933              		.loc 1 184 10 is_stmt 1 view .LVU296
 934 008a 002D     		cmp	r5, #0
 935 008c 0EDD     		ble	.L71
 186:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         ctr++;
 936              		.loc 1 186 9 view .LVU297
 186:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         ctr++;
 937              		.loc 1 186 20 is_stmt 0 view .LVU298
 938 008e 8DF80F70 		strb	r7, [sp, #15]
 187:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         if( SecureElementAesEncrypt( aBlock, 16, keyID, sBlock ) != SECURE_ELEMENT_SUCCESS )
 939              		.loc 1 187 9 is_stmt 1 view .LVU299
 187:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         if( SecureElementAesEncrypt( aBlock, 16, keyID, sBlock ) != SECURE_ELEMENT_SUCCESS )
 940              		.loc 1 187 12 is_stmt 0 view .LVU300
 941 0092 0137     		adds	r7, r7, #1
 942              	.LVL75:
 187:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         if( SecureElementAesEncrypt( aBlock, 16, keyID, sBlock ) != SECURE_ELEMENT_SUCCESS )
 943              		.loc 1 187 12 view .LVU301
 944 0094 BFB2     		uxth	r7, r7
 945              	.LVL76:
 188:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 35


 946              		.loc 1 188 9 is_stmt 1 view .LVU302
 188:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
 947              		.loc 1 188 13 is_stmt 0 view .LVU303
 948 0096 04AB     		add	r3, sp, #16
 949 0098 4246     		mov	r2, r8
 950 009a 1021     		movs	r1, #16
 951 009c 6846     		mov	r0, sp
 952 009e FFF7FEFF 		bl	SecureElementAesEncrypt
 953              	.LVL77:
 188:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
 954              		.loc 1 188 11 view .LVU304
 955 00a2 0346     		mov	r3, r0
 956 00a4 0028     		cmp	r0, #0
 957 00a6 E6D0     		beq	.L65
 190:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
 958              		.loc 1 190 20 view .LVU305
 959 00a8 0F20     		movs	r0, #15
 960 00aa 00E0     		b	.L63
 961              	.L71:
 201:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 962              		.loc 1 201 12 view .LVU306
 963 00ac 0020     		movs	r0, #0
 964              	.LVL78:
 965              	.L63:
 202:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 966              		.loc 1 202 1 view .LVU307
 967 00ae 08B0     		add	sp, sp, #32
 968              	.LCFI17:
 969              		.cfi_remember_state
 970              		.cfi_def_cfa_offset 24
 971              		@ sp needed
 972 00b0 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 973              	.LVL79:
 974              	.L68:
 975              	.LCFI18:
 976              		.cfi_restore_state
 162:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 977              		.loc 1 162 16 view .LVU308
 978 00b4 0A20     		movs	r0, #10
 979              	.LVL80:
 162:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 980              		.loc 1 162 16 view .LVU309
 981 00b6 FAE7     		b	.L63
 982              		.cfi_endproc
 983              	.LFE104:
 985              		.section	.text.VerifyCmacB0,"ax",%progbits
 986              		.align	1
 987              		.syntax unified
 988              		.thumb
 989              		.thumb_func
 991              	VerifyCmacB0:
 992              	.LVL81:
 993              	.LFB107:
 402:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( msg == 0 )
 994              		.loc 1 402 1 is_stmt 1 view -0
 995              		.cfi_startproc
 996              		@ args = 16, pretend = 0, frame = 272
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 36


 997              		@ frame_needed = 0, uses_anonymous_args = 0
 403:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 998              		.loc 1 403 5 view .LVU311
 403:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 999              		.loc 1 403 7 is_stmt 0 view .LVU312
 1000 0000 70B3     		cbz	r0, .L74
 402:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( msg == 0 )
 1001              		.loc 1 402 1 view .LVU313
 1002 0002 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 1003              	.LCFI19:
 1004              		.cfi_def_cfa_offset 24
 1005              		.cfi_offset 4, -24
 1006              		.cfi_offset 5, -20
 1007              		.cfi_offset 6, -16
 1008              		.cfi_offset 7, -12
 1009              		.cfi_offset 8, -8
 1010              		.cfi_offset 14, -4
 1011 0006 C8B0     		sub	sp, sp, #288
 1012              	.LCFI20:
 1013              		.cfi_def_cfa_offset 312
 1014 0008 0C46     		mov	r4, r1
 1015 000a 1546     		mov	r5, r2
 1016 000c 1E46     		mov	r6, r3
 1017 000e 8046     		mov	r8, r0
 407:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 1018              		.loc 1 407 5 is_stmt 1 view .LVU314
 407:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 1019              		.loc 1 407 7 is_stmt 0 view .LVU315
 1020 0010 B1F5807F 		cmp	r1, #256
 1021 0014 26D8     		bhi	.L75
 412:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     memset1( micBuff, 0, CRYPTO_BUFFER_SIZE );
 1022              		.loc 1 412 5 is_stmt 1 view .LVU316
 413:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 1023              		.loc 1 413 5 view .LVU317
 1024 0016 04AF     		add	r7, sp, #16
 1025 0018 4FF48872 		mov	r2, #272
 1026              	.LVL82:
 413:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 1027              		.loc 1 413 5 is_stmt 0 view .LVU318
 1028 001c 0021     		movs	r1, #0
 1029              	.LVL83:
 413:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 1030              		.loc 1 413 5 view .LVU319
 1031 001e 3846     		mov	r0, r7
 1032              	.LVL84:
 413:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 1033              		.loc 1 413 5 view .LVU320
 1034 0020 FFF7FEFF 		bl	memset1
 1035              	.LVL85:
 416:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 1036              		.loc 1 416 5 is_stmt 1 view .LVU321
 1037 0024 0297     		str	r7, [sp, #8]
 1038 0026 509B     		ldr	r3, [sp, #320]
 1039 0028 0193     		str	r3, [sp, #4]
 1040 002a 4F9B     		ldr	r3, [sp, #316]
 1041 002c 0093     		str	r3, [sp]
 1042 002e 9DF83831 		ldrb	r3, [sp, #312]	@ zero_extendqisi2
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 37


 1043 0032 3246     		mov	r2, r6
 1044 0034 2946     		mov	r1, r5
 1045 0036 2046     		mov	r0, r4
 1046 0038 FFF7FEFF 		bl	PrepareB0
 1047              	.LVL86:
 419:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 1048              		.loc 1 419 5 view .LVU322
 1049 003c 2246     		mov	r2, r4
 1050 003e 4146     		mov	r1, r8
 1051 0040 08A8     		add	r0, sp, #32
 1052 0042 FFF7FEFF 		bl	memcpy1
 1053              	.LVL87:
 421:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     retval = SecureElementVerifyAesCmac( micBuff, ( len + MIC_BLOCK_BX_SIZE ), expectedCmac, keyID 
 1054              		.loc 1 421 5 view .LVU323
 422:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 1055              		.loc 1 422 5 view .LVU324
 422:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 1056              		.loc 1 422 14 is_stmt 0 view .LVU325
 1057 0046 04F11001 		add	r1, r4, #16
 1058 004a 2B46     		mov	r3, r5
 1059 004c 519A     		ldr	r2, [sp, #324]
 1060 004e 89B2     		uxth	r1, r1
 1061 0050 3846     		mov	r0, r7
 1062 0052 FFF7FEFF 		bl	SecureElementVerifyAesCmac
 1063              	.LVL88:
 424:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 1064              		.loc 1 424 5 is_stmt 1 view .LVU326
 424:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 1065              		.loc 1 424 7 is_stmt 0 view .LVU327
 1066 0056 30B1     		cbz	r0, .L73
 428:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 1067              		.loc 1 428 10 is_stmt 1 view .LVU328
 428:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 1068              		.loc 1 428 12 is_stmt 0 view .LVU329
 1069 0058 0128     		cmp	r0, #1
 1070 005a 04D0     		beq	.L73
 433:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 1071              		.loc 1 433 12 view .LVU330
 1072 005c 0F20     		movs	r0, #15
 1073              	.LVL89:
 433:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 1074              		.loc 1 433 12 view .LVU331
 1075 005e 02E0     		b	.L73
 1076              	.LVL90:
 1077              	.L74:
 1078              	.LCFI21:
 1079              		.cfi_def_cfa_offset 0
 1080              		.cfi_restore 4
 1081              		.cfi_restore 5
 1082              		.cfi_restore 6
 1083              		.cfi_restore 7
 1084              		.cfi_restore 8
 1085              		.cfi_restore 14
 405:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 1086              		.loc 1 405 16 view .LVU332
 1087 0060 0A20     		movs	r0, #10
 1088              	.LVL91:
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 38


 434:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 1089              		.loc 1 434 1 view .LVU333
 1090 0062 7047     		bx	lr
 1091              	.LVL92:
 1092              	.L75:
 1093              	.LCFI22:
 1094              		.cfi_def_cfa_offset 312
 1095              		.cfi_offset 4, -24
 1096              		.cfi_offset 5, -20
 1097              		.cfi_offset 6, -16
 1098              		.cfi_offset 7, -12
 1099              		.cfi_offset 8, -8
 1100              		.cfi_offset 14, -4
 409:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 1101              		.loc 1 409 16 view .LVU334
 1102 0064 0E20     		movs	r0, #14
 1103              	.LVL93:
 1104              	.L73:
 434:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 1105              		.loc 1 434 1 view .LVU335
 1106 0066 48B0     		add	sp, sp, #288
 1107              	.LCFI23:
 1108              		.cfi_def_cfa_offset 24
 1109              		@ sp needed
 1110 0068 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 434:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 1111              		.loc 1 434 1 view .LVU336
 1112              		.cfi_endproc
 1113              	.LFE107:
 1115              		.section	.text.LoRaMacCryptoInit,"ax",%progbits
 1116              		.align	1
 1117              		.global	LoRaMacCryptoInit
 1118              		.syntax unified
 1119              		.thumb
 1120              		.thumb_func
 1122              	LoRaMacCryptoInit:
 1123              	.LVL94:
 1124              	.LFB114:
 843:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 844:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** /*
 845:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  *  API functions
 846:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****  */
 847:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** LoRaMacCryptoStatus_t LoRaMacCryptoInit( LoRaMacCryptoNvmData_t* nvm )
 848:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
 1125              		.loc 1 848 1 is_stmt 1 view -0
 1126              		.cfi_startproc
 1127              		@ args = 0, pretend = 0, frame = 0
 1128              		@ frame_needed = 0, uses_anonymous_args = 0
 849:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( nvm == NULL )
 1129              		.loc 1 849 5 view .LVU338
 1130              		.loc 1 849 7 is_stmt 0 view .LVU339
 1131 0000 88B1     		cbz	r0, .L82
 848:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( nvm == NULL )
 1132              		.loc 1 848 1 view .LVU340
 1133 0002 10B5     		push	{r4, lr}
 1134              	.LCFI24:
 1135              		.cfi_def_cfa_offset 8
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 39


 1136              		.cfi_offset 4, -8
 1137              		.cfi_offset 14, -4
 850:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 851:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_FAIL_PARAM;
 852:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 853:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 854:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Assign non volatile context
 855:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     CryptoNvm = nvm;
 1138              		.loc 1 855 5 is_stmt 1 view .LVU341
 1139              		.loc 1 855 15 is_stmt 0 view .LVU342
 1140 0004 094C     		ldr	r4, .L87
 1141 0006 2060     		str	r0, [r4]
 856:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 857:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Initialize with default
 858:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     memset1( ( uint8_t* )CryptoNvm, 0, sizeof( LoRaMacCryptoNvmData_t ) );
 1142              		.loc 1 858 5 is_stmt 1 view .LVU343
 1143 0008 2822     		movs	r2, #40
 1144 000a 0021     		movs	r1, #0
 1145 000c FFF7FEFF 		bl	memset1
 1146              	.LVL95:
 859:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 860:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Set default LoRaWAN version
 861:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     CryptoNvm->LrWanVersion.Fields.Major = 1;
 1147              		.loc 1 861 5 view .LVU344
 1148              		.loc 1 861 14 is_stmt 0 view .LVU345
 1149 0010 2368     		ldr	r3, [r4]
 1150              		.loc 1 861 42 view .LVU346
 1151 0012 0122     		movs	r2, #1
 1152 0014 DA70     		strb	r2, [r3, #3]
 862:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     CryptoNvm->LrWanVersion.Fields.Minor = 1;
 1153              		.loc 1 862 5 is_stmt 1 view .LVU347
 1154              		.loc 1 862 42 is_stmt 0 view .LVU348
 1155 0016 9A70     		strb	r2, [r3, #2]
 863:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     CryptoNvm->LrWanVersion.Fields.Patch = 1;
 1156              		.loc 1 863 5 is_stmt 1 view .LVU349
 1157              		.loc 1 863 42 is_stmt 0 view .LVU350
 1158 0018 5A70     		strb	r2, [r3, #1]
 864:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     CryptoNvm->LrWanVersion.Fields.Revision = 0;
 1159              		.loc 1 864 5 is_stmt 1 view .LVU351
 1160              		.loc 1 864 45 is_stmt 0 view .LVU352
 1161 001a 0024     		movs	r4, #0
 1162 001c 1C70     		strb	r4, [r3]
 865:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 866:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Reset frame counters
 867:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     ResetFCnts( );
 1163              		.loc 1 867 5 is_stmt 1 view .LVU353
 1164 001e FFF7FEFF 		bl	ResetFCnts
 1165              	.LVL96:
 868:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 869:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     return LORAMAC_CRYPTO_SUCCESS;
 1166              		.loc 1 869 5 view .LVU354
 1167              		.loc 1 869 12 is_stmt 0 view .LVU355
 1168 0022 2046     		mov	r0, r4
 870:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 1169              		.loc 1 870 1 view .LVU356
 1170 0024 10BD     		pop	{r4, pc}
 1171              	.LVL97:
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 40


 1172              	.L82:
 1173              	.LCFI25:
 1174              		.cfi_def_cfa_offset 0
 1175              		.cfi_restore 4
 1176              		.cfi_restore 14
 851:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 1177              		.loc 1 851 16 view .LVU357
 1178 0026 0920     		movs	r0, #9
 1179              	.LVL98:
 1180              		.loc 1 870 1 view .LVU358
 1181 0028 7047     		bx	lr
 1182              	.L88:
 1183 002a 00BF     		.align	2
 1184              	.L87:
 1185 002c 00000000 		.word	.LANCHOR1
 1186              		.cfi_endproc
 1187              	.LFE114:
 1189              		.section	.text.LoRaMacCryptoSetLrWanVersion,"ax",%progbits
 1190              		.align	1
 1191              		.global	LoRaMacCryptoSetLrWanVersion
 1192              		.syntax unified
 1193              		.thumb
 1194              		.thumb_func
 1196              	LoRaMacCryptoSetLrWanVersion:
 1197              	.LVL99:
 1198              	.LFB115:
 871:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 872:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** LoRaMacCryptoStatus_t LoRaMacCryptoSetLrWanVersion( Version_t version )
 873:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
 1199              		.loc 1 873 1 is_stmt 1 view -0
 1200              		.cfi_startproc
 1201              		@ args = 0, pretend = 0, frame = 0
 1202              		@ frame_needed = 0, uses_anonymous_args = 0
 1203              		@ link register save eliminated.
 874:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     CryptoNvm->LrWanVersion = version;
 1204              		.loc 1 874 5 view .LVU360
 1205              		.loc 1 874 14 is_stmt 0 view .LVU361
 1206 0000 024B     		ldr	r3, .L90
 1207 0002 1B68     		ldr	r3, [r3]
 1208              		.loc 1 874 29 view .LVU362
 1209 0004 1860     		str	r0, [r3]
 875:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     return LORAMAC_CRYPTO_SUCCESS;
 1210              		.loc 1 875 5 is_stmt 1 view .LVU363
 876:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 1211              		.loc 1 876 1 is_stmt 0 view .LVU364
 1212 0006 0020     		movs	r0, #0
 1213              	.LVL100:
 1214              		.loc 1 876 1 view .LVU365
 1215 0008 7047     		bx	lr
 1216              	.L91:
 1217 000a 00BF     		.align	2
 1218              	.L90:
 1219 000c 00000000 		.word	.LANCHOR1
 1220              		.cfi_endproc
 1221              	.LFE115:
 1223              		.section	.text.LoRaMacCryptoGetFCntUp,"ax",%progbits
 1224              		.align	1
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 41


 1225              		.global	LoRaMacCryptoGetFCntUp
 1226              		.syntax unified
 1227              		.thumb
 1228              		.thumb_func
 1230              	LoRaMacCryptoGetFCntUp:
 1231              	.LVL101:
 1232              	.LFB116:
 877:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 878:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** LoRaMacCryptoStatus_t LoRaMacCryptoGetFCntUp( uint32_t* currentUp )
 879:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
 1233              		.loc 1 879 1 is_stmt 1 view -0
 1234              		.cfi_startproc
 1235              		@ args = 0, pretend = 0, frame = 0
 1236              		@ frame_needed = 0, uses_anonymous_args = 0
 1237              		@ link register save eliminated.
 880:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( currentUp == NULL )
 1238              		.loc 1 880 5 view .LVU367
 1239              		.loc 1 880 7 is_stmt 0 view .LVU368
 1240 0000 30B1     		cbz	r0, .L94
 881:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 882:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_NPE;
 883:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 884:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 885:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     *currentUp = CryptoNvm->FCntList.FCntUp + 1;
 1241              		.loc 1 885 5 is_stmt 1 view .LVU369
 1242              		.loc 1 885 27 is_stmt 0 view .LVU370
 1243 0002 044B     		ldr	r3, .L95
 1244 0004 1B68     		ldr	r3, [r3]
 1245              		.loc 1 885 37 view .LVU371
 1246 0006 DB68     		ldr	r3, [r3, #12]
 1247              		.loc 1 885 45 view .LVU372
 1248 0008 0133     		adds	r3, r3, #1
 1249              		.loc 1 885 16 view .LVU373
 1250 000a 0360     		str	r3, [r0]
 886:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 887:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     return LORAMAC_CRYPTO_SUCCESS;
 1251              		.loc 1 887 5 is_stmt 1 view .LVU374
 1252              		.loc 1 887 12 is_stmt 0 view .LVU375
 1253 000c 0020     		movs	r0, #0
 1254              	.LVL102:
 1255              		.loc 1 887 12 view .LVU376
 1256 000e 7047     		bx	lr
 1257              	.LVL103:
 1258              	.L94:
 882:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 1259              		.loc 1 882 16 view .LVU377
 1260 0010 0A20     		movs	r0, #10
 1261              	.LVL104:
 888:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 1262              		.loc 1 888 1 view .LVU378
 1263 0012 7047     		bx	lr
 1264              	.L96:
 1265              		.align	2
 1266              	.L95:
 1267 0014 00000000 		.word	.LANCHOR1
 1268              		.cfi_endproc
 1269              	.LFE116:
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 42


 1271              		.section	.text.LoRaMacCryptoGetFCntDown,"ax",%progbits
 1272              		.align	1
 1273              		.global	LoRaMacCryptoGetFCntDown
 1274              		.syntax unified
 1275              		.thumb
 1276              		.thumb_func
 1278              	LoRaMacCryptoGetFCntDown:
 1279              	.LVL105:
 1280              	.LFB117:
 889:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 890:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** LoRaMacCryptoStatus_t LoRaMacCryptoGetFCntDown( FCntIdentifier_t fCntID, uint16_t maxFCntGap, uint3
 891:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
 1281              		.loc 1 891 1 is_stmt 1 view -0
 1282              		.cfi_startproc
 1283              		@ args = 0, pretend = 0, frame = 8
 1284              		@ frame_needed = 0, uses_anonymous_args = 0
 1285              		.loc 1 891 1 is_stmt 0 view .LVU380
 1286 0000 70B5     		push	{r4, r5, r6, lr}
 1287              	.LCFI26:
 1288              		.cfi_def_cfa_offset 16
 1289              		.cfi_offset 4, -16
 1290              		.cfi_offset 5, -12
 1291              		.cfi_offset 6, -8
 1292              		.cfi_offset 14, -4
 1293 0002 82B0     		sub	sp, sp, #8
 1294              	.LCFI27:
 1295              		.cfi_def_cfa_offset 24
 1296 0004 1446     		mov	r4, r2
 892:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint32_t lastDown = 0;
 1297              		.loc 1 892 5 is_stmt 1 view .LVU381
 1298              		.loc 1 892 14 is_stmt 0 view .LVU382
 1299 0006 0022     		movs	r2, #0
 1300              	.LVL106:
 1301              		.loc 1 892 14 view .LVU383
 1302 0008 0192     		str	r2, [sp, #4]
 893:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     int32_t fCntDiff = 0;
 1303              		.loc 1 893 5 is_stmt 1 view .LVU384
 1304              	.LVL107:
 894:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     LoRaMacCryptoStatus_t cryptoStatus = LORAMAC_CRYPTO_ERROR;
 1305              		.loc 1 894 5 view .LVU385
 895:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 896:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( currentDown == NULL )
 1306              		.loc 1 896 5 view .LVU386
 1307              		.loc 1 896 7 is_stmt 0 view .LVU387
 1308 000a 63B3     		cbz	r3, .L103
 1309 000c 0D46     		mov	r5, r1
 1310 000e 1E46     		mov	r6, r3
 897:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 898:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_NPE;
 899:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 900:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 901:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     cryptoStatus = GetLastFcntDown( fCntID, &lastDown );
 1311              		.loc 1 901 5 is_stmt 1 view .LVU388
 1312              		.loc 1 901 20 is_stmt 0 view .LVU389
 1313 0010 01A9     		add	r1, sp, #4
 1314              	.LVL108:
 1315              		.loc 1 901 20 view .LVU390
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 43


 1316 0012 FFF7FEFF 		bl	GetLastFcntDown
 1317              	.LVL109:
 902:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( cryptoStatus != LORAMAC_CRYPTO_SUCCESS )
 1318              		.loc 1 902 5 is_stmt 1 view .LVU391
 1319              		.loc 1 902 7 is_stmt 0 view .LVU392
 1320 0016 B8B9     		cbnz	r0, .L98
 903:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 904:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return cryptoStatus;
 905:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 906:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 907:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // For LoRaWAN 1.0.X only, allow downlink frames of 0
 908:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( lastDown == FCNT_DOWN_INITAL_VALUE )
 1321              		.loc 1 908 5 is_stmt 1 view .LVU393
 1322              		.loc 1 908 18 is_stmt 0 view .LVU394
 1323 0018 019B     		ldr	r3, [sp, #4]
 1324              		.loc 1 908 7 view .LVU395
 1325 001a B3F1FF3F 		cmp	r3, #-1
 1326 001e 15D0     		beq	.L106
 909:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 910:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         *currentDown = frameFcnt;
 911:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 912:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     else
 913:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 914:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         // Add difference, consider roll-over
 915:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         fCntDiff = ( int32_t )( ( int64_t )frameFcnt - ( int64_t )( lastDown & 0x0000FFFF ) );
 1327              		.loc 1 915 9 is_stmt 1 view .LVU396
 1328              		.loc 1 915 56 is_stmt 0 view .LVU397
 1329 0020 9AB2     		uxth	r2, r3
 1330              		.loc 1 915 54 view .LVU398
 1331 0022 A21A     		subs	r2, r4, r2
 1332              	.LVL110:
 916:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 917:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         if( fCntDiff > 0 )
 1333              		.loc 1 917 9 is_stmt 1 view .LVU399
 1334              		.loc 1 917 11 is_stmt 0 view .LVU400
 1335 0024 002A     		cmp	r2, #0
 1336 0026 13DD     		ble	.L101
 918:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {  // Positive difference
 919:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             *currentDown = lastDown + fCntDiff;
 1337              		.loc 1 919 13 is_stmt 1 view .LVU401
 1338              		.loc 1 919 37 is_stmt 0 view .LVU402
 1339 0028 1344     		add	r3, r3, r2
 1340              		.loc 1 919 26 view .LVU403
 1341 002a 3360     		str	r3, [r6]
 1342              	.LVL111:
 1343              	.L100:
 920:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
 921:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         else if( fCntDiff == 0 )
 922:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {  // Duplicate FCnt value, keep the current value.
 923:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             *currentDown = lastDown;
 924:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             return LORAMAC_CRYPTO_FAIL_FCNT_DUPLICATED;
 925:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
 926:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         else
 927:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {  // Negative difference, assume a roll-over of one uint16_t
 928:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             *currentDown = ( lastDown & 0xFFFF0000 ) + 0x10000 + frameFcnt;
 929:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
 930:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 44


 931:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 932:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // For LoRaWAN 1.0.X only, check maxFCntGap
 933:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( CryptoNvm->LrWanVersion.Fields.Minor == 0 )
 1344              		.loc 1 933 5 is_stmt 1 view .LVU404
 1345              		.loc 1 933 18 is_stmt 0 view .LVU405
 1346 002c 104B     		ldr	r3, .L108
 1347 002e 1B68     		ldr	r3, [r3]
 1348              		.loc 1 933 39 view .LVU406
 1349 0030 9A78     		ldrb	r2, [r3, #2]	@ zero_extendqisi2
 1350              		.loc 1 933 7 view .LVU407
 1351 0032 4AB9     		cbnz	r2, .L98
 934:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 935:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         if( ( ( int64_t )*currentDown - ( int64_t )lastDown ) >= maxFCntGap )
 1352              		.loc 1 935 9 is_stmt 1 view .LVU408
 1353              		.loc 1 935 26 is_stmt 0 view .LVU409
 1354 0034 3368     		ldr	r3, [r6]
 1355              		.loc 1 935 41 view .LVU410
 1356 0036 0199     		ldr	r1, [sp, #4]
 1357              		.loc 1 935 39 view .LVU411
 1358 0038 5B1A     		subs	r3, r3, r1
 1359 003a 61EB0101 		sbc	r1, r1, r1
 1360              		.loc 1 935 11 view .LVU412
 1361 003e AB42     		cmp	r3, r5
 1362 0040 71F10003 		sbcs	r3, r1, #0
 1363 0044 11DA     		bge	.L104
 936:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
 937:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             return LORAMAC_CRYPTO_FAIL_MAX_GAP_FCNT;
 938:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
 939:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 940:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 941:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     return LORAMAC_CRYPTO_SUCCESS;
 1364              		.loc 1 941 12 view .LVU413
 1365 0046 1046     		mov	r0, r2
 1366              	.LVL112:
 1367              	.L98:
 942:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 1368              		.loc 1 942 1 view .LVU414
 1369 0048 02B0     		add	sp, sp, #8
 1370              	.LCFI28:
 1371              		.cfi_remember_state
 1372              		.cfi_def_cfa_offset 16
 1373              		@ sp needed
 1374 004a 70BD     		pop	{r4, r5, r6, pc}
 1375              	.LVL113:
 1376              	.L106:
 1377              	.LCFI29:
 1378              		.cfi_restore_state
 910:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 1379              		.loc 1 910 9 is_stmt 1 view .LVU415
 910:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 1380              		.loc 1 910 22 is_stmt 0 view .LVU416
 1381 004c 3460     		str	r4, [r6]
 1382 004e EDE7     		b	.L100
 1383              	.LVL114:
 1384              	.L101:
 921:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {  // Duplicate FCnt value, keep the current value.
 1385              		.loc 1 921 14 is_stmt 1 view .LVU417
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 45


 921:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {  // Duplicate FCnt value, keep the current value.
 1386              		.loc 1 921 16 is_stmt 0 view .LVU418
 1387 0050 32B1     		cbz	r2, .L107
 928:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
 1388              		.loc 1 928 13 is_stmt 1 view .LVU419
 928:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
 1389              		.loc 1 928 39 is_stmt 0 view .LVU420
 1390 0052 1B0C     		lsrs	r3, r3, #16
 1391 0054 1B04     		lsls	r3, r3, #16
 928:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
 1392              		.loc 1 928 64 view .LVU421
 1393 0056 2344     		add	r3, r3, r4
 1394 0058 03F58033 		add	r3, r3, #65536
 928:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
 1395              		.loc 1 928 26 view .LVU422
 1396 005c 3360     		str	r3, [r6]
 1397 005e E5E7     		b	.L100
 1398              	.L107:
 923:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             return LORAMAC_CRYPTO_FAIL_FCNT_DUPLICATED;
 1399              		.loc 1 923 13 is_stmt 1 view .LVU423
 923:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             return LORAMAC_CRYPTO_FAIL_FCNT_DUPLICATED;
 1400              		.loc 1 923 26 is_stmt 0 view .LVU424
 1401 0060 3360     		str	r3, [r6]
 924:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
 1402              		.loc 1 924 13 is_stmt 1 view .LVU425
 924:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
 1403              		.loc 1 924 20 is_stmt 0 view .LVU426
 1404 0062 0720     		movs	r0, #7
 1405              	.LVL115:
 924:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
 1406              		.loc 1 924 20 view .LVU427
 1407 0064 F0E7     		b	.L98
 1408              	.LVL116:
 1409              	.L103:
 898:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 1410              		.loc 1 898 16 view .LVU428
 1411 0066 0A20     		movs	r0, #10
 1412              	.LVL117:
 898:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 1413              		.loc 1 898 16 view .LVU429
 1414 0068 EEE7     		b	.L98
 1415              	.LVL118:
 1416              	.L104:
 937:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
 1417              		.loc 1 937 20 view .LVU430
 1418 006a 0820     		movs	r0, #8
 1419              	.LVL119:
 937:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
 1420              		.loc 1 937 20 view .LVU431
 1421 006c ECE7     		b	.L98
 1422              	.L109:
 1423 006e 00BF     		.align	2
 1424              	.L108:
 1425 0070 00000000 		.word	.LANCHOR1
 1426              		.cfi_endproc
 1427              	.LFE117:
 1429              		.section	.text.LoRaMacCryptoSetMulticastReference,"ax",%progbits
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 46


 1430              		.align	1
 1431              		.global	LoRaMacCryptoSetMulticastReference
 1432              		.syntax unified
 1433              		.thumb
 1434              		.thumb_func
 1436              	LoRaMacCryptoSetMulticastReference:
 1437              	.LVL120:
 1438              	.LFB118:
 943:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 944:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if( USE_LRWAN_1_1_X_CRYPTO == 1 )
 945:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** LoRaMacCryptoStatus_t LoRaMacCryptoGetRJcount( FCntIdentifier_t fCntID, uint16_t* rJcount )
 946:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
 947:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( rJcount == 0 )
 948:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 949:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_NPE;
 950:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 951:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     switch( fCntID )
 952:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 953:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         case RJ_COUNT_0:
 954:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             *rJcount = RJcount0 + 1;
 955:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 956:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         case RJ_COUNT_1:
 957:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             *rJcount = CryptoNvm->FCntList.RJcount1 + 1;
 958:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             break;
 959:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         default:
 960:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             return LORAMAC_CRYPTO_FAIL_FCNT_ID;
 961:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 962:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     return LORAMAC_CRYPTO_SUCCESS;
 963:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 964:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* USE_LRWAN_1_1_X_CRYPTO == 1 */
 965:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 966:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** LoRaMacCryptoStatus_t LoRaMacCryptoSetMulticastReference( MulticastCtx_t* multicastList )
 967:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
 1439              		.loc 1 967 1 is_stmt 1 view -0
 1440              		.cfi_startproc
 1441              		@ args = 0, pretend = 0, frame = 0
 1442              		@ frame_needed = 0, uses_anonymous_args = 0
 1443              		@ link register save eliminated.
 968:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( multicastList == NULL )
 1444              		.loc 1 968 5 view .LVU433
 1445              		.loc 1 968 7 is_stmt 0 view .LVU434
 1446 0000 0146     		mov	r1, r0
 1447 0002 08B9     		cbnz	r0, .L115
 969:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 970:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_NPE;
 1448              		.loc 1 970 16 view .LVU435
 1449 0004 0A20     		movs	r0, #10
 1450              	.LVL121:
 971:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 972:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 973:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     for( int32_t i = 0; i < LORAMAC_MAX_MC_CTX; i++ )
 974:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 975:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         multicastList[i].DownLinkCounter = &CryptoNvm->FCntList.McFCntDown[i];
 976:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 977:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 978:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     return LORAMAC_CRYPTO_SUCCESS;
 979:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 47


 1451              		.loc 1 979 1 view .LVU436
 1452 0006 7047     		bx	lr
 1453              	.LVL122:
 1454              	.L115:
 1455              	.LBB6:
 973:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 1456              		.loc 1 973 18 view .LVU437
 1457 0008 0023     		movs	r3, #0
 1458              	.LVL123:
 1459              	.L112:
 973:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 1460              		.loc 1 973 25 is_stmt 1 discriminator 1 view .LVU438
 973:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 1461              		.loc 1 973 5 is_stmt 0 discriminator 1 view .LVU439
 1462 000a 002B     		cmp	r3, #0
 1463 000c 01DD     		ble	.L113
 1464              	.LBE6:
 978:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 1465              		.loc 1 978 12 view .LVU440
 1466 000e 0020     		movs	r0, #0
 1467              	.LBB7:
 1468 0010 7047     		bx	lr
 1469              	.L113:
 975:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 1470              		.loc 1 975 9 is_stmt 1 discriminator 3 view .LVU441
 975:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 1471              		.loc 1 975 54 is_stmt 0 discriminator 3 view .LVU442
 1472 0012 064A     		ldr	r2, .L116
 1473 0014 1268     		ldr	r2, [r2]
 975:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 1474              		.loc 1 975 22 discriminator 3 view .LVU443
 1475 0016 2C20     		movs	r0, #44
 1476 0018 00FB0310 		mla	r0, r0, r3, r1
 975:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 1477              		.loc 1 975 44 discriminator 3 view .LVU444
 1478 001c 03F1060C 		add	ip, r3, #6
 1479 0020 02EB8C02 		add	r2, r2, ip, lsl #2
 1480 0024 0432     		adds	r2, r2, #4
 975:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 1481              		.loc 1 975 42 discriminator 3 view .LVU445
 1482 0026 0262     		str	r2, [r0, #32]
 973:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 1483              		.loc 1 973 49 is_stmt 1 discriminator 3 view .LVU446
 973:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 1484              		.loc 1 973 50 is_stmt 0 discriminator 3 view .LVU447
 1485 0028 0133     		adds	r3, r3, #1
 1486              	.LVL124:
 973:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 1487              		.loc 1 973 50 discriminator 3 view .LVU448
 1488 002a EEE7     		b	.L112
 1489              	.L117:
 1490              		.align	2
 1491              	.L116:
 1492 002c 00000000 		.word	.LANCHOR1
 1493              	.LBE7:
 1494              		.cfi_endproc
 1495              	.LFE118:
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 48


 1497              		.section	.text.LoRaMacCryptoPrepareJoinRequest,"ax",%progbits
 1498              		.align	1
 1499              		.global	LoRaMacCryptoPrepareJoinRequest
 1500              		.syntax unified
 1501              		.thumb
 1502              		.thumb_func
 1504              	LoRaMacCryptoPrepareJoinRequest:
 1505              	.LVL125:
 1506              	.LFB120:
 980:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 981:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** LoRaMacCryptoStatus_t LoRaMacCryptoSetKey( KeyIdentifier_t keyID, uint8_t* key )
 982:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
 983:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( SecureElementSetKey( keyID, key ) != SECURE_ELEMENT_SUCCESS )
 984:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 985:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_SECURE_ELEMENT_FUNC;
 986:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 987:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( keyID == APP_KEY )
 988:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 989:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         // Derive lifetime keys
 990:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         if( LoRaMacCryptoDeriveMcRootKey( CryptoNvm->LrWanVersion.Fields.Minor, keyID ) != LORAMAC_
 991:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
 992:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             return LORAMAC_CRYPTO_ERROR_SECURE_ELEMENT_FUNC;
 993:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
 994:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         if( LoRaMacCryptoDeriveMcKEKey( MC_ROOT_KEY ) != LORAMAC_CRYPTO_SUCCESS )
 995:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
 996:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             return LORAMAC_CRYPTO_ERROR_SECURE_ELEMENT_FUNC;
 997:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
 998:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 999:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     return LORAMAC_CRYPTO_SUCCESS;
1000:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
1001:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1002:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** LoRaMacCryptoStatus_t LoRaMacCryptoPrepareJoinRequest( LoRaMacMessageJoinRequest_t* macMsg )
1003:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
 1507              		.loc 1 1003 1 is_stmt 1 view -0
 1508              		.cfi_startproc
 1509              		@ args = 0, pretend = 0, frame = 8
 1510              		@ frame_needed = 0, uses_anonymous_args = 0
1004:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( macMsg == 0 )
 1511              		.loc 1 1004 5 view .LVU450
 1512              		.loc 1 1004 7 is_stmt 0 view .LVU451
 1513 0000 00B3     		cbz	r0, .L120
1003:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( macMsg == 0 )
 1514              		.loc 1 1003 1 view .LVU452
 1515 0002 10B5     		push	{r4, lr}
 1516              	.LCFI30:
 1517              		.cfi_def_cfa_offset 8
 1518              		.cfi_offset 4, -8
 1519              		.cfi_offset 14, -4
 1520 0004 84B0     		sub	sp, sp, #16
 1521              	.LCFI31:
 1522              		.cfi_def_cfa_offset 24
 1523 0006 0446     		mov	r4, r0
1005:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1006:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_NPE;
1007:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1008:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     KeyIdentifier_t micComputationKeyID = NWK_KEY;
 1524              		.loc 1 1008 5 is_stmt 1 view .LVU453
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 49


 1525              	.LVL126:
1009:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1010:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Add device nonce
1011:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if ( USE_RANDOM_DEV_NONCE == 1 )
1012:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint32_t devNonce = 0;
 1526              		.loc 1 1012 5 view .LVU454
 1527              		.loc 1 1012 14 is_stmt 0 view .LVU455
 1528 0008 0023     		movs	r3, #0
 1529 000a 0393     		str	r3, [sp, #12]
1013:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     SecureElementRandomNumber( &devNonce );
 1530              		.loc 1 1013 5 is_stmt 1 view .LVU456
 1531 000c 03A8     		add	r0, sp, #12
 1532              	.LVL127:
 1533              		.loc 1 1013 5 is_stmt 0 view .LVU457
 1534 000e FFF7FEFF 		bl	SecureElementRandomNumber
 1535              	.LVL128:
1014:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     CryptoNvm->DevNonce = devNonce;
 1536              		.loc 1 1014 5 is_stmt 1 view .LVU458
 1537              		.loc 1 1014 14 is_stmt 0 view .LVU459
 1538 0012 104B     		ldr	r3, .L128
 1539 0014 1A68     		ldr	r2, [r3]
 1540              		.loc 1 1014 25 view .LVU460
 1541 0016 BDF80C30 		ldrh	r3, [sp, #12]
 1542 001a 9380     		strh	r3, [r2, #4]	@ movhi
1015:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #else
1016:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     CryptoNvm->DevNonce++;
1017:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* USE_RANDOM_DEV_NONCE */
1018:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     macMsg->DevNonce = CryptoNvm->DevNonce;
 1543              		.loc 1 1018 5 is_stmt 1 view .LVU461
 1544              		.loc 1 1018 22 is_stmt 0 view .LVU462
 1545 001c E382     		strh	r3, [r4, #22]	@ movhi
1019:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1020:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if( USE_LRWAN_1_1_X_CRYPTO == 1 )
1021:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Derive lifetime session keys
1022:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( DeriveLifeTimeSessionKey( J_S_INT_KEY, macMsg->DevEUI ) != LORAMAC_CRYPTO_SUCCESS )
1023:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1024:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR;
1025:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1026:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( DeriveLifeTimeSessionKey( J_S_ENC_KEY, macMsg->DevEUI ) != LORAMAC_CRYPTO_SUCCESS )
1027:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1028:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR;
1029:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1030:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* USE_LRWAN_1_1_X_CRYPTO == 1 */
1031:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1032:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Serialize message
1033:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( LoRaMacSerializerJoinRequest( macMsg ) != LORAMAC_SERIALIZER_SUCCESS )
 1546              		.loc 1 1033 5 is_stmt 1 view .LVU463
 1547              		.loc 1 1033 9 is_stmt 0 view .LVU464
 1548 001e 2046     		mov	r0, r4
 1549 0020 FFF7FEFF 		bl	LoRaMacSerializerJoinRequest
 1550              	.LVL129:
 1551              		.loc 1 1033 7 view .LVU465
 1552 0024 80B9     		cbnz	r0, .L121
1034:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1035:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_SERIALIZER;
1036:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1037:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 50


1038:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Compute mic
1039:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( SecureElementComputeAesCmac( NULL, macMsg->Buffer, ( LORAMAC_JOIN_REQ_MSG_SIZE - LORAMAC_MI
 1553              		.loc 1 1039 5 is_stmt 1 view .LVU466
 1554              		.loc 1 1039 9 is_stmt 0 view .LVU467
 1555 0026 2346     		mov	r3, r4
 1556 0028 53F8181B 		ldr	r1, [r3], #24
 1557 002c 0093     		str	r3, [sp]
 1558 002e 0123     		movs	r3, #1
 1559 0030 1322     		movs	r2, #19
 1560 0032 FFF7FEFF 		bl	SecureElementComputeAesCmac
 1561              	.LVL130:
 1562              		.loc 1 1039 7 view .LVU468
 1563 0036 50B9     		cbnz	r0, .L122
1040:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1041:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_SECURE_ELEMENT_FUNC;
1042:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1043:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1044:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Reserialize message to add the MIC
1045:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( LoRaMacSerializerJoinRequest( macMsg ) != LORAMAC_SERIALIZER_SUCCESS )
 1564              		.loc 1 1045 5 is_stmt 1 view .LVU469
 1565              		.loc 1 1045 9 is_stmt 0 view .LVU470
 1566 0038 2046     		mov	r0, r4
 1567 003a FFF7FEFF 		bl	LoRaMacSerializerJoinRequest
 1568              	.LVL131:
 1569              		.loc 1 1045 7 view .LVU471
 1570 003e 20B1     		cbz	r0, .L119
1046:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1047:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_SERIALIZER;
 1571              		.loc 1 1047 16 view .LVU472
 1572 0040 1120     		movs	r0, #17
 1573 0042 02E0     		b	.L119
 1574              	.LVL132:
 1575              	.L120:
 1576              	.LCFI32:
 1577              		.cfi_def_cfa_offset 0
 1578              		.cfi_restore 4
 1579              		.cfi_restore 14
1006:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 1580              		.loc 1 1006 16 view .LVU473
 1581 0044 0A20     		movs	r0, #10
 1582              	.LVL133:
1048:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1049:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1050:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     return LORAMAC_CRYPTO_SUCCESS;
1051:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 1583              		.loc 1 1051 1 view .LVU474
 1584 0046 7047     		bx	lr
 1585              	.LVL134:
 1586              	.L121:
 1587              	.LCFI33:
 1588              		.cfi_def_cfa_offset 24
 1589              		.cfi_offset 4, -8
 1590              		.cfi_offset 14, -4
1035:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 1591              		.loc 1 1035 16 view .LVU475
 1592 0048 1120     		movs	r0, #17
 1593              	.L119:
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 51


 1594              		.loc 1 1051 1 view .LVU476
 1595 004a 04B0     		add	sp, sp, #16
 1596              	.LCFI34:
 1597              		.cfi_remember_state
 1598              		.cfi_def_cfa_offset 8
 1599              		@ sp needed
 1600 004c 10BD     		pop	{r4, pc}
 1601              	.LVL135:
 1602              	.L122:
 1603              	.LCFI35:
 1604              		.cfi_restore_state
1041:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 1605              		.loc 1 1041 16 view .LVU477
 1606 004e 0F20     		movs	r0, #15
 1607 0050 FBE7     		b	.L119
 1608              	.L129:
 1609 0052 00BF     		.align	2
 1610              	.L128:
 1611 0054 00000000 		.word	.LANCHOR1
 1612              		.cfi_endproc
 1613              	.LFE120:
 1615              		.section	.text.LoRaMacCryptoSecureMessage,"ax",%progbits
 1616              		.align	1
 1617              		.global	LoRaMacCryptoSecureMessage
 1618              		.syntax unified
 1619              		.thumb
 1620              		.thumb_func
 1622              	LoRaMacCryptoSecureMessage:
 1623              	.LVL136:
 1624              	.LFB122:
1052:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1053:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if( USE_LRWAN_1_1_X_CRYPTO == 1 )
1054:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** LoRaMacCryptoStatus_t LoRaMacCryptoPrepareReJoinType1( LoRaMacMessageReJoinType1_t* macMsg )
1055:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
1056:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( macMsg == 0 )
1057:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1058:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_NPE;
1059:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1060:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1061:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Check for RJcount1 overflow
1062:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( CryptoNvm->FCntList.RJcount1 == 65535 )
1063:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1064:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_RJCOUNT1_OVERFLOW;
1065:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1066:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1067:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Serialize message
1068:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( LoRaMacSerializerReJoinType1( macMsg ) != LORAMAC_SERIALIZER_SUCCESS )
1069:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1070:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_SERIALIZER;
1071:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1072:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1073:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Compute mic
1074:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // cmac = aes128_cmac(JSIntKey, MHDR | RejoinType | JoinEUI| DevEUI | RJcount1)
1075:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( SecureElementComputeAesCmac( NULL, macMsg->Buffer, ( LORAMAC_RE_JOIN_1_MSG_SIZE - LORAMAC_M
1076:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1077:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_SECURE_ELEMENT_FUNC;
1078:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 52


1079:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1080:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Reserialize message to add the MIC
1081:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( LoRaMacSerializerReJoinType1( macMsg ) != LORAMAC_SERIALIZER_SUCCESS )
1082:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1083:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_SERIALIZER;
1084:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1085:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1086:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Increment RJcount1
1087:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     CryptoNvm->FCntList.RJcount1++;
1088:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1089:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     return LORAMAC_CRYPTO_SUCCESS;
1090:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
1091:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1092:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** LoRaMacCryptoStatus_t LoRaMacCryptoPrepareReJoinType0or2( LoRaMacMessageReJoinType0or2_t* macMsg )
1093:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
1094:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( macMsg == 0 )
1095:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1096:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_NPE;
1097:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1098:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1099:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Check for RJcount0 overflow
1100:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( RJcount0 == 65535 )
1101:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1102:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_FAIL_RJCOUNT0_OVERFLOW;
1103:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1104:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1105:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Serialize message
1106:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( LoRaMacSerializerReJoinType0or2( macMsg ) != LORAMAC_SERIALIZER_SUCCESS )
1107:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1108:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_SERIALIZER;
1109:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1110:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1111:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Compute mic
1112:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // cmac = aes128_cmac(SNwkSIntKey, MHDR | Rejoin Type | NetID | DevEUI | RJcount0)
1113:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( SecureElementComputeAesCmac( NULL, macMsg->Buffer, ( LORAMAC_RE_JOIN_0_2_MSG_SIZE - LORAMAC
1114:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1115:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_SECURE_ELEMENT_FUNC;
1116:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1117:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1118:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Re-serialize message to add the MIC
1119:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( LoRaMacSerializerReJoinType0or2( macMsg ) != LORAMAC_SERIALIZER_SUCCESS )
1120:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1121:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_SERIALIZER;
1122:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1123:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1124:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Increment RJcount0
1125:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     RJcount0++;
1126:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1127:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     return LORAMAC_CRYPTO_SUCCESS;
1128:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
1129:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* USE_LRWAN_1_1_X_CRYPTO == 1 */
1130:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1131:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** LoRaMacCryptoStatus_t LoRaMacCryptoHandleJoinAccept( JoinReqIdentifier_t joinReqType, uint8_t* join
1132:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
1133:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( ( macMsg == 0 ) || ( joinEUI == 0 ) )
1134:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1135:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_NPE;
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 53


1136:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1137:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1138:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     LoRaMacCryptoStatus_t retval = LORAMAC_CRYPTO_ERROR;
1139:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t decJoinAccept[LORAMAC_JOIN_ACCEPT_FRAME_MAX_SIZE] = { 0 };
1140:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t versionMinor         = 0;
1141:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint16_t nonce               = CryptoNvm->DevNonce;
1142:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1143:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Nonce selection depending on JoinReqType
1144:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // JOIN_REQ     : CryptoNvm->DevNonce
1145:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // REJOIN_REQ_0 : RJcount0
1146:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // REJOIN_REQ_1 : CryptoCtx.RJcount1
1147:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // REJOIN_REQ_2 : RJcount0
1148:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( joinReqType == JOIN_REQ )
1149:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1150:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         // Nothing to be done
1151:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1152:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if( USE_LRWAN_1_1_X_CRYPTO == 1 )
1153:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     else
1154:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1155:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         // If Join-accept is a reply to a rejoin, the RJcount(0 or 1) replaces DevNonce in the key 
1156:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         if( ( joinReqType == REJOIN_REQ_0 ) || ( joinReqType == REJOIN_REQ_2 ) )
1157:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
1158:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             nonce = RJcount0;
1159:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
1160:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         else
1161:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
1162:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             nonce = CryptoNvm->FCntList.RJcount1;
1163:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
1164:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1165:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* USE_LRWAN_1_1_X_CRYPTO == 1 */
1166:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1167:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( SecureElementProcessJoinAccept( joinReqType, joinEUI, nonce, macMsg->Buffer,
1168:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****                                         macMsg->BufSize, decJoinAccept,
1169:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****                                         &versionMinor ) != SECURE_ELEMENT_SUCCESS )
1170:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1171:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_SECURE_ELEMENT_FUNC;
1172:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1173:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1174:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     memcpy1( macMsg->Buffer, decJoinAccept, macMsg->BufSize );
1175:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1176:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Parse the message
1177:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( LoRaMacParserJoinAccept( macMsg ) != LORAMAC_PARSER_SUCCESS )
1178:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1179:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_PARSER;
1180:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1181:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1182:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint32_t currentJoinNonce;
1183:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1184:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     currentJoinNonce = ( uint32_t )macMsg->JoinNonce[0];
1185:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     currentJoinNonce |= ( ( uint32_t )macMsg->JoinNonce[1] << 8 );
1186:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     currentJoinNonce |= ( ( uint32_t )macMsg->JoinNonce[2] << 16 );
1187:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1188:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if( USE_JOIN_NONCE_COUNTER_CHECK == 1 )
1189:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Check if the JoinNonce is greater as the previous one
1190:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( currentJoinNonce > CryptoNvm->JoinNonce )
1191:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #else
1192:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Check if the JoinNonce is different from the previous one
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 54


1193:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( currentJoinNonce != CryptoNvm->JoinNonce )
1194:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* USE_JOIN_NONCE_COUNTER_CHECK */
1195:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1196:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         CryptoNvm->JoinNonce = currentJoinNonce;
1197:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1198:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     else
1199:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1200:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_FAIL_JOIN_NONCE;
1201:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1202:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1203:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Derive lifetime keys
1204:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     retval = LoRaMacCryptoDeriveMcRootKey( versionMinor, APP_KEY );
1205:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( retval != LORAMAC_CRYPTO_SUCCESS )
1206:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1207:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return retval;
1208:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1209:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1210:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     retval = LoRaMacCryptoDeriveMcKEKey( MC_ROOT_KEY );
1211:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( retval != LORAMAC_CRYPTO_SUCCESS )
1212:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1213:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return retval;
1214:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1215:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1216:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if( USE_LRWAN_1_1_X_CRYPTO == 1 )
1217:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( versionMinor == 1 )
1218:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1219:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         // Operating in LoRaWAN 1.1.x mode
1220:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1221:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         retval = DeriveSessionKey11x( F_NWK_S_INT_KEY, currentJoinNonce, joinEUI, nonce );
1222:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         if( retval != LORAMAC_CRYPTO_SUCCESS )
1223:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
1224:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             return retval;
1225:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
1226:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1227:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         retval = DeriveSessionKey11x( S_NWK_S_INT_KEY, currentJoinNonce, joinEUI, nonce );
1228:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         if( retval != LORAMAC_CRYPTO_SUCCESS )
1229:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
1230:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             return retval;
1231:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
1232:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1233:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         retval = DeriveSessionKey11x( NWK_S_ENC_KEY, currentJoinNonce, joinEUI, nonce );
1234:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         if( retval != LORAMAC_CRYPTO_SUCCESS )
1235:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
1236:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             return retval;
1237:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
1238:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1239:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         retval = DeriveSessionKey11x( APP_S_KEY, currentJoinNonce, joinEUI, nonce );
1240:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         if( retval != LORAMAC_CRYPTO_SUCCESS )
1241:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
1242:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             return retval;
1243:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
1244:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1245:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     else
1246:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* USE_LRWAN_1_1_X_CRYPTO == 1 */
1247:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1248:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         // Operating in LoRaWAN 1.0.x mode
1249:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 55


1250:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         uint32_t netID;
1251:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1252:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         netID = ( uint32_t )macMsg->NetID[0];
1253:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         netID |= ( ( uint32_t )macMsg->NetID[1] << 8 );
1254:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         netID |= ( ( uint32_t )macMsg->NetID[2] << 16 );
1255:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1256:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         retval = DeriveSessionKey10x( APP_S_KEY, currentJoinNonce, netID, nonce );
1257:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         if( retval != LORAMAC_CRYPTO_SUCCESS )
1258:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
1259:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             return retval;
1260:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
1261:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1262:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         /* ST_WORKAROUND_BEGIN: integrate 1.1.x keys only if required */
1263:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if ( USE_LRWAN_1_1_X_CRYPTO == 1 )
1264:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         retval = DeriveSessionKey10x( NWK_S_ENC_KEY, currentJoinNonce, netID, nonce );
1265:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         if( retval != LORAMAC_CRYPTO_SUCCESS )
1266:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
1267:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             return retval;
1268:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
1269:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1270:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         retval = DeriveSessionKey10x( F_NWK_S_INT_KEY, currentJoinNonce, netID, nonce );
1271:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         if( retval != LORAMAC_CRYPTO_SUCCESS )
1272:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
1273:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             return retval;
1274:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
1275:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1276:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         retval = DeriveSessionKey10x( S_NWK_S_INT_KEY, currentJoinNonce, netID, nonce );
1277:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #else
1278:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         retval = DeriveSessionKey10x( NWK_S_KEY, currentJoinNonce, netID, nonce );
1279:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* USE_LRWAN_1_1_X_CRYPTO */
1280:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         /* ST_WORKAROUND_END */
1281:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         if( retval != LORAMAC_CRYPTO_SUCCESS )
1282:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
1283:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             return retval;
1284:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
1285:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1286:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1287:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Join-Accept is successfully processed
1288:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Save LoRaWAN specification version
1289:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     CryptoNvm->LrWanVersion.Fields.Minor = versionMinor;
1290:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1291:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Reset frame counters
1292:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if( USE_LRWAN_1_1_X_CRYPTO == 1 )
1293:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     RJcount0 = 0;
1294:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* USE_LRWAN_1_1_X_CRYPTO == 1 */
1295:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     CryptoNvm->FCntList.FCntUp = 0;
1296:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     CryptoNvm->FCntList.FCntDown = FCNT_DOWN_INITAL_VALUE;
1297:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     CryptoNvm->FCntList.NFCntDown = FCNT_DOWN_INITAL_VALUE;
1298:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     CryptoNvm->FCntList.AFCntDown = FCNT_DOWN_INITAL_VALUE;
1299:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1300:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     return LORAMAC_CRYPTO_SUCCESS;
1301:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
1302:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1303:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** LoRaMacCryptoStatus_t LoRaMacCryptoSecureMessage( uint32_t fCntUp, uint8_t txDr, uint8_t txCh, LoRa
1304:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
 1625              		.loc 1 1304 1 is_stmt 1 view -0
 1626              		.cfi_startproc
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 56


 1627              		@ args = 0, pretend = 0, frame = 0
 1628              		@ frame_needed = 0, uses_anonymous_args = 0
1305:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     LoRaMacCryptoStatus_t retval = LORAMAC_CRYPTO_ERROR;
 1629              		.loc 1 1305 5 view .LVU479
1306:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     KeyIdentifier_t payloadDecryptionKeyID = APP_S_KEY;
 1630              		.loc 1 1306 5 view .LVU480
1307:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1308:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( macMsg == NULL )
 1631              		.loc 1 1308 5 view .LVU481
 1632              		.loc 1 1308 7 is_stmt 0 view .LVU482
 1633 0000 002B     		cmp	r3, #0
 1634 0002 36D0     		beq	.L134
1304:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     LoRaMacCryptoStatus_t retval = LORAMAC_CRYPTO_ERROR;
 1635              		.loc 1 1304 1 view .LVU483
 1636 0004 30B5     		push	{r4, r5, lr}
 1637              	.LCFI36:
 1638              		.cfi_def_cfa_offset 12
 1639              		.cfi_offset 4, -12
 1640              		.cfi_offset 5, -8
 1641              		.cfi_offset 14, -4
 1642 0006 85B0     		sub	sp, sp, #20
 1643              	.LCFI37:
 1644              		.cfi_def_cfa_offset 32
 1645 0008 0446     		mov	r4, r0
 1646 000a 1D46     		mov	r5, r3
1309:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1310:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_NPE;
1311:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1312:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1313:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( fCntUp < CryptoNvm->FCntList.FCntUp )
 1647              		.loc 1 1313 5 is_stmt 1 view .LVU484
 1648              		.loc 1 1313 27 is_stmt 0 view .LVU485
 1649 000c 1D4B     		ldr	r3, .L143
 1650              	.LVL137:
 1651              		.loc 1 1313 27 view .LVU486
 1652 000e 1B68     		ldr	r3, [r3]
 1653              		.loc 1 1313 37 view .LVU487
 1654 0010 DB68     		ldr	r3, [r3, #12]
 1655              		.loc 1 1313 7 view .LVU488
 1656 0012 8342     		cmp	r3, r0
 1657 0014 2FD8     		bhi	.L135
1314:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1315:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_FAIL_FCNT_SMALLER;
1316:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1317:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1318:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Encrypt payload
1319:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( macMsg->FPort == 0 )
 1658              		.loc 1 1319 5 is_stmt 1 view .LVU489
 1659              		.loc 1 1319 15 is_stmt 0 view .LVU490
 1660 0016 95F82020 		ldrb	r2, [r5, #32]	@ zero_extendqisi2
 1661              	.LVL138:
 1662              		.loc 1 1319 7 view .LVU491
 1663 001a 42B3     		cbz	r2, .L136
1306:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 1664              		.loc 1 1306 21 view .LVU492
 1665 001c 0322     		movs	r2, #3
 1666              	.L132:
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 57


 1667              	.LVL139:
1320:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1321:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         // Use network session key
1322:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         /* ST_WORKAROUND_BEGIN: integrate 1.1.x keys only if required */
1323:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if ( USE_LRWAN_1_1_X_CRYPTO == 1 )
1324:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         payloadDecryptionKeyID = NWK_S_ENC_KEY;
1325:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #else /* USE_LRWAN_1_1_X_CRYPTO == 0 */
1326:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         payloadDecryptionKeyID = NWK_S_KEY;
1327:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* USE_LRWAN_1_1_X_CRYPTO */
1328:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         /* ST_WORKAROUND_END */
1329:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1330:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1331:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( fCntUp > CryptoNvm->FCntList.FCntUp )
 1668              		.loc 1 1331 5 is_stmt 1 view .LVU493
 1669              		.loc 1 1331 7 is_stmt 0 view .LVU494
 1670 001e A342     		cmp	r3, r4
 1671 0020 09D2     		bcs	.L133
1332:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1333:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         retval = PayloadEncrypt( macMsg->FRMPayload, macMsg->FRMPayloadSize, payloadDecryptionKeyID
 1672              		.loc 1 1333 9 is_stmt 1 view .LVU495
 1673              		.loc 1 1333 18 is_stmt 0 view .LVU496
 1674 0022 0194     		str	r4, [sp, #4]
 1675 0024 0023     		movs	r3, #0
 1676 0026 0093     		str	r3, [sp]
 1677 0028 AB68     		ldr	r3, [r5, #8]
 1678 002a 95F82810 		ldrb	r1, [r5, #40]	@ zero_extendqisi2
 1679              	.LVL140:
 1680              		.loc 1 1333 18 view .LVU497
 1681 002e 686A     		ldr	r0, [r5, #36]
 1682              	.LVL141:
 1683              		.loc 1 1333 18 view .LVU498
 1684 0030 FFF7FEFF 		bl	PayloadEncrypt
 1685              	.LVL142:
1334:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         if( retval != LORAMAC_CRYPTO_SUCCESS )
 1686              		.loc 1 1334 9 is_stmt 1 view .LVU499
 1687              		.loc 1 1334 11 is_stmt 0 view .LVU500
 1688 0034 10BB     		cbnz	r0, .L131
 1689              	.LVL143:
 1690              	.L133:
1335:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
1336:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             return retval;
1337:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
1338:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1339:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if( USE_LRWAN_1_1_X_CRYPTO == 1 )
1340:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         if( CryptoNvm->LrWanVersion.Fields.Minor == 1 )
1341:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
1342:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             // Encrypt FOpts
1343:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             retval = FOptsEncrypt( macMsg->FHDR.FCtrl.Bits.FOptsLen, macMsg->FHDR.DevAddr, UPLINK, 
1344:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             if( retval != LORAMAC_CRYPTO_SUCCESS )
1345:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             {
1346:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****                 return retval;
1347:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             }
1348:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
1349:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* USE_LRWAN_1_1_X_CRYPTO */
1350:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1351:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1352:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Serialize message
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 58


1353:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( LoRaMacSerializerData( macMsg ) != LORAMAC_SERIALIZER_SUCCESS )
 1691              		.loc 1 1353 5 is_stmt 1 view .LVU501
 1692              		.loc 1 1353 9 is_stmt 0 view .LVU502
 1693 0036 2846     		mov	r0, r5
 1694 0038 FFF7FEFF 		bl	LoRaMacSerializerData
 1695              	.LVL144:
 1696              		.loc 1 1353 7 view .LVU503
 1697 003c E8B9     		cbnz	r0, .L137
1354:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1355:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_SERIALIZER;
1356:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1357:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1358:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Compute mic
1359:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if( USE_LRWAN_1_1_X_CRYPTO == 1 )
1360:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( CryptoNvm->LrWanVersion.Fields.Minor == 1 )
1361:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1362:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         uint32_t cmacS = 0;
1363:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         uint32_t cmacF = 0;
1364:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1365:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         // cmacS  = aes128_cmac(SNwkSIntKey, B1 | msg)
1366:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         retval = ComputeCmacB1( macMsg->Buffer, ( macMsg->BufSize - LORAMAC_MIC_FIELD_SIZE ), S_NWK
1367:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         if( retval != LORAMAC_CRYPTO_SUCCESS )
1368:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
1369:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             return retval;
1370:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
1371:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         //cmacF = aes128_cmac(FNwkSIntKey, B0 | msg)
1372:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         retval = ComputeCmacB0( macMsg->Buffer, ( macMsg->BufSize - LORAMAC_MIC_FIELD_SIZE ), F_NWK
1373:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         if( retval != LORAMAC_CRYPTO_SUCCESS )
1374:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
1375:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             return retval;
1376:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
1377:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         // MIC = cmacS[0..1] | cmacF[0..1]
1378:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         macMsg->MIC = ( ( cmacF << 16 ) & 0xFFFF0000 ) | ( cmacS & 0x0000FFFF );
1379:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1380:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     else
1381:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* USE_LRWAN_1_1_X_CRYPTO */
1382:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {        
1383:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         // Use network session key
1384:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         /* ST_WORKAROUND_BEGIN: integrate 1.1.x keys only if required */
1385:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if ( USE_LRWAN_1_1_X_CRYPTO == 1 )
1386:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         payloadDecryptionKeyID = NWK_S_ENC_KEY;
1387:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #else /* USE_LRWAN_1_1_X_CRYPTO == 0 */
1388:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         payloadDecryptionKeyID = NWK_S_KEY;
 1698              		.loc 1 1388 9 is_stmt 1 view .LVU504
 1699              	.LVL145:
1389:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* USE_LRWAN_1_1_X_CRYPTO */
1390:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         /* ST_WORKAROUND_END */
1391:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         // MIC = cmacF[0..3]
1392:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         // The IsAck parameter is every time false since the ConfFCnt field is not used in legacy m
1393:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         retval = ComputeCmacB0( macMsg->Buffer, ( macMsg->BufSize - LORAMAC_MIC_FIELD_SIZE ), paylo
 1700              		.loc 1 1393 9 view .LVU505
 1701              		.loc 1 1393 57 is_stmt 0 view .LVU506
 1702 003e 2979     		ldrb	r1, [r5, #4]	@ zero_extendqisi2
 1703              		.loc 1 1393 18 view .LVU507
 1704 0040 0439     		subs	r1, r1, #4
 1705 0042 2B46     		mov	r3, r5
 1706 0044 53F82C0B 		ldr	r0, [r3], #44
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 59


 1707 0048 0393     		str	r3, [sp, #12]
 1708 004a 0294     		str	r4, [sp, #8]
 1709 004c AB68     		ldr	r3, [r5, #8]
 1710 004e 0193     		str	r3, [sp, #4]
 1711 0050 0023     		movs	r3, #0
 1712 0052 0093     		str	r3, [sp]
 1713 0054 0222     		movs	r2, #2
 1714 0056 89B2     		uxth	r1, r1
 1715 0058 FFF7FEFF 		bl	ComputeCmacB0
 1716              	.LVL146:
1394:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         if( retval != LORAMAC_CRYPTO_SUCCESS )
 1717              		.loc 1 1394 9 is_stmt 1 view .LVU508
 1718              		.loc 1 1394 11 is_stmt 0 view .LVU509
 1719 005c 70B9     		cbnz	r0, .L131
1395:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
1396:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             return retval;
1397:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
1398:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1399:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1400:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Re-serialize message to add the MIC
1401:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( LoRaMacSerializerData( macMsg ) != LORAMAC_SERIALIZER_SUCCESS )
 1720              		.loc 1 1401 5 is_stmt 1 view .LVU510
 1721              		.loc 1 1401 9 is_stmt 0 view .LVU511
 1722 005e 2846     		mov	r0, r5
 1723              	.LVL147:
 1724              		.loc 1 1401 9 view .LVU512
 1725 0060 FFF7FEFF 		bl	LoRaMacSerializerData
 1726              	.LVL148:
 1727              		.loc 1 1401 7 view .LVU513
 1728 0064 60B9     		cbnz	r0, .L138
1402:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1403:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_SERIALIZER;
1404:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1405:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1406:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     CryptoNvm->FCntList.FCntUp = fCntUp;
 1729              		.loc 1 1406 5 is_stmt 1 view .LVU514
 1730              		.loc 1 1406 14 is_stmt 0 view .LVU515
 1731 0066 074B     		ldr	r3, .L143
 1732 0068 1B68     		ldr	r3, [r3]
 1733              		.loc 1 1406 32 view .LVU516
 1734 006a DC60     		str	r4, [r3, #12]
1407:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1408:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     return LORAMAC_CRYPTO_SUCCESS;
 1735              		.loc 1 1408 5 is_stmt 1 view .LVU517
 1736              		.loc 1 1408 12 is_stmt 0 view .LVU518
 1737 006c 06E0     		b	.L131
 1738              	.LVL149:
 1739              	.L136:
1326:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* USE_LRWAN_1_1_X_CRYPTO */
 1740              		.loc 1 1326 32 view .LVU519
 1741 006e 0222     		movs	r2, #2
 1742 0070 D5E7     		b	.L132
 1743              	.LVL150:
 1744              	.L134:
 1745              	.LCFI38:
 1746              		.cfi_def_cfa_offset 0
 1747              		.cfi_restore 4
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 60


 1748              		.cfi_restore 5
 1749              		.cfi_restore 14
1310:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 1750              		.loc 1 1310 16 view .LVU520
 1751 0072 0A20     		movs	r0, #10
 1752              	.LVL151:
1409:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 1753              		.loc 1 1409 1 view .LVU521
 1754 0074 7047     		bx	lr
 1755              	.LVL152:
 1756              	.L135:
 1757              	.LCFI39:
 1758              		.cfi_def_cfa_offset 32
 1759              		.cfi_offset 4, -12
 1760              		.cfi_offset 5, -8
 1761              		.cfi_offset 14, -4
1315:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 1762              		.loc 1 1315 16 view .LVU522
 1763 0076 0620     		movs	r0, #6
 1764              	.LVL153:
1315:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 1765              		.loc 1 1315 16 view .LVU523
 1766 0078 00E0     		b	.L131
 1767              	.LVL154:
 1768              	.L137:
1355:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 1769              		.loc 1 1355 16 view .LVU524
 1770 007a 1120     		movs	r0, #17
 1771              	.L131:
 1772              		.loc 1 1409 1 view .LVU525
 1773 007c 05B0     		add	sp, sp, #20
 1774              	.LCFI40:
 1775              		.cfi_remember_state
 1776              		.cfi_def_cfa_offset 12
 1777              		@ sp needed
 1778 007e 30BD     		pop	{r4, r5, pc}
 1779              	.LVL155:
 1780              	.L138:
 1781              	.LCFI41:
 1782              		.cfi_restore_state
1403:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 1783              		.loc 1 1403 16 view .LVU526
 1784 0080 1120     		movs	r0, #17
 1785 0082 FBE7     		b	.L131
 1786              	.L144:
 1787              		.align	2
 1788              	.L143:
 1789 0084 00000000 		.word	.LANCHOR1
 1790              		.cfi_endproc
 1791              	.LFE122:
 1793              		.section	.text.LoRaMacCryptoUnsecureMessage,"ax",%progbits
 1794              		.align	1
 1795              		.global	LoRaMacCryptoUnsecureMessage
 1796              		.syntax unified
 1797              		.thumb
 1798              		.thumb_func
 1800              	LoRaMacCryptoUnsecureMessage:
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 61


 1801              	.LVL156:
 1802              	.LFB123:
1410:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1411:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** LoRaMacCryptoStatus_t LoRaMacCryptoUnsecureMessage( AddressIdentifier_t addrID, uint32_t address, F
1412:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
 1803              		.loc 1 1412 1 is_stmt 1 view -0
 1804              		.cfi_startproc
 1805              		@ args = 4, pretend = 0, frame = 8
 1806              		@ frame_needed = 0, uses_anonymous_args = 0
 1807              		.loc 1 1412 1 is_stmt 0 view .LVU528
 1808 0000 2DE9F043 		push	{r4, r5, r6, r7, r8, r9, lr}
 1809              	.LCFI42:
 1810              		.cfi_def_cfa_offset 28
 1811              		.cfi_offset 4, -28
 1812              		.cfi_offset 5, -24
 1813              		.cfi_offset 6, -20
 1814              		.cfi_offset 7, -16
 1815              		.cfi_offset 8, -12
 1816              		.cfi_offset 9, -8
 1817              		.cfi_offset 14, -4
 1818 0004 87B0     		sub	sp, sp, #28
 1819              	.LCFI43:
 1820              		.cfi_def_cfa_offset 56
 1821 0006 0E9E     		ldr	r6, [sp, #56]
1413:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( macMsg == 0 )
 1822              		.loc 1 1413 5 is_stmt 1 view .LVU529
 1823              		.loc 1 1413 7 is_stmt 0 view .LVU530
 1824 0008 002E     		cmp	r6, #0
 1825 000a 49D0     		beq	.L149
 1826 000c 0546     		mov	r5, r0
 1827 000e 8846     		mov	r8, r1
 1828 0010 1746     		mov	r7, r2
 1829 0012 1C46     		mov	r4, r3
1414:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1415:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_NPE;
1416:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1417:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1418:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( CheckFCntDown( fCntID, fCntDown ) == false )
 1830              		.loc 1 1418 5 is_stmt 1 view .LVU531
 1831              		.loc 1 1418 9 is_stmt 0 view .LVU532
 1832 0014 1946     		mov	r1, r3
 1833              	.LVL157:
 1834              		.loc 1 1418 9 view .LVU533
 1835 0016 1046     		mov	r0, r2
 1836              	.LVL158:
 1837              		.loc 1 1418 9 view .LVU534
 1838 0018 FFF7FEFF 		bl	CheckFCntDown
 1839              	.LVL159:
 1840              		.loc 1 1418 7 view .LVU535
 1841 001c 0028     		cmp	r0, #0
 1842 001e 41D0     		beq	.L150
1419:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1420:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_FAIL_FCNT_SMALLER;
1421:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1422:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1423:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     LoRaMacCryptoStatus_t retval = LORAMAC_CRYPTO_ERROR;
 1843              		.loc 1 1423 5 is_stmt 1 view .LVU536
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 62


 1844              	.LVL160:
1424:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     KeyIdentifier_t payloadDecryptionKeyID = APP_S_KEY;
 1845              		.loc 1 1424 5 view .LVU537
1425:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     /* ST_WORKAROUND_BEGIN: integrate 1.1.x keys only if required */
1426:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if ( USE_LRWAN_1_1_X_CRYPTO == 1 )
1427:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     KeyIdentifier_t micComputationKeyID = S_NWK_S_INT_KEY;
1428:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #else /* USE_LRWAN_1_1_X_CRYPTO == 0 */
1429:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     KeyIdentifier_t micComputationKeyID = NWK_S_KEY;
 1846              		.loc 1 1429 5 view .LVU538
1430:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* USE_LRWAN_1_1_X_CRYPTO */
1431:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     /* ST_WORKAROUND_END */
1432:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     KeyAddr_t* curItem;
 1847              		.loc 1 1432 5 view .LVU539
1433:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1434:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Parse the message
1435:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( LoRaMacParserData( macMsg ) != LORAMAC_PARSER_SUCCESS )
 1848              		.loc 1 1435 5 view .LVU540
 1849              		.loc 1 1435 9 is_stmt 0 view .LVU541
 1850 0020 3046     		mov	r0, r6
 1851 0022 FFF7FEFF 		bl	LoRaMacParserData
 1852              	.LVL161:
 1853              		.loc 1 1435 7 view .LVU542
 1854 0026 0028     		cmp	r0, #0
 1855 0028 41D1     		bne	.L151
1436:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1437:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_PARSER;
1438:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1439:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1440:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Determine current security context
1441:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     retval = GetKeyAddrItem( addrID, &curItem );
 1856              		.loc 1 1441 5 is_stmt 1 view .LVU543
 1857              		.loc 1 1441 14 is_stmt 0 view .LVU544
 1858 002a 05A9     		add	r1, sp, #20
 1859 002c 2846     		mov	r0, r5
 1860 002e FFF7FEFF 		bl	GetKeyAddrItem
 1861              	.LVL162:
1442:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( retval != LORAMAC_CRYPTO_SUCCESS )
 1862              		.loc 1 1442 5 is_stmt 1 view .LVU545
 1863              		.loc 1 1442 7 is_stmt 0 view .LVU546
 1864 0032 0546     		mov	r5, r0
 1865 0034 0028     		cmp	r0, #0
 1866 0036 36D1     		bne	.L146
1443:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1444:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return retval;
1445:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1446:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1447:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     payloadDecryptionKeyID = curItem->AppSkey;
 1867              		.loc 1 1447 5 is_stmt 1 view .LVU547
 1868              		.loc 1 1447 37 is_stmt 0 view .LVU548
 1869 0038 059B     		ldr	r3, [sp, #20]
 1870              		.loc 1 1447 28 view .LVU549
 1871 003a 93F80190 		ldrb	r9, [r3, #1]	@ zero_extendqisi2
 1872              	.LVL163:
1448:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     micComputationKeyID = curItem->NwkSkey;
 1873              		.loc 1 1448 5 is_stmt 1 view .LVU550
 1874              		.loc 1 1448 25 is_stmt 0 view .LVU551
 1875 003e 9A78     		ldrb	r2, [r3, #2]	@ zero_extendqisi2
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 63


 1876              	.LVL164:
1449:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1450:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Check if it is our address
1451:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( address != macMsg->FHDR.DevAddr )
 1877              		.loc 1 1451 5 is_stmt 1 view .LVU552
 1878              		.loc 1 1451 32 is_stmt 0 view .LVU553
 1879 0040 B368     		ldr	r3, [r6, #8]
 1880              		.loc 1 1451 7 view .LVU554
 1881 0042 4345     		cmp	r3, r8
 1882 0044 35D1     		bne	.L152
1452:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1453:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_FAIL_ADDRESS;
1454:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1455:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1456:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Compute mic
1457:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     bool isAck = macMsg->FHDR.FCtrl.Bits.Ack;
 1883              		.loc 1 1457 5 is_stmt 1 view .LVU555
 1884              		.loc 1 1457 41 is_stmt 0 view .LVU556
 1885 0046 337B     		ldrb	r3, [r6, #12]	@ zero_extendqisi2
 1886 0048 C3F34013 		ubfx	r3, r3, #5, #1
 1887              	.LVL165:
1458:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( CryptoNvm->LrWanVersion.Fields.Minor == 0 )
 1888              		.loc 1 1458 5 is_stmt 1 view .LVU557
 1889              		.loc 1 1458 18 is_stmt 0 view .LVU558
 1890 004c 1A49     		ldr	r1, .L156
 1891 004e 0968     		ldr	r1, [r1]
 1892              		.loc 1 1458 39 view .LVU559
 1893 0050 8978     		ldrb	r1, [r1, #2]	@ zero_extendqisi2
 1894              		.loc 1 1458 7 view .LVU560
 1895 0052 01B9     		cbnz	r1, .L147
1459:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1460:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         // In legacy mode the IsAck parameter is forced to be false since the ConfFCnt field is not
1461:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         isAck = false;
 1896              		.loc 1 1461 15 view .LVU561
 1897 0054 0023     		movs	r3, #0
 1898              	.L147:
 1899              	.LVL166:
1462:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1463:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1464:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Verify mic
1465:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     retval = VerifyCmacB0( macMsg->Buffer, ( macMsg->BufSize - LORAMAC_MIC_FIELD_SIZE ), micComputa
 1900              		.loc 1 1465 5 is_stmt 1 view .LVU562
 1901              		.loc 1 1465 52 is_stmt 0 view .LVU563
 1902 0056 3179     		ldrb	r1, [r6, #4]	@ zero_extendqisi2
 1903              		.loc 1 1465 14 view .LVU564
 1904 0058 0439     		subs	r1, r1, #4
 1905 005a F06A     		ldr	r0, [r6, #44]
 1906              	.LVL167:
 1907              		.loc 1 1465 14 view .LVU565
 1908 005c 0390     		str	r0, [sp, #12]
 1909 005e 0294     		str	r4, [sp, #8]
 1910 0060 CDF80480 		str	r8, [sp, #4]
 1911 0064 0120     		movs	r0, #1
 1912 0066 0090     		str	r0, [sp]
 1913 0068 89B2     		uxth	r1, r1
 1914 006a 3068     		ldr	r0, [r6]
 1915 006c FFF7FEFF 		bl	VerifyCmacB0
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 64


 1916              	.LVL168:
1466:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( retval != LORAMAC_CRYPTO_SUCCESS )
 1917              		.loc 1 1466 5 is_stmt 1 view .LVU566
 1918              		.loc 1 1466 7 is_stmt 0 view .LVU567
 1919 0070 0546     		mov	r5, r0
 1920 0072 C0B9     		cbnz	r0, .L146
1467:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1468:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return retval;
1469:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1470:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1471:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Decrypt payload
1472:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( macMsg->FPort == 0 )
 1921              		.loc 1 1472 5 is_stmt 1 view .LVU568
 1922              		.loc 1 1472 15 is_stmt 0 view .LVU569
 1923 0074 96F82030 		ldrb	r3, [r6, #32]	@ zero_extendqisi2
 1924              		.loc 1 1472 7 view .LVU570
 1925 0078 0BB9     		cbnz	r3, .L148
1473:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1474:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         // Use network session encryption key
1475:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         /* ST_WORKAROUND_BEGIN: integrate 1.1.x keys only if required */
1476:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if ( USE_LRWAN_1_1_X_CRYPTO == 1 )
1477:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         payloadDecryptionKeyID = NWK_S_ENC_KEY;
1478:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #else /* USE_LRWAN_1_1_X_CRYPTO == 0 */
1479:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         payloadDecryptionKeyID = NWK_S_KEY;
 1926              		.loc 1 1479 32 view .LVU571
 1927 007a 4FF00209 		mov	r9, #2
 1928              	.LVL169:
 1929              	.L148:
1480:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* USE_LRWAN_1_1_X_CRYPTO */
1481:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         /* ST_WORKAROUND_END */
1482:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1483:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     retval = PayloadEncrypt( macMsg->FRMPayload, macMsg->FRMPayloadSize, payloadDecryptionKeyID, ad
 1930              		.loc 1 1483 5 is_stmt 1 view .LVU572
 1931              		.loc 1 1483 14 is_stmt 0 view .LVU573
 1932 007e 0194     		str	r4, [sp, #4]
 1933 0080 0123     		movs	r3, #1
 1934 0082 0093     		str	r3, [sp]
 1935 0084 4346     		mov	r3, r8
 1936 0086 4A46     		mov	r2, r9
 1937 0088 96F82810 		ldrb	r1, [r6, #40]	@ zero_extendqisi2
 1938 008c 706A     		ldr	r0, [r6, #36]
 1939              	.LVL170:
 1940              		.loc 1 1483 14 view .LVU574
 1941 008e FFF7FEFF 		bl	PayloadEncrypt
 1942              	.LVL171:
1484:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( retval != LORAMAC_CRYPTO_SUCCESS )
 1943              		.loc 1 1484 5 is_stmt 1 view .LVU575
 1944              		.loc 1 1484 7 is_stmt 0 view .LVU576
 1945 0092 0546     		mov	r5, r0
 1946 0094 38B9     		cbnz	r0, .L146
1485:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1486:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return retval;
1487:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1488:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1489:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if( USE_LRWAN_1_1_X_CRYPTO == 1 )
1490:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( CryptoNvm->LrWanVersion.Fields.Minor == 1 )
1491:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 65


1492:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         if( addrID == UNICAST_DEV_ADDR )
1493:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
1494:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             // Decrypt FOpts
1495:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             retval = FOptsEncrypt( macMsg->FHDR.FCtrl.Bits.FOptsLen, address, DOWNLINK, fCntID, fCn
1496:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             if( retval != LORAMAC_CRYPTO_SUCCESS )
1497:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             {
1498:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****                 return retval;
1499:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****             }
1500:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         } 
1501:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1502:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif
1503:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1504:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     UpdateFCntDown( fCntID, fCntDown );
 1947              		.loc 1 1504 5 is_stmt 1 view .LVU577
 1948 0096 2146     		mov	r1, r4
 1949 0098 3846     		mov	r0, r7
 1950              	.LVL172:
 1951              		.loc 1 1504 5 is_stmt 0 view .LVU578
 1952 009a FFF7FEFF 		bl	UpdateFCntDown
 1953              	.LVL173:
1505:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1506:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     return LORAMAC_CRYPTO_SUCCESS;
 1954              		.loc 1 1506 5 is_stmt 1 view .LVU579
 1955              		.loc 1 1506 12 is_stmt 0 view .LVU580
 1956 009e 02E0     		b	.L146
 1957              	.LVL174:
 1958              	.L149:
1415:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 1959              		.loc 1 1415 16 view .LVU581
 1960 00a0 0A25     		movs	r5, #10
 1961 00a2 00E0     		b	.L146
 1962              	.LVL175:
 1963              	.L150:
1420:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 1964              		.loc 1 1420 16 view .LVU582
 1965 00a4 0625     		movs	r5, #6
 1966              	.LVL176:
 1967              	.L146:
1507:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 1968              		.loc 1 1507 1 view .LVU583
 1969 00a6 2846     		mov	r0, r5
 1970 00a8 07B0     		add	sp, sp, #28
 1971              	.LCFI44:
 1972              		.cfi_remember_state
 1973              		.cfi_def_cfa_offset 28
 1974              		@ sp needed
 1975 00aa BDE8F083 		pop	{r4, r5, r6, r7, r8, r9, pc}
 1976              	.LVL177:
 1977              	.L151:
 1978              	.LCFI45:
 1979              		.cfi_restore_state
1437:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 1980              		.loc 1 1437 16 view .LVU584
 1981 00ae 1025     		movs	r5, #16
 1982 00b0 F9E7     		b	.L146
 1983              	.LVL178:
 1984              	.L152:
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 66


1453:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 1985              		.loc 1 1453 16 view .LVU585
 1986 00b2 0225     		movs	r5, #2
 1987 00b4 F7E7     		b	.L146
 1988              	.L157:
 1989 00b6 00BF     		.align	2
 1990              	.L156:
 1991 00b8 00000000 		.word	.LANCHOR1
 1992              		.cfi_endproc
 1993              	.LFE123:
 1995              		.section	.text.LoRaMacCryptoDeriveMcRootKey,"ax",%progbits
 1996              		.align	1
 1997              		.global	LoRaMacCryptoDeriveMcRootKey
 1998              		.syntax unified
 1999              		.thumb
 2000              		.thumb_func
 2002              	LoRaMacCryptoDeriveMcRootKey:
 2003              	.LVL179:
 2004              	.LFB124:
1508:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1509:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** LoRaMacCryptoStatus_t LoRaMacCryptoDeriveMcRootKey( uint8_t versionMinor, KeyIdentifier_t keyID )
1510:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
 2005              		.loc 1 1510 1 is_stmt 1 view -0
 2006              		.cfi_startproc
 2007              		@ args = 0, pretend = 0, frame = 16
 2008              		@ frame_needed = 0, uses_anonymous_args = 0
1511:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Prevent other keys than AppKey
1512:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( keyID != APP_KEY )
 2009              		.loc 1 1512 5 view .LVU587
 2010              		.loc 1 1512 7 is_stmt 0 view .LVU588
 2011 0000 B1B9     		cbnz	r1, .L161
1510:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Prevent other keys than AppKey
 2012              		.loc 1 1510 1 view .LVU589
 2013 0002 00B5     		push	{lr}
 2014              	.LCFI46:
 2015              		.cfi_def_cfa_offset 4
 2016              		.cfi_offset 14, -4
 2017 0004 85B0     		sub	sp, sp, #20
 2018              	.LCFI47:
 2019              		.cfi_def_cfa_offset 24
 2020 0006 8C46     		mov	ip, r1
1513:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1514:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_INVALID_KEY_ID;
1515:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1516:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t compBase[16] = { 0 };
 2021              		.loc 1 1516 5 is_stmt 1 view .LVU590
 2022              		.loc 1 1516 13 is_stmt 0 view .LVU591
 2023 0008 0023     		movs	r3, #0
 2024 000a 0093     		str	r3, [sp]
 2025 000c 0193     		str	r3, [sp, #4]
 2026 000e 0293     		str	r3, [sp, #8]
 2027 0010 0393     		str	r3, [sp, #12]
1517:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1518:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( versionMinor == 1 )
 2028              		.loc 1 1518 5 is_stmt 1 view .LVU592
 2029              		.loc 1 1518 7 is_stmt 0 view .LVU593
 2030 0012 0128     		cmp	r0, #1
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 67


 2031 0014 08D0     		beq	.L167
 2032              	.L160:
1519:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1520:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         compBase[0] = 0x20;
1521:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1522:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( SecureElementDeriveAndStoreKey( compBase, keyID, MC_ROOT_KEY ) != SECURE_ELEMENT_SUCCESS )
 2033              		.loc 1 1522 5 is_stmt 1 view .LVU594
 2034              		.loc 1 1522 9 is_stmt 0 view .LVU595
 2035 0016 0422     		movs	r2, #4
 2036 0018 6146     		mov	r1, ip
 2037              	.LVL180:
 2038              		.loc 1 1522 9 view .LVU596
 2039 001a 6846     		mov	r0, sp
 2040              	.LVL181:
 2041              		.loc 1 1522 9 view .LVU597
 2042 001c FFF7FEFF 		bl	SecureElementDeriveAndStoreKey
 2043              	.LVL182:
 2044              		.loc 1 1522 7 view .LVU598
 2045 0020 40B9     		cbnz	r0, .L168
 2046              	.L159:
1523:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1524:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_SECURE_ELEMENT_FUNC;
1525:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1526:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1527:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     return LORAMAC_CRYPTO_SUCCESS;
1528:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 2047              		.loc 1 1528 1 view .LVU599
 2048 0022 05B0     		add	sp, sp, #20
 2049              	.LCFI48:
 2050              		.cfi_remember_state
 2051              		.cfi_def_cfa_offset 4
 2052              		@ sp needed
 2053 0024 5DF804FB 		ldr	pc, [sp], #4
 2054              	.LVL183:
 2055              	.L167:
 2056              	.LCFI49:
 2057              		.cfi_restore_state
1520:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 2058              		.loc 1 1520 9 is_stmt 1 view .LVU600
1520:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 2059              		.loc 1 1520 21 is_stmt 0 view .LVU601
 2060 0028 2023     		movs	r3, #32
 2061 002a 8DF80030 		strb	r3, [sp]
 2062 002e F2E7     		b	.L160
 2063              	.L161:
 2064              	.LCFI50:
 2065              		.cfi_def_cfa_offset 0
 2066              		.cfi_restore 14
1514:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 2067              		.loc 1 1514 16 view .LVU602
 2068 0030 0B20     		movs	r0, #11
 2069              	.LVL184:
 2070              		.loc 1 1528 1 view .LVU603
 2071 0032 7047     		bx	lr
 2072              	.LVL185:
 2073              	.L168:
 2074              	.LCFI51:
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 68


 2075              		.cfi_def_cfa_offset 24
 2076              		.cfi_offset 14, -4
1524:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 2077              		.loc 1 1524 16 view .LVU604
 2078 0034 0F20     		movs	r0, #15
 2079 0036 F4E7     		b	.L159
 2080              		.cfi_endproc
 2081              	.LFE124:
 2083              		.section	.text.LoRaMacCryptoDeriveMcKEKey,"ax",%progbits
 2084              		.align	1
 2085              		.global	LoRaMacCryptoDeriveMcKEKey
 2086              		.syntax unified
 2087              		.thumb
 2088              		.thumb_func
 2090              	LoRaMacCryptoDeriveMcKEKey:
 2091              	.LVL186:
 2092              	.LFB125:
1529:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1530:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** LoRaMacCryptoStatus_t LoRaMacCryptoDeriveMcKEKey( KeyIdentifier_t keyID )
1531:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
 2093              		.loc 1 1531 1 is_stmt 1 view -0
 2094              		.cfi_startproc
 2095              		@ args = 0, pretend = 0, frame = 16
 2096              		@ frame_needed = 0, uses_anonymous_args = 0
1532:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Prevent other keys than McRootKey
1533:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( keyID != MC_ROOT_KEY )
 2097              		.loc 1 1533 5 view .LVU606
 2098              		.loc 1 1533 7 is_stmt 0 view .LVU607
 2099 0000 0428     		cmp	r0, #4
 2100 0002 01D0     		beq	.L177
1534:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1535:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_INVALID_KEY_ID;
 2101              		.loc 1 1535 16 view .LVU608
 2102 0004 0B20     		movs	r0, #11
 2103              	.LVL187:
1536:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1537:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t compBase[16] = { 0 };
1538:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1539:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( SecureElementDeriveAndStoreKey( compBase, keyID, MC_KE_KEY ) != SECURE_ELEMENT_SUCCESS )
1540:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1541:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_SECURE_ELEMENT_FUNC;
1542:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1543:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1544:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     return LORAMAC_CRYPTO_SUCCESS;
1545:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 2104              		.loc 1 1545 1 view .LVU609
 2105 0006 7047     		bx	lr
 2106              	.LVL188:
 2107              	.L177:
1531:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Prevent other keys than McRootKey
 2108              		.loc 1 1531 1 view .LVU610
 2109 0008 00B5     		push	{lr}
 2110              	.LCFI52:
 2111              		.cfi_def_cfa_offset 4
 2112              		.cfi_offset 14, -4
 2113 000a 85B0     		sub	sp, sp, #20
 2114              	.LCFI53:
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 69


 2115              		.cfi_def_cfa_offset 24
1537:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 2116              		.loc 1 1537 5 is_stmt 1 view .LVU611
1537:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 2117              		.loc 1 1537 13 is_stmt 0 view .LVU612
 2118 000c 0023     		movs	r3, #0
 2119 000e 0093     		str	r3, [sp]
 2120 0010 0193     		str	r3, [sp, #4]
 2121 0012 0293     		str	r3, [sp, #8]
 2122 0014 0393     		str	r3, [sp, #12]
1539:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 2123              		.loc 1 1539 5 is_stmt 1 view .LVU613
1539:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 2124              		.loc 1 1539 9 is_stmt 0 view .LVU614
 2125 0016 7F22     		movs	r2, #127
 2126 0018 0146     		mov	r1, r0
 2127 001a 6846     		mov	r0, sp
 2128              	.LVL189:
1539:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 2129              		.loc 1 1539 9 view .LVU615
 2130 001c FFF7FEFF 		bl	SecureElementDeriveAndStoreKey
 2131              	.LVL190:
1539:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 2132              		.loc 1 1539 7 view .LVU616
 2133 0020 10B9     		cbnz	r0, .L178
 2134              	.L170:
 2135              		.loc 1 1545 1 view .LVU617
 2136 0022 05B0     		add	sp, sp, #20
 2137              	.LCFI54:
 2138              		.cfi_remember_state
 2139              		.cfi_def_cfa_offset 4
 2140              		@ sp needed
 2141 0024 5DF804FB 		ldr	pc, [sp], #4
 2142              	.L178:
 2143              	.LCFI55:
 2144              		.cfi_restore_state
1541:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 2145              		.loc 1 1541 16 view .LVU618
 2146 0028 0F20     		movs	r0, #15
 2147 002a FAE7     		b	.L170
 2148              		.cfi_endproc
 2149              	.LFE125:
 2151              		.section	.text.LoRaMacCryptoSetKey,"ax",%progbits
 2152              		.align	1
 2153              		.global	LoRaMacCryptoSetKey
 2154              		.syntax unified
 2155              		.thumb
 2156              		.thumb_func
 2158              	LoRaMacCryptoSetKey:
 2159              	.LVL191:
 2160              	.LFB119:
 982:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( SecureElementSetKey( keyID, key ) != SECURE_ELEMENT_SUCCESS )
 2161              		.loc 1 982 1 is_stmt 1 view -0
 2162              		.cfi_startproc
 2163              		@ args = 0, pretend = 0, frame = 0
 2164              		@ frame_needed = 0, uses_anonymous_args = 0
 982:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( SecureElementSetKey( keyID, key ) != SECURE_ELEMENT_SUCCESS )
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 70


 2165              		.loc 1 982 1 is_stmt 0 view .LVU620
 2166 0000 10B5     		push	{r4, lr}
 2167              	.LCFI56:
 2168              		.cfi_def_cfa_offset 8
 2169              		.cfi_offset 4, -8
 2170              		.cfi_offset 14, -4
 2171 0002 0446     		mov	r4, r0
 983:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 2172              		.loc 1 983 5 is_stmt 1 view .LVU621
 983:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 2173              		.loc 1 983 9 is_stmt 0 view .LVU622
 2174 0004 FFF7FEFF 		bl	SecureElementSetKey
 2175              	.LVL192:
 983:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 2176              		.loc 1 983 7 view .LVU623
 2177 0008 78B9     		cbnz	r0, .L181
 987:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 2178              		.loc 1 987 5 is_stmt 1 view .LVU624
 987:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 2179              		.loc 1 987 7 is_stmt 0 view .LVU625
 2180 000a 04B1     		cbz	r4, .L185
 2181              	.L180:
1000:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 2182              		.loc 1 1000 1 view .LVU626
 2183 000c 10BD     		pop	{r4, pc}
 2184              	.L185:
 990:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
 2185              		.loc 1 990 9 is_stmt 1 view .LVU627
 990:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
 2186              		.loc 1 990 52 is_stmt 0 view .LVU628
 2187 000e 094B     		ldr	r3, .L186
 2188 0010 1B68     		ldr	r3, [r3]
 990:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
 2189              		.loc 1 990 13 view .LVU629
 2190 0012 2146     		mov	r1, r4
 2191 0014 9878     		ldrb	r0, [r3, #2]	@ zero_extendqisi2
 2192 0016 FFF7FEFF 		bl	LoRaMacCryptoDeriveMcRootKey
 2193              	.LVL193:
 990:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
 2194              		.loc 1 990 11 view .LVU630
 2195 001a 40B9     		cbnz	r0, .L182
 994:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
 2196              		.loc 1 994 9 is_stmt 1 view .LVU631
 994:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
 2197              		.loc 1 994 13 is_stmt 0 view .LVU632
 2198 001c 0420     		movs	r0, #4
 2199 001e FFF7FEFF 		bl	LoRaMacCryptoDeriveMcKEKey
 2200              	.LVL194:
 994:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
 2201              		.loc 1 994 11 view .LVU633
 2202 0022 0028     		cmp	r0, #0
 2203 0024 F2D0     		beq	.L180
 996:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
 2204              		.loc 1 996 20 view .LVU634
 2205 0026 0F20     		movs	r0, #15
 2206 0028 F0E7     		b	.L180
 2207              	.L181:
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 71


 985:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 2208              		.loc 1 985 16 view .LVU635
 2209 002a 0F20     		movs	r0, #15
 2210 002c EEE7     		b	.L180
 2211              	.L182:
 992:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         }
 2212              		.loc 1 992 20 view .LVU636
 2213 002e 0F20     		movs	r0, #15
 2214 0030 ECE7     		b	.L180
 2215              	.L187:
 2216 0032 00BF     		.align	2
 2217              	.L186:
 2218 0034 00000000 		.word	.LANCHOR1
 2219              		.cfi_endproc
 2220              	.LFE119:
 2222              		.section	.text.LoRaMacCryptoHandleJoinAccept,"ax",%progbits
 2223              		.align	1
 2224              		.global	LoRaMacCryptoHandleJoinAccept
 2225              		.syntax unified
 2226              		.thumb
 2227              		.thumb_func
 2229              	LoRaMacCryptoHandleJoinAccept:
 2230              	.LVL195:
 2231              	.LFB121:
1132:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( ( macMsg == 0 ) || ( joinEUI == 0 ) )
 2232              		.loc 1 1132 1 is_stmt 1 view -0
 2233              		.cfi_startproc
 2234              		@ args = 0, pretend = 0, frame = 40
 2235              		@ frame_needed = 0, uses_anonymous_args = 0
1133:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 2236              		.loc 1 1133 5 view .LVU638
1133:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 2237              		.loc 1 1133 7 is_stmt 0 view .LVU639
 2238 0000 002A     		cmp	r2, #0
 2239 0002 64D0     		beq	.L190
1132:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( ( macMsg == 0 ) || ( joinEUI == 0 ) )
 2240              		.loc 1 1132 1 discriminator 1 view .LVU640
 2241 0004 F0B5     		push	{r4, r5, r6, r7, lr}
 2242              	.LCFI57:
 2243              		.cfi_def_cfa_offset 20
 2244              		.cfi_offset 4, -20
 2245              		.cfi_offset 5, -16
 2246              		.cfi_offset 6, -12
 2247              		.cfi_offset 7, -8
 2248              		.cfi_offset 14, -4
 2249 0006 8FB0     		sub	sp, sp, #60
 2250              	.LCFI58:
 2251              		.cfi_def_cfa_offset 80
 2252 0008 0746     		mov	r7, r0
 2253 000a 0D46     		mov	r5, r1
 2254 000c 1446     		mov	r4, r2
1133:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 2255              		.loc 1 1133 25 discriminator 1 view .LVU641
 2256 000e 0029     		cmp	r1, #0
 2257 0010 5FD0     		beq	.L191
1138:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t decJoinAccept[LORAMAC_JOIN_ACCEPT_FRAME_MAX_SIZE] = { 0 };
 2258              		.loc 1 1138 5 is_stmt 1 view .LVU642
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 72


 2259              	.LVL196:
1139:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t versionMinor         = 0;
 2260              		.loc 1 1139 5 view .LVU643
1139:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t versionMinor         = 0;
 2261              		.loc 1 1139 13 is_stmt 0 view .LVU644
 2262 0012 0026     		movs	r6, #0
 2263 0014 0596     		str	r6, [sp, #20]
 2264 0016 1D22     		movs	r2, #29
 2265              	.LVL197:
1139:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t versionMinor         = 0;
 2266              		.loc 1 1139 13 view .LVU645
 2267 0018 3146     		mov	r1, r6
 2268              	.LVL198:
1139:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t versionMinor         = 0;
 2269              		.loc 1 1139 13 view .LVU646
 2270 001a 06A8     		add	r0, sp, #24
 2271              	.LVL199:
1139:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t versionMinor         = 0;
 2272              		.loc 1 1139 13 view .LVU647
 2273 001c FFF7FEFF 		bl	memset
 2274              	.LVL200:
1140:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint16_t nonce               = CryptoNvm->DevNonce;
 2275              		.loc 1 1140 5 is_stmt 1 view .LVU648
1140:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint16_t nonce               = CryptoNvm->DevNonce;
 2276              		.loc 1 1140 13 is_stmt 0 view .LVU649
 2277 0020 8DF81360 		strb	r6, [sp, #19]
1141:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 2278              		.loc 1 1141 5 is_stmt 1 view .LVU650
1141:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 2279              		.loc 1 1141 45 is_stmt 0 view .LVU651
 2280 0024 2F4B     		ldr	r3, .L199
 2281 0026 1B68     		ldr	r3, [r3]
1141:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 2282              		.loc 1 1141 14 view .LVU652
 2283 0028 9E88     		ldrh	r6, [r3, #4]
 2284              	.LVL201:
1148:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 2285              		.loc 1 1148 5 is_stmt 1 view .LVU653
1151:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #if( USE_LRWAN_1_1_X_CRYPTO == 1 )
 2286              		.loc 1 1151 5 view .LVU654
1167:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****                                         macMsg->BufSize, decJoinAccept,
 2287              		.loc 1 1167 5 view .LVU655
1167:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****                                         macMsg->BufSize, decJoinAccept,
 2288              		.loc 1 1167 9 is_stmt 0 view .LVU656
 2289 002a 0DF11303 		add	r3, sp, #19
 2290 002e 0293     		str	r3, [sp, #8]
 2291 0030 05AB     		add	r3, sp, #20
 2292 0032 0193     		str	r3, [sp, #4]
 2293 0034 2379     		ldrb	r3, [r4, #4]	@ zero_extendqisi2
 2294 0036 0093     		str	r3, [sp]
 2295 0038 2368     		ldr	r3, [r4]
 2296 003a 3246     		mov	r2, r6
 2297 003c 2946     		mov	r1, r5
 2298 003e 3846     		mov	r0, r7
 2299 0040 FFF7FEFF 		bl	SecureElementProcessJoinAccept
 2300              	.LVL202:
1167:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****                                         macMsg->BufSize, decJoinAccept,
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 73


 2301              		.loc 1 1167 7 view .LVU657
 2302 0044 0028     		cmp	r0, #0
 2303 0046 46D1     		bne	.L192
1174:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 2304              		.loc 1 1174 5 is_stmt 1 view .LVU658
 2305 0048 2279     		ldrb	r2, [r4, #4]	@ zero_extendqisi2
 2306 004a 05A9     		add	r1, sp, #20
 2307 004c 2068     		ldr	r0, [r4]
 2308 004e FFF7FEFF 		bl	memcpy1
 2309              	.LVL203:
1177:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 2310              		.loc 1 1177 5 view .LVU659
1177:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 2311              		.loc 1 1177 9 is_stmt 0 view .LVU660
 2312 0052 2046     		mov	r0, r4
 2313 0054 FFF7FEFF 		bl	LoRaMacParserJoinAccept
 2314              	.LVL204:
1177:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 2315              		.loc 1 1177 7 view .LVU661
 2316 0058 0028     		cmp	r0, #0
 2317 005a 3FD1     		bne	.L193
1182:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 2318              		.loc 1 1182 5 is_stmt 1 view .LVU662
1184:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     currentJoinNonce |= ( ( uint32_t )macMsg->JoinNonce[1] << 8 );
 2319              		.loc 1 1184 5 view .LVU663
1184:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     currentJoinNonce |= ( ( uint32_t )macMsg->JoinNonce[1] << 8 );
 2320              		.loc 1 1184 53 is_stmt 0 view .LVU664
 2321 005c A579     		ldrb	r5, [r4, #6]	@ zero_extendqisi2
 2322              	.LVL205:
1185:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     currentJoinNonce |= ( ( uint32_t )macMsg->JoinNonce[2] << 16 );
 2323              		.loc 1 1185 5 is_stmt 1 view .LVU665
1185:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     currentJoinNonce |= ( ( uint32_t )macMsg->JoinNonce[2] << 16 );
 2324              		.loc 1 1185 56 is_stmt 0 view .LVU666
 2325 005e E379     		ldrb	r3, [r4, #7]	@ zero_extendqisi2
1185:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     currentJoinNonce |= ( ( uint32_t )macMsg->JoinNonce[2] << 16 );
 2326              		.loc 1 1185 22 view .LVU667
 2327 0060 45EA0325 		orr	r5, r5, r3, lsl #8
 2328              	.LVL206:
1186:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 2329              		.loc 1 1186 5 is_stmt 1 view .LVU668
1186:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 2330              		.loc 1 1186 56 is_stmt 0 view .LVU669
 2331 0064 237A     		ldrb	r3, [r4, #8]	@ zero_extendqisi2
1186:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 2332              		.loc 1 1186 22 view .LVU670
 2333 0066 45EA0345 		orr	r5, r5, r3, lsl #16
 2334              	.LVL207:
1193:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* USE_JOIN_NONCE_COUNTER_CHECK */
 2335              		.loc 1 1193 5 is_stmt 1 view .LVU671
1193:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* USE_JOIN_NONCE_COUNTER_CHECK */
 2336              		.loc 1 1193 38 is_stmt 0 view .LVU672
 2337 006a 1E4B     		ldr	r3, .L199
 2338 006c 1B68     		ldr	r3, [r3]
 2339 006e 9A68     		ldr	r2, [r3, #8]
1193:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* USE_JOIN_NONCE_COUNTER_CHECK */
 2340              		.loc 1 1193 7 view .LVU673
 2341 0070 AA42     		cmp	r2, r5
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 74


 2342 0072 35D0     		beq	.L194
1196:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 2343              		.loc 1 1196 9 is_stmt 1 view .LVU674
1196:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 2344              		.loc 1 1196 30 is_stmt 0 view .LVU675
 2345 0074 9D60     		str	r5, [r3, #8]
1204:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( retval != LORAMAC_CRYPTO_SUCCESS )
 2346              		.loc 1 1204 5 is_stmt 1 view .LVU676
1204:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( retval != LORAMAC_CRYPTO_SUCCESS )
 2347              		.loc 1 1204 14 is_stmt 0 view .LVU677
 2348 0076 0021     		movs	r1, #0
 2349 0078 9DF81300 		ldrb	r0, [sp, #19]	@ zero_extendqisi2
 2350 007c FFF7FEFF 		bl	LoRaMacCryptoDeriveMcRootKey
 2351              	.LVL208:
1205:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 2352              		.loc 1 1205 5 is_stmt 1 view .LVU678
1205:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 2353              		.loc 1 1205 7 is_stmt 0 view .LVU679
 2354 0080 50BB     		cbnz	r0, .L189
1210:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( retval != LORAMAC_CRYPTO_SUCCESS )
 2355              		.loc 1 1210 5 is_stmt 1 view .LVU680
1210:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( retval != LORAMAC_CRYPTO_SUCCESS )
 2356              		.loc 1 1210 14 is_stmt 0 view .LVU681
 2357 0082 0420     		movs	r0, #4
 2358              	.LVL209:
1210:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( retval != LORAMAC_CRYPTO_SUCCESS )
 2359              		.loc 1 1210 14 view .LVU682
 2360 0084 FFF7FEFF 		bl	LoRaMacCryptoDeriveMcKEKey
 2361              	.LVL210:
1211:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 2362              		.loc 1 1211 5 is_stmt 1 view .LVU683
1211:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 2363              		.loc 1 1211 7 is_stmt 0 view .LVU684
 2364 0088 30BB     		cbnz	r0, .L189
 2365              	.LBB8:
1250:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 2366              		.loc 1 1250 9 is_stmt 1 view .LVU685
1252:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         netID |= ( ( uint32_t )macMsg->NetID[1] << 8 );
 2367              		.loc 1 1252 9 view .LVU686
1252:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         netID |= ( ( uint32_t )macMsg->NetID[1] << 8 );
 2368              		.loc 1 1252 42 is_stmt 0 view .LVU687
 2369 008a 637A     		ldrb	r3, [r4, #9]	@ zero_extendqisi2
 2370              	.LVL211:
1253:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         netID |= ( ( uint32_t )macMsg->NetID[2] << 16 );
 2371              		.loc 1 1253 9 is_stmt 1 view .LVU688
1253:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         netID |= ( ( uint32_t )macMsg->NetID[2] << 16 );
 2372              		.loc 1 1253 45 is_stmt 0 view .LVU689
 2373 008c A27A     		ldrb	r2, [r4, #10]	@ zero_extendqisi2
1253:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         netID |= ( ( uint32_t )macMsg->NetID[2] << 16 );
 2374              		.loc 1 1253 15 view .LVU690
 2375 008e 43EA0223 		orr	r3, r3, r2, lsl #8
 2376              	.LVL212:
1254:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 2377              		.loc 1 1254 9 is_stmt 1 view .LVU691
1254:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 2378              		.loc 1 1254 45 is_stmt 0 view .LVU692
 2379 0092 E47A     		ldrb	r4, [r4, #11]	@ zero_extendqisi2
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 75


 2380              	.LVL213:
1254:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 2381              		.loc 1 1254 15 view .LVU693
 2382 0094 43EA0444 		orr	r4, r3, r4, lsl #16
 2383              	.LVL214:
1256:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         if( retval != LORAMAC_CRYPTO_SUCCESS )
 2384              		.loc 1 1256 9 is_stmt 1 view .LVU694
1256:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         if( retval != LORAMAC_CRYPTO_SUCCESS )
 2385              		.loc 1 1256 18 is_stmt 0 view .LVU695
 2386 0098 3346     		mov	r3, r6
 2387 009a 2246     		mov	r2, r4
 2388 009c 2946     		mov	r1, r5
 2389 009e 0320     		movs	r0, #3
 2390              	.LVL215:
1256:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         if( retval != LORAMAC_CRYPTO_SUCCESS )
 2391              		.loc 1 1256 18 view .LVU696
 2392 00a0 FFF7FEFF 		bl	DeriveSessionKey10x
 2393              	.LVL216:
1257:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
 2394              		.loc 1 1257 9 is_stmt 1 view .LVU697
1257:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
 2395              		.loc 1 1257 11 is_stmt 0 view .LVU698
 2396 00a4 C0B9     		cbnz	r0, .L189
1278:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* USE_LRWAN_1_1_X_CRYPTO */
 2397              		.loc 1 1278 9 is_stmt 1 view .LVU699
1278:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* USE_LRWAN_1_1_X_CRYPTO */
 2398              		.loc 1 1278 18 is_stmt 0 view .LVU700
 2399 00a6 3346     		mov	r3, r6
 2400 00a8 2246     		mov	r2, r4
 2401 00aa 2946     		mov	r1, r5
 2402 00ac 0220     		movs	r0, #2
 2403              	.LVL217:
1278:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** #endif /* USE_LRWAN_1_1_X_CRYPTO */
 2404              		.loc 1 1278 18 view .LVU701
 2405 00ae FFF7FEFF 		bl	DeriveSessionKey10x
 2406              	.LVL218:
1281:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
 2407              		.loc 1 1281 9 is_stmt 1 view .LVU702
1281:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         {
 2408              		.loc 1 1281 11 is_stmt 0 view .LVU703
 2409 00b2 88B9     		cbnz	r0, .L189
 2410              	.LBE8:
1289:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 2411              		.loc 1 1289 5 is_stmt 1 view .LVU704
1289:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 2412              		.loc 1 1289 14 is_stmt 0 view .LVU705
 2413 00b4 0B4B     		ldr	r3, .L199
 2414 00b6 1B68     		ldr	r3, [r3]
1289:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 2415              		.loc 1 1289 42 view .LVU706
 2416 00b8 9DF81320 		ldrb	r2, [sp, #19]	@ zero_extendqisi2
 2417 00bc 9A70     		strb	r2, [r3, #2]
1295:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     CryptoNvm->FCntList.FCntDown = FCNT_DOWN_INITAL_VALUE;
 2418              		.loc 1 1295 5 is_stmt 1 view .LVU707
1295:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     CryptoNvm->FCntList.FCntDown = FCNT_DOWN_INITAL_VALUE;
 2419              		.loc 1 1295 32 is_stmt 0 view .LVU708
 2420 00be 0022     		movs	r2, #0
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 76


 2421 00c0 DA60     		str	r2, [r3, #12]
1296:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     CryptoNvm->FCntList.NFCntDown = FCNT_DOWN_INITAL_VALUE;
 2422              		.loc 1 1296 5 is_stmt 1 view .LVU709
1296:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     CryptoNvm->FCntList.NFCntDown = FCNT_DOWN_INITAL_VALUE;
 2423              		.loc 1 1296 34 is_stmt 0 view .LVU710
 2424 00c2 4FF0FF32 		mov	r2, #-1
 2425 00c6 9A61     		str	r2, [r3, #24]
1297:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     CryptoNvm->FCntList.AFCntDown = FCNT_DOWN_INITAL_VALUE;
 2426              		.loc 1 1297 5 is_stmt 1 view .LVU711
1297:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     CryptoNvm->FCntList.AFCntDown = FCNT_DOWN_INITAL_VALUE;
 2427              		.loc 1 1297 35 is_stmt 0 view .LVU712
 2428 00c8 1A61     		str	r2, [r3, #16]
1298:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 2429              		.loc 1 1298 5 is_stmt 1 view .LVU713
1298:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 2430              		.loc 1 1298 35 is_stmt 0 view .LVU714
 2431 00ca 5A61     		str	r2, [r3, #20]
1300:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 2432              		.loc 1 1300 5 is_stmt 1 view .LVU715
1300:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 2433              		.loc 1 1300 12 is_stmt 0 view .LVU716
 2434 00cc 04E0     		b	.L189
 2435              	.LVL219:
 2436              	.L190:
 2437              	.LCFI59:
 2438              		.cfi_def_cfa_offset 0
 2439              		.cfi_restore 4
 2440              		.cfi_restore 5
 2441              		.cfi_restore 6
 2442              		.cfi_restore 7
 2443              		.cfi_restore 14
1135:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 2444              		.loc 1 1135 16 view .LVU717
 2445 00ce 0A20     		movs	r0, #10
 2446              	.LVL220:
1301:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 2447              		.loc 1 1301 1 view .LVU718
 2448 00d0 7047     		bx	lr
 2449              	.LVL221:
 2450              	.L191:
 2451              	.LCFI60:
 2452              		.cfi_def_cfa_offset 80
 2453              		.cfi_offset 4, -20
 2454              		.cfi_offset 5, -16
 2455              		.cfi_offset 6, -12
 2456              		.cfi_offset 7, -8
 2457              		.cfi_offset 14, -4
1135:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 2458              		.loc 1 1135 16 view .LVU719
 2459 00d2 0A20     		movs	r0, #10
 2460              	.LVL222:
1135:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 2461              		.loc 1 1135 16 view .LVU720
 2462 00d4 00E0     		b	.L189
 2463              	.LVL223:
 2464              	.L192:
1171:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 77


 2465              		.loc 1 1171 16 view .LVU721
 2466 00d6 0F20     		movs	r0, #15
 2467              	.LVL224:
 2468              	.L189:
1301:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 2469              		.loc 1 1301 1 view .LVU722
 2470 00d8 0FB0     		add	sp, sp, #60
 2471              	.LCFI61:
 2472              		.cfi_remember_state
 2473              		.cfi_def_cfa_offset 20
 2474              		@ sp needed
 2475 00da F0BD     		pop	{r4, r5, r6, r7, pc}
 2476              	.LVL225:
 2477              	.L193:
 2478              	.LCFI62:
 2479              		.cfi_restore_state
1179:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 2480              		.loc 1 1179 16 view .LVU723
 2481 00dc 1020     		movs	r0, #16
 2482 00de FBE7     		b	.L189
 2483              	.LVL226:
 2484              	.L194:
1200:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 2485              		.loc 1 1200 16 view .LVU724
 2486 00e0 0320     		movs	r0, #3
 2487 00e2 F9E7     		b	.L189
 2488              	.L200:
 2489              		.align	2
 2490              	.L199:
 2491 00e4 00000000 		.word	.LANCHOR1
 2492              		.cfi_endproc
 2493              	.LFE121:
 2495              		.section	.text.LoRaMacCryptoDeriveMcSessionKeyPair,"ax",%progbits
 2496              		.align	1
 2497              		.global	LoRaMacCryptoDeriveMcSessionKeyPair
 2498              		.syntax unified
 2499              		.thumb
 2500              		.thumb_func
 2502              	LoRaMacCryptoDeriveMcSessionKeyPair:
 2503              	.LVL227:
 2504              	.LFB126:
1546:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1547:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** LoRaMacCryptoStatus_t LoRaMacCryptoDeriveMcSessionKeyPair( AddressIdentifier_t addrID, uint32_t mcA
1548:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** {
 2505              		.loc 1 1548 1 is_stmt 1 view -0
 2506              		.cfi_startproc
 2507              		@ args = 0, pretend = 0, frame = 40
 2508              		@ frame_needed = 0, uses_anonymous_args = 0
1549:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( mcAddr == 0 )
 2509              		.loc 1 1549 5 view .LVU726
 2510              		.loc 1 1549 7 is_stmt 0 view .LVU727
 2511 0000 0029     		cmp	r1, #0
 2512 0002 3DD0     		beq	.L203
1548:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( mcAddr == 0 )
 2513              		.loc 1 1548 1 view .LVU728
 2514 0004 10B5     		push	{r4, lr}
 2515              	.LCFI63:
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 78


 2516              		.cfi_def_cfa_offset 8
 2517              		.cfi_offset 4, -8
 2518              		.cfi_offset 14, -4
 2519 0006 8AB0     		sub	sp, sp, #40
 2520              	.LCFI64:
 2521              		.cfi_def_cfa_offset 48
 2522 0008 0C46     		mov	r4, r1
1550:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1551:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_NPE;
1552:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1553:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1554:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     LoRaMacCryptoStatus_t retval = LORAMAC_CRYPTO_ERROR;
 2523              		.loc 1 1554 5 is_stmt 1 view .LVU729
 2524              	.LVL228:
1555:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1556:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // Determine current security context
1557:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     KeyAddr_t* curItem;
 2525              		.loc 1 1557 5 view .LVU730
1558:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     retval = GetKeyAddrItem( addrID, &curItem );
 2526              		.loc 1 1558 5 view .LVU731
 2527              		.loc 1 1558 14 is_stmt 0 view .LVU732
 2528 000a 09A9     		add	r1, sp, #36
 2529              	.LVL229:
 2530              		.loc 1 1558 14 view .LVU733
 2531 000c FFF7FEFF 		bl	GetKeyAddrItem
 2532              	.LVL230:
1559:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( retval != LORAMAC_CRYPTO_SUCCESS )
 2533              		.loc 1 1559 5 is_stmt 1 view .LVU734
 2534              		.loc 1 1559 7 is_stmt 0 view .LVU735
 2535 0010 08B1     		cbz	r0, .L210
 2536              	.LVL231:
 2537              	.L202:
1560:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1561:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return retval;
1562:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1563:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1564:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // McAppSKey = aes128_encrypt(McKey, 0x01 | McAddr | pad16)
1565:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     // McNwkSKey = aes128_encrypt(McKey, 0x02 | McAddr | pad16)
1566:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1567:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t compBaseAppS[16] = { 0 };
1568:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t compBaseNwkS[16] = { 0 };
1569:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1570:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBaseAppS[0] = 0x01;
1571:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBaseAppS[1] = mcAddr & 0xFF;
1572:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBaseAppS[2] = ( mcAddr >> 8 ) & 0xFF;
1573:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBaseAppS[3] = ( mcAddr >> 16 ) & 0xFF;
1574:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBaseAppS[4] = ( mcAddr >> 24 ) & 0xFF;
1575:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1576:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBaseNwkS[0] = 0x02;
1577:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBaseNwkS[1] = mcAddr & 0xFF;
1578:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBaseNwkS[2] = ( mcAddr >> 8 ) & 0xFF;
1579:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBaseNwkS[3] = ( mcAddr >> 16 ) & 0xFF;
1580:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBaseNwkS[4] = ( mcAddr >> 24 ) & 0xFF;
1581:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1582:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( SecureElementDeriveAndStoreKey( compBaseAppS, curItem->RootKey, curItem->AppSkey ) != SECUR
1583:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1584:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_SECURE_ELEMENT_FUNC;
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 79


1585:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1586:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1587:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     if( SecureElementDeriveAndStoreKey( compBaseNwkS, curItem->RootKey, curItem->NwkSkey ) != SECUR
1588:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
1589:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****         return LORAMAC_CRYPTO_ERROR_SECURE_ELEMENT_FUNC;
1590:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
1591:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
1592:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     return LORAMAC_CRYPTO_SUCCESS;
1593:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** }
 2538              		.loc 1 1593 1 view .LVU736
 2539 0012 0AB0     		add	sp, sp, #40
 2540              	.LCFI65:
 2541              		.cfi_remember_state
 2542              		.cfi_def_cfa_offset 8
 2543              		@ sp needed
 2544 0014 10BD     		pop	{r4, pc}
 2545              	.LVL232:
 2546              	.L210:
 2547              	.LCFI66:
 2548              		.cfi_restore_state
1567:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t compBaseNwkS[16] = { 0 };
 2549              		.loc 1 1567 5 is_stmt 1 view .LVU737
1567:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     uint8_t compBaseNwkS[16] = { 0 };
 2550              		.loc 1 1567 13 is_stmt 0 view .LVU738
 2551 0016 0590     		str	r0, [sp, #20]
 2552 0018 0690     		str	r0, [sp, #24]
 2553 001a 0790     		str	r0, [sp, #28]
 2554 001c 0890     		str	r0, [sp, #32]
1568:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 2555              		.loc 1 1568 5 is_stmt 1 view .LVU739
1568:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 2556              		.loc 1 1568 13 is_stmt 0 view .LVU740
 2557 001e 0190     		str	r0, [sp, #4]
 2558 0020 0290     		str	r0, [sp, #8]
 2559 0022 0390     		str	r0, [sp, #12]
 2560 0024 0490     		str	r0, [sp, #16]
1570:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBaseAppS[1] = mcAddr & 0xFF;
 2561              		.loc 1 1570 5 is_stmt 1 view .LVU741
1570:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBaseAppS[1] = mcAddr & 0xFF;
 2562              		.loc 1 1570 21 is_stmt 0 view .LVU742
 2563 0026 0123     		movs	r3, #1
 2564 0028 8DF81430 		strb	r3, [sp, #20]
1571:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBaseAppS[2] = ( mcAddr >> 8 ) & 0xFF;
 2565              		.loc 1 1571 5 is_stmt 1 view .LVU743
1571:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBaseAppS[2] = ( mcAddr >> 8 ) & 0xFF;
 2566              		.loc 1 1571 21 is_stmt 0 view .LVU744
 2567 002c E1B2     		uxtb	r1, r4
 2568 002e 8DF81510 		strb	r1, [sp, #21]
1572:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBaseAppS[3] = ( mcAddr >> 16 ) & 0xFF;
 2569              		.loc 1 1572 5 is_stmt 1 view .LVU745
1572:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBaseAppS[3] = ( mcAddr >> 16 ) & 0xFF;
 2570              		.loc 1 1572 21 is_stmt 0 view .LVU746
 2571 0032 C4F30722 		ubfx	r2, r4, #8, #8
 2572 0036 8DF81620 		strb	r2, [sp, #22]
1573:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBaseAppS[4] = ( mcAddr >> 24 ) & 0xFF;
 2573              		.loc 1 1573 5 is_stmt 1 view .LVU747
1573:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBaseAppS[4] = ( mcAddr >> 24 ) & 0xFF;
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 80


 2574              		.loc 1 1573 21 is_stmt 0 view .LVU748
 2575 003a C4F30743 		ubfx	r3, r4, #16, #8
 2576 003e 8DF81730 		strb	r3, [sp, #23]
1574:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 2577              		.loc 1 1574 5 is_stmt 1 view .LVU749
1574:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 2578              		.loc 1 1574 21 is_stmt 0 view .LVU750
 2579 0042 240E     		lsrs	r4, r4, #24
 2580              	.LVL233:
1574:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 2581              		.loc 1 1574 21 view .LVU751
 2582 0044 8DF81840 		strb	r4, [sp, #24]
1576:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBaseNwkS[1] = mcAddr & 0xFF;
 2583              		.loc 1 1576 5 is_stmt 1 view .LVU752
1576:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBaseNwkS[1] = mcAddr & 0xFF;
 2584              		.loc 1 1576 21 is_stmt 0 view .LVU753
 2585 0048 0220     		movs	r0, #2
 2586              	.LVL234:
1576:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBaseNwkS[1] = mcAddr & 0xFF;
 2587              		.loc 1 1576 21 view .LVU754
 2588 004a 8DF80400 		strb	r0, [sp, #4]
1577:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBaseNwkS[2] = ( mcAddr >> 8 ) & 0xFF;
 2589              		.loc 1 1577 5 is_stmt 1 view .LVU755
1577:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBaseNwkS[2] = ( mcAddr >> 8 ) & 0xFF;
 2590              		.loc 1 1577 21 is_stmt 0 view .LVU756
 2591 004e 8DF80510 		strb	r1, [sp, #5]
1578:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBaseNwkS[3] = ( mcAddr >> 16 ) & 0xFF;
 2592              		.loc 1 1578 5 is_stmt 1 view .LVU757
1578:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBaseNwkS[3] = ( mcAddr >> 16 ) & 0xFF;
 2593              		.loc 1 1578 21 is_stmt 0 view .LVU758
 2594 0052 8DF80620 		strb	r2, [sp, #6]
1579:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBaseNwkS[4] = ( mcAddr >> 24 ) & 0xFF;
 2595              		.loc 1 1579 5 is_stmt 1 view .LVU759
1579:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     compBaseNwkS[4] = ( mcAddr >> 24 ) & 0xFF;
 2596              		.loc 1 1579 21 is_stmt 0 view .LVU760
 2597 0056 8DF80730 		strb	r3, [sp, #7]
1580:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 2598              		.loc 1 1580 5 is_stmt 1 view .LVU761
1580:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c **** 
 2599              		.loc 1 1580 21 is_stmt 0 view .LVU762
 2600 005a 8DF80840 		strb	r4, [sp, #8]
1582:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 2601              		.loc 1 1582 5 is_stmt 1 view .LVU763
1582:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 2602              		.loc 1 1582 62 is_stmt 0 view .LVU764
 2603 005e 099B     		ldr	r3, [sp, #36]
1582:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 2604              		.loc 1 1582 9 view .LVU765
 2605 0060 5A78     		ldrb	r2, [r3, #1]	@ zero_extendqisi2
 2606 0062 D978     		ldrb	r1, [r3, #3]	@ zero_extendqisi2
 2607 0064 05A8     		add	r0, sp, #20
 2608 0066 FFF7FEFF 		bl	SecureElementDeriveAndStoreKey
 2609              	.LVL235:
1582:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 2610              		.loc 1 1582 7 view .LVU766
 2611 006a 58B9     		cbnz	r0, .L204
1587:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 81


 2612              		.loc 1 1587 5 is_stmt 1 view .LVU767
1587:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 2613              		.loc 1 1587 62 is_stmt 0 view .LVU768
 2614 006c 099B     		ldr	r3, [sp, #36]
1587:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 2615              		.loc 1 1587 9 view .LVU769
 2616 006e 9A78     		ldrb	r2, [r3, #2]	@ zero_extendqisi2
 2617 0070 D978     		ldrb	r1, [r3, #3]	@ zero_extendqisi2
 2618 0072 01A8     		add	r0, sp, #4
 2619 0074 FFF7FEFF 		bl	SecureElementDeriveAndStoreKey
 2620              	.LVL236:
1587:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     {
 2621              		.loc 1 1587 7 view .LVU770
 2622 0078 0028     		cmp	r0, #0
 2623 007a CAD0     		beq	.L202
1589:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 2624              		.loc 1 1589 16 view .LVU771
 2625 007c 0F20     		movs	r0, #15
 2626 007e C8E7     		b	.L202
 2627              	.LVL237:
 2628              	.L203:
 2629              	.LCFI67:
 2630              		.cfi_def_cfa_offset 0
 2631              		.cfi_restore 4
 2632              		.cfi_restore 14
1551:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 2633              		.loc 1 1551 16 view .LVU772
 2634 0080 0A20     		movs	r0, #10
 2635              	.LVL238:
 2636              		.loc 1 1593 1 view .LVU773
 2637 0082 7047     		bx	lr
 2638              	.LVL239:
 2639              	.L204:
 2640              	.LCFI68:
 2641              		.cfi_def_cfa_offset 48
 2642              		.cfi_offset 4, -8
 2643              		.cfi_offset 14, -4
1584:Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.c ****     }
 2644              		.loc 1 1584 16 view .LVU774
 2645 0084 0F20     		movs	r0, #15
 2646 0086 C4E7     		b	.L202
 2647              		.cfi_endproc
 2648              	.LFE126:
 2650              		.section	.bss.CryptoNvm,"aw",%nobits
 2651              		.align	2
 2652              		.set	.LANCHOR1,. + 0
 2655              	CryptoNvm:
 2656 0000 00000000 		.space	4
 2657              		.section	.data.KeyAddrList,"aw"
 2658              		.align	2
 2659              		.set	.LANCHOR0,. + 0
 2662              	KeyAddrList:
 2663 0000 00       		.byte	0
 2664 0001 81       		.byte	-127
 2665 0002 82       		.byte	-126
 2666 0003 80       		.byte	-128
 2667 0004 01       		.byte	1
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 82


 2668 0005 03       		.byte	3
 2669 0006 02       		.byte	2
 2670 0007 84       		.byte	-124
 2671              		.text
 2672              	.Letext0:
 2673              		.file 2 "c:\\program files (x86)\\gnu arm embedded toolchain\\10 2021.10\\arm-none-eabi\\include\\
 2674              		.file 3 "c:\\program files (x86)\\gnu arm embedded toolchain\\10 2021.10\\arm-none-eabi\\include\\
 2675              		.file 4 "Middlewares/Third_Party/LoRaWAN/Utilities/utilities.h"
 2676              		.file 5 "Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacTypes.h"
 2677              		.file 6 "Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacHeaderTypes.h"
 2678              		.file 7 "Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacMessageTypes.h"
 2679              		.file 8 "Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCryptoNvm.h"
 2680              		.file 9 "Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacCrypto.h"
 2681              		.file 10 "Middlewares/Third_Party/LoRaWAN/Mac/secure-element.h"
 2682              		.file 11 "Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacParser.h"
 2683              		.file 12 "Middlewares/Third_Party/LoRaWAN/Mac/LoRaMacSerializer.h"
 2684              		.file 13 "<built-in>"
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 83


DEFINED SYMBOLS
                            *ABS*:00000000 LoRaMacCrypto.c
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:18     .text.PrepareB0:00000000 $t
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:23     .text.PrepareB0:00000000 PrepareB0
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:137    .text.GetKeyAddrItem:00000000 $t
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:142    .text.GetKeyAddrItem:00000000 GetKeyAddrItem
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:205    .text.GetKeyAddrItem:00000028 $d
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:210    .text.GetLastFcntDown:00000000 $t
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:215    .text.GetLastFcntDown:00000000 GetLastFcntDown
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:236    .text.GetLastFcntDown:00000010 $d
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:240    .text.GetLastFcntDown:00000014 $t
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:336    .text.GetLastFcntDown:00000058 $d
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:341    .text.CheckFCntDown:00000000 $t
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:346    .text.CheckFCntDown:00000000 CheckFCntDown
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:414    .text.UpdateFCntDown:00000000 $t
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:419    .text.UpdateFCntDown:00000000 UpdateFCntDown
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:435    .text.UpdateFCntDown:0000000a $d
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:439    .text.UpdateFCntDown:0000000e $t
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:481    .text.UpdateFCntDown:00000030 $d
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:486    .text.ResetFCnts:00000000 $t
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:491    .text.ResetFCnts:00000000 ResetFCnts
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:547    .text.ResetFCnts:0000002c $d
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:553    .text.ComputeCmacB0:00000000 $t
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:558    .text.ComputeCmacB0:00000000 ComputeCmacB0
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:665    .text.DeriveSessionKey10x:00000000 $t
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:670    .text.DeriveSessionKey10x:00000000 DeriveSessionKey10x
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:785    .text.PayloadEncrypt:00000000 $t
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:790    .text.PayloadEncrypt:00000000 PayloadEncrypt
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:986    .text.VerifyCmacB0:00000000 $t
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:991    .text.VerifyCmacB0:00000000 VerifyCmacB0
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:1116   .text.LoRaMacCryptoInit:00000000 $t
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:1122   .text.LoRaMacCryptoInit:00000000 LoRaMacCryptoInit
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:1185   .text.LoRaMacCryptoInit:0000002c $d
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:1190   .text.LoRaMacCryptoSetLrWanVersion:00000000 $t
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:1196   .text.LoRaMacCryptoSetLrWanVersion:00000000 LoRaMacCryptoSetLrWanVersion
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:1219   .text.LoRaMacCryptoSetLrWanVersion:0000000c $d
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:1224   .text.LoRaMacCryptoGetFCntUp:00000000 $t
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:1230   .text.LoRaMacCryptoGetFCntUp:00000000 LoRaMacCryptoGetFCntUp
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:1267   .text.LoRaMacCryptoGetFCntUp:00000014 $d
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:1272   .text.LoRaMacCryptoGetFCntDown:00000000 $t
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:1278   .text.LoRaMacCryptoGetFCntDown:00000000 LoRaMacCryptoGetFCntDown
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:1425   .text.LoRaMacCryptoGetFCntDown:00000070 $d
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:1430   .text.LoRaMacCryptoSetMulticastReference:00000000 $t
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:1436   .text.LoRaMacCryptoSetMulticastReference:00000000 LoRaMacCryptoSetMulticastReference
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:1492   .text.LoRaMacCryptoSetMulticastReference:0000002c $d
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:1498   .text.LoRaMacCryptoPrepareJoinRequest:00000000 $t
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:1504   .text.LoRaMacCryptoPrepareJoinRequest:00000000 LoRaMacCryptoPrepareJoinRequest
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:1611   .text.LoRaMacCryptoPrepareJoinRequest:00000054 $d
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:1616   .text.LoRaMacCryptoSecureMessage:00000000 $t
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:1622   .text.LoRaMacCryptoSecureMessage:00000000 LoRaMacCryptoSecureMessage
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:1789   .text.LoRaMacCryptoSecureMessage:00000084 $d
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:1794   .text.LoRaMacCryptoUnsecureMessage:00000000 $t
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:1800   .text.LoRaMacCryptoUnsecureMessage:00000000 LoRaMacCryptoUnsecureMessage
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:1991   .text.LoRaMacCryptoUnsecureMessage:000000b8 $d
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:1996   .text.LoRaMacCryptoDeriveMcRootKey:00000000 $t
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:2002   .text.LoRaMacCryptoDeriveMcRootKey:00000000 LoRaMacCryptoDeriveMcRootKey
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:2084   .text.LoRaMacCryptoDeriveMcKEKey:00000000 $t
ARM GAS  C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s 			page 84


C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:2090   .text.LoRaMacCryptoDeriveMcKEKey:00000000 LoRaMacCryptoDeriveMcKEKey
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:2152   .text.LoRaMacCryptoSetKey:00000000 $t
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:2158   .text.LoRaMacCryptoSetKey:00000000 LoRaMacCryptoSetKey
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:2218   .text.LoRaMacCryptoSetKey:00000034 $d
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:2223   .text.LoRaMacCryptoHandleJoinAccept:00000000 $t
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:2229   .text.LoRaMacCryptoHandleJoinAccept:00000000 LoRaMacCryptoHandleJoinAccept
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:2491   .text.LoRaMacCryptoHandleJoinAccept:000000e4 $d
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:2496   .text.LoRaMacCryptoDeriveMcSessionKeyPair:00000000 $t
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:2502   .text.LoRaMacCryptoDeriveMcSessionKeyPair:00000000 LoRaMacCryptoDeriveMcSessionKeyPair
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:2651   .bss.CryptoNvm:00000000 $d
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:2655   .bss.CryptoNvm:00000000 CryptoNvm
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:2658   .data.KeyAddrList:00000000 $d
C:\Users\NATHAN~1\AppData\Local\Temp\cceWCQyO.s:2662   .data.KeyAddrList:00000000 KeyAddrList

UNDEFINED SYMBOLS
SecureElementComputeAesCmac
SecureElementDeriveAndStoreKey
SecureElementAesEncrypt
memset1
memcpy1
SecureElementVerifyAesCmac
SecureElementRandomNumber
LoRaMacSerializerJoinRequest
LoRaMacSerializerData
LoRaMacParserData
SecureElementSetKey
memset
SecureElementProcessJoinAccept
LoRaMacParserJoinAccept
